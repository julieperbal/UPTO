/* VimeoPlayer - v2.40.2 - 2016-11-30 */
/* VimeoPlayer - v2.40.2 - 2016-11-30 - https://player.vimeo.com/NOTICE.txt */
var VimeoPlayer=function(){"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}function t(e,t){return t={exports:{}},e(t,t.exports),t.exports}function n(e,t){var n=arguments.length<=2||void 0===arguments[2]?document.styleSheets[0]:arguments[2];try{n.insertRule?n.insertRule(e+"{"+t+"}",(n.cssRules||n.rules).length):n.addRule(e,t)}catch(e){}}function i(e){if(e&&e.detail>0)try{document.activeElement.blur()}catch(e){}}function r(e){var t=e.getBoundingClientRect();return document.msFullscreenElement&&window.parent!==window&&(t={bottom:100*t.bottom,left:100*t.left,top:100*t.top,right:100*t.right,width:100*t.width,height:100*t.height}),t}function o(e){try{return new URL(e).origin}catch(e){}var t=document.createElement("a");return t.href=e,t.origin?t.origin:t.protocol.replace(":","")+"://"+t.host}function a(e){var t=e.width,n=e.height,i=e.elementWidth,r=e.elementHeight,o=e.threshold,a=void 0===o?10:o,s=1,c=t/n,u=i-r*c,d=r-i/c;if(u>0&&u<a||d>0&&d<a){var l=i/(i-u),f=r/(r-d);s=Math.max(l,f)}return{extraWidth:u,extraHeight:d,scaleFactor:s}}function s(e,t,n){return e>n?n:t>e?t:e}function c(e){if(e===!0)return He.resolve(null);var t=!1;return new He(function(n,i){var r=function(){t||!function(){t=!0;var i=(new Date).getTime()-e.startTime;setTimeout(function(){return n(i)},100)}()};e.link.addEventListener("load",r,!1)})}function u(e,t,n){var i=n.width,r=n.height,o=n.scrollbars,a=void 0===o?"yes":o,s=n.resizable,c=void 0===s?"yes":s,u=n.toolbar,d=void 0===u?"no":u,l=(window.screenY||window.screenTop||0)+window.outerHeight/2-r/2,f=(window.screenX||window.screenLeft||0)+window.outerWidth/2-i/2;window.chrome&&window.navigator.userAgent.toLowerCase().indexOf("mac os x")!==-1&&(r+=27),window.safari&&(r+=47);var h="scrollbars="+a+",resizable="+c+",toolbar="+d;return window.open(e,t,"width="+i+",height="+r+",left="+f+",top="+l+","+h)}function d(e){var t=e.match(/\ba?t=([0-9hms:]+)/);null!==t&&(e=t[1]);var n=!1,i=0,r=0,o=0;if(t=e.match(/^([0-9]+)$/),t&&t.length&&(n=!0,o=t[1]),n===!1&&(t=e.match(/^(?:([0-9]+)h)?(?:([0-9]+)m)?(?:([0-9]+)s)?/),null!==t&&""!==t[0])){n=!0;var a=t,s=et(a,4),c=s[1];i=void 0===c?0:c;var u=s[2];r=void 0===u?0:u;var d=s[3];o=void 0===d?0:d}if(n===!1&&(t=e.match(/^([0-9:]+)/),null!==t)){n=!0;var l=e.split(":").reverse(),f=et(l,3);o=f[0];var h=f[1];r=void 0===h?0:h;var p=f[2];i=void 0===p?0:p}return n?60*parseInt(i,10)*60+60*parseInt(r,10)+parseInt(o,10):null}function l(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=t.method,i=void 0===n?"GET":n,r=t.withCredentials,o=void 0===r||r,a=t.allowErrorStatuses,s=void 0!==a&&a;return new He(function(t,n){var r=new XMLHttpRequest;r.open(i,e,!0),o&&(r.withCredentials=!0),r.onload=function(){return r.status>=400&&!s?void n(r.status):void t(r.responseText)},r.onerror=function(){return n(new Error("The request failed."))},r.send()})}function f(e){for(var t,n,i=(e||document).querySelectorAll("[tabindex]"),r=[],o=0,a=0,s=i.length;a<s;a++)t=i[a],n=window.getComputedStyle(t,""),t.tabIndex>0&&"none"!==n.display&&n.opacity>0&&"hidden"!==n.visibility&&(r[o++]=t);var c=r.shift();c&&(c.focus(),c.blur())}function h(e,t){if(e=parseFloat(e),isNaN(e))return 0;var n=Math.pow(10,t||3);return Math.round(e*n)/n}function p(e,t){var n,i,r,o,a=0,s=function(){a=new Date,r=null,o=e.apply(n,i)};return function(){var c=new Date,u=t-(c-a);return n=this,i=arguments,u<=0?(clearTimeout(r),r=null,a=c,o=e.apply(n,i)):r||(r=setTimeout(s,u)),o}}function v(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^16*Math.random()>>e/4).toString(16)})}function g(e,t,n,i){var r=i[t];return r=_(e,r),r=m(r,n,i.prices),i.expires_in_duration_str&&(r=r.replace("{TIME}",i.expires_in_duration_str)),i.available_on_formatted&&(r=r.replace("{DATE}",i.available_on_formatted)),r}function m(e,t,n){var i=n.USD;return t in n&&(i=n[t]),e.indexOf("${price}")!==-1?e.replace("${price}",i):e.indexOf("{PRICE}")!==-1?e.replace("{PRICE}",i):e}function y(e,t){return!e||0===e.length||e.indexOf(t)!==-1}function _(e,t){return"undefined"!=typeof e&&"undefined"!=typeof e[t]?e[t]:t}function b(e,t,n,i){return!i.relatedTarget||(!n||e===t)&&(t!==i.relatedTarget&&!t.contains(i.relatedTarget))}function w(e,t,n,i){var r=!1;i="function"==typeof t?n:i,n="function"==typeof t?t:n,t="function"==typeof t?null:t;var o=function(e){var t=!0;if(e.changedTouches){var o=e.changedTouches[0].pageX-window.pageXOffset,a=e.changedTouches[0].pageY-window.pageYOffset,s=document.elementFromPoint(o,a);null!==s&&this.contains(s)&&(t=n.call(this,e))}return"function"==typeof i&&i.call(this,e),r=!0,t},a=function(e){return r?void(r=!1):n.call(this,e)};return t?void it(e).on("click",t,a).on("touchend",t,o):void it(e).on("click",a).on("touchend",o)}function k(e){return new RegExp(e.toLowerCase()).test(vt)}function S(e){var t=document.createElement("div"),n=e.charAt(0).toUpperCase()+e.slice(1),i=(e+" "+["Webkit","Moz","O","ms"].join(n+" ")+n).split(" ");for(var r in i){var o=i[r];if(void 0!==t.style[o])return o}return e}function x(){var e=navigator,t=!1,n=[0,0,0],i=null,r="Shockwave Flash",o="application/x-shockwave-flash",a="ShockwaveFlash.ShockwaveFlash";if("undefined"!=typeof e.plugins&&"object"===Xe(e.plugins[r]))i=e.plugins[r].description,!i||"undefined"!=typeof e.mimeTypes&&e.mimeTypes[o]&&!e.mimeTypes[o].enabledPlugin||(t=!0,i=i.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),n[0]=parseInt(i.replace(/^(.*)\..*$/,"$1"),10),n[1]=parseInt(i.replace(/^.*\.(.*)\s.*$/,"$1"),10),n[2]=/[a-zA-Z]/.test(i)?parseInt(i.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if("undefined"!=typeof window.ActiveXObject)try{var s=new ActiveXObject(a);s&&(i=s.GetVariable("$version"),i&&(t=!0,i=i.split(" ")[1].split(","),n=[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)]))}catch(e){}return{installed:t,version:n.join("."),major:n[0],minor:n[1],revision:n[2]}}function T(e,t){var n=e,i=t;return n%320!==0&&(n=100*Math.ceil(e/100),i=Math.round(n/e*t)),{width:n,height:i}}function E(e){var t=e.width,n=e.height,i=e.baseUrl,r=e.webpSupport,o=void 0!==r&&r,a=i+(o?".webp":".jpg");return a+="?mw="+t,0!==n&&(a+="&mh="+n),kt.devicePixelRatio>1&&(a+="&q=70"),a}function P(e){return new He(function(t,n){var i=new Image;i.src=e,i.onload=function(){return t(i)},i.onerror=function(e){return n(e)}})}function A(e){e=e||{};var t={};return e.on=function(n,i){n=[].concat(n);for(var r=0,o=n.length;r<o;r++){var a=n[r];if(!a)throw new Error("Tried to listen for an undefined event.");t[a]||(t[a]=[]),t[a].push(i)}return e},e.once=function(t,n){function i(){n.apply(e.off(t,i),arguments)}return i.handler=n,e.on(t,i)},e.off=function(n,i){n=[].concat(n);for(var r=0,o=n.length;r<o;r++){var a=n[r];if(!a)throw new Error("Tried to remove an undefined event.");if(a in t){var s=t[a].indexOf(i);if(s===-1){for(var c=0,u=t[a].length;c<u;c++)if(t[a][c].handler===i){s=r;break}if(s===-1)return e}t[a].splice(s,1)}}return e},e.fire=function(n){if(!n)throw new Error("Tried to fire an undefined event.");if(n in t)for(var i=t[n].slice(0),r=0,o=i.length;r<o;r++)i[r].apply(e,i.slice.call(arguments,1));return e},e}function M(e){return function(t){function n(t,i){Je(this,n);var r=Ze(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,i));return r.pluginName="vimeo",r.pluginVersion=e.version+"-"+t.config.request.build.js,r.startMonitoring(t,i),r.updateOptions(),r.registerListeners(),r._bitrate=-1,r._rendition=null,r}return Qe(n,t),Ye(n,[{key:"updateOptions",value:function(){this.setOptions(this.getOptions())}},{key:"registerListeners",value:function(){var e=this;this.player.telecine.on("play",function(){return e.playHandler()}),this.player.telecine.on("playing",function(){return e.playingHandler()}),this.player.telecine.on("pause",function(){return e.pauseHandler()}),this.player.telecine.on("ended",function(){return e.endedHandler()}),this.player.telecine.on("seeking",function(){return e.seekingHandler()}),this.player.telecine.on("seeked",function(){return e.seekedHandler()}),this.player.telecine.on("error",function(t){return e.errorHandler(t.message)}),this.player.telecine.on("streambufferstart",function(){return e.bufferingHandler()}),this.player.telecine.on("streambufferend",function(){return e.bufferedHandler()}),this.player.telecine.on("streamchange",function(t){var n=t.index,i=t.streams;e._bitrate=i[n].bitrate,e._rendition=e.player.config.request.files.dash.streams[n].quality}),this.player.events.on($e.bufferStarted,function(){e.viewManager.isSeeking||e.bufferingHandler()}),this.player.events.on($e.bufferEnded,function(){return e.viewManager.isSeeking?void e.seekedHandler():void e.bufferedHandler()}),this.player.events.on($e.error,function(t){e.errorHandler(t)})}},{key:"getCodeForCdn",value:function(e){return 0===e.indexOf("akamai")||0===e.indexOf("akfire")?"AKAMAI":0===e.indexOf("fastly")?"FASTLY":0===e.indexOf("level3")?"LEVEL3":"unknown"}},{key:"getOptions",value:function(){var e=Ke(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"getOptions",this).call(this),t=this.player.telecine.currentFile,i=ze[t.mime],r="dash"===i&&this.player.config.request.files.dash.separate_av;return e.extraParams={param1:i,param2:this.player.config.embed.autoplay,param3:this.player.config.embed.context.replace("Vimeo\\Controller\\",""),param4:r?1:0,param5:this.player.config.video.vod?1:0,param6:t.metadata.origin},e.media={cdn:this.getCodeForCdn(t.metadata.cdn)},e}},{key:"getMediaDuration",value:function(){var e=this.player.telecine.duration;return isNaN(e)&&(e=this.player.config.video.duration),e}},{key:"getPlayhead",value:function(){return this.player.telecine.currentTime}},{key:"getResource",value:function(){return this.player.telecine.currentFile.src}},{key:"getTitle",value:function(){return this.player.config.video.id}},{key:"getRendition",value:function(){var e=this.player.telecine.currentFile,t=null;switch(ze[e.mime]){case"dash":t=this._rendition;break;case"progressive":t=e.metadata.quality}return t}},{key:"getBitrate",value:function(){var e=this.player.telecine.currentFile;return"dash"===ze[e.mime]?this._bitrate:-1}}]),n}(e.plugins.Generic)}function L(){return Yt=Qt,Kt=new Pn,Cn(),Kt.init(),In(),Kt}function O(e){return kt.iOS&&"onpagehide"in window?void window.addEventListener("pagehide",e,!1):void window.addEventListener("beforeunload",e,!1)}function C(e){function t(){var t=e.telecine&&e.telecine.currentScanner;switch(t){case"HTMLScanner":return"HTML5";case"SWFScanner":return"Flideo";case"moogaloop":return"Moogaloop";default:return"Player"}}function n(t,n){window._gaq&&window._gaq.push(["player._trackSocial",t,n,e.config.video.share_url])}function i(e,n,i){var r=(new Date).getTime()-n;window._gaq&&window._gaq.push(["player._trackTiming",t(),e,r,i])}function r(){e.config.request.flags.dnt||(e.events.on($e.facebookButtonPressed,function(){n("Facebook","share")}),e.events.on($e.twitterButtonPressed,function(){n("Twitter","tweet")}),e.events.on($e.tumblrButtonPressed,function(){n("Tumblr","share")}),e.events.on($e.emailButtonPressed,function(){n("Email","email")}))}function o(){var t;e.events.on([$e.bufferStarted,$e.scrubbingStarted],function(e){t||(t=e||(new Date).getTime())}),e.events.on($e.bufferEnded,function(){if(t>0){var n=e.telecine.currentFile.metadata.quality,r="Buffer Time";f&&(f=!1,r="Start Time"),i(r,t,n),t=null}})}function a(){function t(){o=document.createElement("script"),o.id="player-comscore",o.async=!0,o.src=e.config.request.urls.comscore_js;var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(o,t)}function n(){try{r=new ns_.StreamingTag({customerC2:e.config.request.comscore_id}),a&&(i(),a=!1)}catch(e){}}function i(){try{r.playContentPart({ns_st_ci:e.config.video.id})}catch(e){}}if(!e.config.request.flags.dnt&&e.config.request.flags.plays){var r,o=document.getElementById("player-comscore"),a=!1;e.events.on($e.played,function(){if(!r){if("undefined"==typeof ns_)return o||t(),o.addEventListener("load",n,!1),void(a=!0);n()}i()}),e.events.on($e.paused,function(){try{r&&r.stop()}catch(e){}})}}function s(){"tracking_pixel"in e.config.video&&(e.config.request.flags.dnt||e.config.request.flags.plays&&e.events.on($e.playInitiated,function(){try{(new Image).src=e.config.video.tracking_pixel}catch(e){}}))}function c(){e.events.on($e.configChanged,function(){l!==e.config.request.session&&(window._gaq&&window._gaq.push(["player._trackPageview","/video/"+e.config.video.id]),f=!0)})}function u(){if(e.config.request.flags.youbora&&!e.config.request.flags.dnt&&e.config.request.flags.plays){"dev"===e.config.request.build.js&&(Pt.debugLevel=4),Pt.utils.ResourceParser.cdnsEnabled=["Level3","Akamai","Fastly"];var t=M(Pt),n=new t(e,{accountCode:e.config.request.youbora_account,httpSecure:!0,ads:{adsExpected:!1}});e.events.on($e.configChanged,function(e){n&&e&&(n.endedHandler(),n.updateOptions())})}}function d(){if(e.config.request.flags.mixpanel&&!e.config.request.flags.dnt){new Bn(e)}}var l=e.config.request.session,f=!0;return r(),o(),a(),s(),c(),u(),d(),e.events.fire($e.analyticsModuleReady),{}}function I(e){return e=e.replace("#",""),"string"==typeof e&&(3===e.length||6===e.length)&&!isNaN(parseInt(e,16))}function q(e){var t=/rgba?\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})(,\s*([\d\.]+))?\)/.exec(e);if(!t)throw new Error("Invalid rgb value");return{red:parseInt(t[1],10),green:parseInt(t[2],10),blue:parseInt(t[3],10),alpha:parseFloat(t[5])||1}}function R(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(1===t.length&&t[0]instanceof R){var i=t[0];return this.red=i.red,this.green=i.green,this.blue=i.blue,this.alpha=i.alpha,this.hue=i.hue,this.saturation=i.saturation,this.lightness=i.lightness,this}if(1===t.length){if("string"==typeof t[0]&&t[0].indexOf("rgb")>=0)return this.rgba=q(t[0]),this;if(!I(""+t[0]))throw new Error("Invalid hex value");return this.hex=t[0],this}if(3===t.length||4===t.length){for(var r=0;r<3;r++)if(isNaN(parseInt(t[r],10))||parseInt(t[r],10)<0||parseInt(t[r],10)>255)throw new Error("Invalid rgb value");if(t[3]&&parseFloat(t[3])<0||parseFloat(t[3])>1)throw new Error("Invalid alpha value");return this.rgba={red:t[0],green:t[1],blue:t[2],alpha:parseFloat(t[3])||1},this}throw new Error("Invalid color")}function F(e){var t=arguments.length<=1||void 0===arguments[1]?[]:arguments[1];if(!e||"null"===e||0===t.length)return{track:null};var n=e.split("."),i=et(n,2),r=i[0],o=i[1],a=r.substr(0,2),s=r!==a,c=t.filter(function(e){return s?e.language===r||e.language===a:e.language===a}).sort(function(e,t){var n=2*(e.language===a&&e.kind===o)+2*(e.language===r)+1*(e.kind===o),i=2*(t.language===a&&t.kind===o)+2*(t.language===r)+1*(t.kind===o);return i-n});return c.length>0?{track:c[0],exactMatch:c[0].language===r&&c[0].kind===o}:{track:null}}function B(e){function t(e,t,n){this.message=e,this.name=t,this.source=n}function n(n){switch(e.config.view){case Ve.privateLocked:throw new t("The video is private.","PrivacyError",n);case Ve.privatePassword:throw new t("The video is password-protected. The viewer must enter the password first.","PasswordError",n);case Ve.error:throw new t(e.config.message,"NotFoundError",n)}}function i(){var e=[];for(var t in H)if(H.hasOwnProperty(t)&&0!==t.indexOf("_")){if("function"==typeof H[t]){e.push(t);continue}"function"==typeof H[t].get&&e.push("get"+t.charAt(0).toUpperCase()+t.slice(1)),"function"==typeof H[t].set&&e.push("set"+t.charAt(0).toUpperCase()+t.slice(1))}return e.sort()}function r(){C||(d({event:"loaded",data:{id:e.config.video.id}}),C=!0)}function o(e){if(!e||""===e)return{};if("object"===("undefined"==typeof e?"undefined":Xe(e)))return e;try{return E=2,JSON.parse(e)}catch(n){var t={};return e.split("&").forEach(function(e){try{var n=e.split("="),i=decodeURIComponent(n[0]),r=decodeURIComponent(n[1]);if("id"===i)return;"params"===i&&(i="value"),r=r.split(",")[0],t[i]=r}catch(e){}}),E=1,t}}function a(e){if(!e||"_"===e.substr(0,1))return null;switch(1===E&&(e=e.replace("api_","")),e){case"changeColor":return H.color.set;case"paused":return H.paused.get;case"seekTo":return H.currentTime.set}if("function"==typeof H[e])return H[e];var t=e.substr(0,3),n=e.substr(3,1).toLowerCase()+e.substr(4);return H[n]&&H[n][t]?H[n][t]:null}function s(e){if(e.source===window.parent){var n=o(e.data),r=n.method,s=n.value;if(void 0!==r)try{var c=a(r);if(!c)throw new t("“"+r+"” is not a valid method. Valid methods are: "+i().join(", ")+".","TypeError",r);var u=[s];c===H.enableTextTrack&&"object"===("undefined"==typeof s?"undefined":Xe(s))&&(u=[s.language,s.kind]);var f=c.apply(e,u),h=0!==r.indexOf("get")&&"paused"!==r;if(f===b||h&&E<3)return;d({method:r,value:void 0!==f&&""!==f?f:s})}catch(e){l(e)}}}function c(e){var t=e.event;if(1===E)for(var n in D)if(D[n]===e.event){t=n;break}switch(t){case"onSeek":case"onProgress":delete e.data.percent,delete e.data.duration;break;case"onLoading":delete e.data.seconds,delete e.data.duration}var i="method="+encodeURIComponent(t||e.method);i+="&params=";var r=[];if(void 0!==e.value)r.push(encodeURIComponent(e.value));else if("object"===Xe(e.data))for(var o in e.data)r.push(encodeURIComponent(e.data[o]));else void 0!==e.data&&r.push(encodeURIComponent(e.data));return e.player_id&&r.push(e.player_id),i+=r.join(",")}function u(e){if(e.event){for(var t in N)if(N[t]===e.event){e.event=t;break}"cuechange"===e.event&&(e.data.text=e.data.cues[0].text,e.data.html=e.data.cues[0].html,delete e.data.cues)}return JSON.stringify(e)}function d(t){if((!t.event||(k.fire(t.event,t.data),w[t.event]))&&S){e.config.embed&&e.config.embed.player_id&&(t.player_id=e.config.embed.player_id);try{1===E?t=c(t):2===E&&(t=u(t)),"object"!==("undefined"==typeof t?"undefined":Xe(t))||"ready"!==t.event&&x||(t=JSON.stringify(t))}catch(e){}if(window.parent!=window)try{window.parent.postMessage(t,y&&"null"!==y?y:"*")}catch(e){}}}function l(e){var n={event:"error",data:{message:"An error occurred.",name:"Error",method:e.source}};e instanceof t&&(n={event:"error",data:{message:e.message,name:e.name,method:e.source}}),d(n)}function f(){if(P&&L){try{switch(L){case"not-supported":throw new t("This video is not supported in this browser.","NotSupportedError");case"no-files":throw new t("There was an error loading the files for this video.","FileError");default:throw new t("An error occurred during playback.","PlaybackError")}}catch(e){l(e)}L=null}}function p(){"embed"in e.config&&e.config.embed.on_site||(window.addEventListener?window.addEventListener("message",s,!1):window.attachEvent("onmessage",s))}function v(){e.events.on($e.played,function(t){M||(M=!0,d({event:"play",data:{seconds:h(t),percent:h(t/e.config.video.duration),duration:h(e.config.video.duration)}}))}),e.events.on($e.paused,function(t){M=!1,d({event:"pause",data:{seconds:h(t),percent:h(t/e.config.video.duration),duration:h(e.config.video.duration)}})}),e.events.on($e.ended,function(){M=!1,d({event:"ended",data:{seconds:h(e.config.video.duration),percent:1,duration:h(e.config.video.duration)}})}),e.events.on($e.playProgress,function(e,t,n){d({event:"timeupdate",data:{seconds:h(e),percent:h(n),duration:h(t)}})}),e.events.on($e.loadProgress,function(e,t,n){var i={event:"progress",data:{percent:h(n),duration:h(t),seconds:h(e)}};E<3&&(i.data.bytesLoaded=-1,i.data.bytesTotal=-1),d(i)}),e.events.on($e.seeked,function(e,t,n){d({event:"seeked",data:{seconds:h(e),percent:h(n),duration:h(t)}})}),e.events.on($e.volumeChanged,function(e){d({event:"volumechange",data:{volume:h(e)}})}),e.events.on($e.error,function(e){L=e,f()}),e.events.on($e.apiError,function(e){l(new t(e.message,e.name,e.method))}),e.events.on($e.cueChanged,function(e){var t=arguments.length<=1||void 0===arguments[1]?[]:arguments[1],n=e||{},i=n.language,r=void 0===i?null:i,o=n.label,a=void 0===o?null:o,s=n.kind,c=void 0===s?null:s;d({event:"cuechange",data:{label:a,language:r,kind:c,cues:t}})}),e.events.on($e.captionsChanged,function(e){I=e;var t=e||{},n=t.language,i=void 0===n?null:n,r=t.label,o=void 0===r?null:r,a=t.kind,s=void 0===a?null:a;d({event:"texttrackchange",data:{label:o,language:i,kind:s}})}),e.config.request.flags.dnt||e.events.on($e.emailCaptureSuccess,function(){d({event:"emailcapture"})})}function g(){e.events.on(Ge.reset,function(){L=null,O=!1,C=!1})}function m(){e.events.on($e.configChanged,function(t){T&&setTimeout(function(){var t=!0;e.events.fire(Ge.changeVolume,T,t)},0),t&&r()})}var y=document.referrer||e.config.request.referrer;try{y=decodeURIComponent(y)}catch(e){y=unescape(y)}var _,b="_ASYNC_",w={ready:!0},k=A(),S=!(!window.postMessage||!window.parent.postMessage),x=!(kt.browser.ie>=8&&kt.browser.ie<10),T=null,E=e.config.embed.api,P=!1,M=!1,L=null,O=!1,C=!1,I=null,q=["play","pause","ended","timeupdate","progress","seeked","error","texttrackchange","cuechange","volumechange","loaded","emailcapture"],B=q.filter(function(e){return"emailcapture"!==e}),D={onFinish:"ended",onLoading:"progress",onLoad:"ready",onProgress:"timeupdate",onPlay:"play",onPause:"pause",onSeek:"seeked"},N={playProgress:"timeupdate",loadProgress:"progress",finish:"ended",seek:"seeked"};t.prototype=new Error;var H={_setEmbedSetting:function(t,n){e.config.embed.on_site&&(n="object"===("undefined"==typeof n?"undefined":Xe(n))?n:Number(n),"badge"===t&&(n?n=_:_=e.config.embed.settings.badge),e.config.embed.settings[t]=n,e.events.fire($e.embedSettingChanged,t,n),e.events.fire($e.configChanged,e.config))},_showOverlay:function(t,n){e.events.fire(Ge.showOverlay,t,n)},_toggleDebugHud:function(){e.events.fire($e.debugButtonPressed)},addEventListener:function(n,i){if(n in D&&(n=D[n]),n in N&&(n=N[n]),q.indexOf(n)<0)throw new t("“"+n+"” is not a valid event. Valid events are: "+B.join(", ")+".","TypeError","addEventListener");i?k.on(n,i):w[n]=!0,("loaded"===n&&e.config.view===Ve.main||e.config.view===Ve.privateUnlocked)&&r()},removeEventListener:function(e,t){t?k.off(e,t):w[e]=!1},play:function(){n("play");var i="[object MessageEvent]"===Object.prototype.toString.call(this);if(i&&"undefined"!=typeof kt&&(kt.iPhone||kt.iPad||kt.iPod)&&!O)throw new t("The viewer must initiate playback first.","Error","play");e.events.fire($e.playButtonPressed)},pause:function(){n("pause"),e.events.fire($e.pauseButtonPressed)},loadVideo:function(i){if(isNaN(Number(i))&&i.match(null===new RegExp("^https?://"+e.config.player_url+"/video/([0-9]+)/config")))throw new t("The config url must be a valid Vimeo url.","TypeError","loadVideo");return e.loadVideo(i).then(function(){return E>2&&d({method:"loadVideo",value:i}),i}).catch(function(){try{n("loadVideo")}catch(e){if(e instanceof t)return void l(e);l(new t("An error occurred loading the video.","Error","loadVideo"))}}),b},unload:function(){e.config.view!==Ve.main&&e.config.view!==Ve.privateUnlocked||e.events.fire(Ge.reset)},enableTextTrack:function(n){var i=arguments.length<=1||void 0===arguments[1]?null:arguments[1],r=("text_tracks"in e.config.request?e.config.request.text_tracks:[]).map(function(e){return e.language=e.lang,e}),o=r.some(function(e){return e.language.toLowerCase()===n.toLowerCase()});if(!o)throw new t("There are no tracks for “"+n.toUpperCase()+"”.","InvalidTrackLanguageError","enableTextTrack");var a=i?n+"."+i:n,s=F(a,r),c=s.track;if(!c||i&&c.kind!==i)throw new t("There are no "+i+" tracks for “"+n.toUpperCase()+"”.","InvalidTrackError","enableTextTrack");return e.events.fire(Ge.turnCaptionsOn,c.id,!0),E>2&&e.events.once($e.captionsChanged,function(e,t){d({method:"enableTextTrack",value:{label:e.label,language:e.language,kind:e.kind}})}),b},disableTextTrack:function(){e.events.fire(Ge.turnCaptionsOff)},ping:function(){return e.config.video.id},autopause:{get:function(){if(e.telecine&&"moogaloop"===e.telecine.currentScanner)throw new t("Autopause is not supported in the current player.","UnsupportedError","getAutopause");return!!e.config.embed.autopause},set:function(n){if(e.telecine&&"moogaloop"===e.telecine.currentScanner)throw new t("Autopause is not supported in the current player.","UnsupportedError","setAutopause");e.config.embed.autopause=!!n}},color:{get:function(){return e.config.embed.color.replace("#","")},set:function(n){if("moogaloop"===e.telecine.currentScanner)return void e.events.fire(Ge.changeColor,n);if(e.config.embed.settings.color&&!e.config.embed.on_site)throw new t("The creator of the video has chosen to always use "+new R(e.config.embed.color).hex+".","EmbedSettingsError","setColor");try{var i=new R(n);e.events.fire(Ge.changeColor,i.hex)}catch(e){throw new t("The color should be 3- or 6-digit hex value.","TypeError","setColor")}var r=new R(23,35,34,.75),o=r.contrast(i).ratio;if(o<3){var a=i.clone().lighten(5,3,r);throw new t(i.hex+" does not meet minimum contrast ratio. We recommend using brighter colors. (You could try "+a.hex+" instead.) See WCAG 2.0 guidelines: http://www.w3.org/TR/WCAG/#visual-audio-contrast","ContrastError","setColor")}}},currentTime:{get:function(){return e.telecine&&e.telecine.currentTime>.1?h(e.telecine.currentTime):0},set:function(n){if(n=parseFloat(n),isNaN(n)||n<0||n>e.config.video.duration)throw new t("Seconds must be a positive number less than the duration of the video ("+h(e.config.video.duration)+").","RangeError","setCurrentTime");var i="[object MessageEvent]"===Object.prototype.toString.call(this);if(i&&"undefined"!=typeof kt&&(kt.iPhone||kt.iPad||kt.iPod)&&!O)throw new t("The viewer must initiate playback first.","Error","setCurrentTime");return e.events.fire(Ge.seek,null,n),e.events.fire($e.mousedOver),E>2&&e.events.once($e.seeked,function(e,t,n){d({method:"setCurrentTime",value:e})}),b}},duration:{get:function(){return h(e.config.video.duration)}},ended:{get:function(){return!!e.telecine.ended}},loop:{get:function(){return!!e.config.embed.loop},set:function(t){e.events.fire(Ge.changeLoop,t)}},paused:{get:function(){return!(e.telecine&&"paused"in e.telecine)||!!e.telecine.paused}},textTracks:{get:function(){var t=e.telecine?e.telecine.video.textTracks:[];return t.map(function(e){return{label:e.label,language:e.language,kind:e.kind,mode:e===I?"showing":"disabled"}})}},videoEmbedCode:{get:function(){return e.config.video.embed_code}},videoHeight:{get:function(){return e.telecine.videoHeight||e.config.video.height}},videoId:{get:function(){return e.config.video.id}},videoTitle:{get:function(){return e.config.video.title}},videoWidth:{get:function(){return e.telecine.videoWidth||e.config.video.width}},videoUrl:{get:function(){if(!e.config.video.url)throw new t("The URL is not available because of the video’s privacy settings.","PrivacyError","getVideoUrl");return e.config.video.url}},volume:{get:function(){var t=h(e.config.request.cookie.volume);return 1===E?Math.round(100*t):t},set:function(n){if(n=parseFloat(n),1===E&&(n/=100),isNaN(n)||n<0||n>1)throw new t("Volume should be a number between 0 and 1.","RangeError","setVolume");T=n;var i=!0;e.events.fire(Ge.changeVolume,n,i)}},_like:{get:function(){return!!e.config.user.liked},set:function(t){if(e.config.embed.on_site){if(e.config.user.liked===t)return;e.events.fire($e.likeButtonPressed,t)}}},_watchLater:{get:function(){return!!e.config.user.watch_later},set:function(t){if(e.config.embed.on_site){if(e.config.user.watch_later===t)return;e.events.fire($e.watchLaterButtonPressed,t)}}}};return e.events.on($e.playInitiated,function(){O=!0}),v(),g(),m(),e.events.fire($e.apiModuleReady),e.events.once($e.ready,function(){P=!0,p(),d({event:"ready"}),f()}),H}function D(e,t){function n(){return Math.max(10,Math.round(.045*e.element.clientHeight))+"px"}function i(){t.style.fontSize=n()}function r(){t.classList.add("hidden"),t.setAttribute("hidden","")}function o(){"picture-in-picture"!==e.telecine.presentationMode&&(t.classList.remove("hidden"),t.removeAttribute("hidden"))}function a(e){var t=e.text.replace("\n","<br>").split(/<br ?\/?>/),n=t.reduce(function(e,t){return Math.max(e,t.replace(/<\/?\w>/g,"").length)},0),i="+"+Array(n+3).join("-")+"+";return t=t.map(function(e){var t=n-e.replace(/<\/?\w>/g,"").length,i=Math.floor(t/2),r=Math.ceil(t/2);return'<span class="bar">|</span>&nbsp;'+Array(i+1).join("&nbsp;")+e+Array(r+1).join("&nbsp;")+'&nbsp;<span class="bar">|</span>'}),i+"<br>"+t.join("<br>")+"<br>"+i}function s(){for(var e=arguments.length<=0||void 0===arguments[0]?[]:arguments[0];t.firstChild;)t.removeChild(t.firstChild);if(e.length){var n=document.createDocumentFragment();e.forEach(function(e){var t=document.createElement("span"),i=e.html;v&&(i=a(e)),t.innerHTML=i,n.appendChild(t)}),t.appendChild(n)}}function c(){e.events.on($e.cueChanged,function(e){var t=arguments.length<=1||void 0===arguments[1]?[]:arguments[1];return g=t,s(t),t.length?h?void o():void(p=!0):void r()}).on($e.captionsChanged,function(e){return e?(t.setAttribute("lang",e.language),void t.setAttribute("dir",e.rtl?"rtl":"ltr")):(t.removeAttribute("dir"),void t.removeAttribute("lang"))}).on($e.playInitiated,function(){h=!0,p&&(p=!1,o())}).on($e.pictureInPictureActivated,function(){r()}).on($e.pictureInPictureDeactivated,function(){o()}).on(Ge.reset,function(){h=!1,r()}).on(Ge.setEffect,function(e){v="ascii"===e,s(g)})}function u(){i(),window.addEventListener("resize",i,!1),e.events.on([$e.didEnterFullscreen,$e.didExitFullscreen,$e.enteredTinyMode,$e.enteredMiniMode,$e.enteredNormalMode],i)}function d(){e.events.on($e.controlBarVisibilityChanged,function(e){return e?void t.classList.add("with-controls"):void t.classList.remove("with-controls")})}function l(){e.events.on($e.overlayOpened,function(){t.classList.add("invisible")}).on($e.overlayClosed,function(){t.classList.remove("invisible")})}function f(){e.events.on($e.ended,function(){"nothing"!==e.config.embed.outro&&t.classList.add("invisible")}).on([$e.played,$e.scrubbingStarted],function(){t.classList.remove("invisible")})}var h=!1,p=!1,v=!1,g=[];return c(),u(),d(),l(),f(),{}}function N(e){function t(){return s&&s-Dn<=(new Date).getTime()}function n(e){var t=(new Date).getTime()+1e3*e,n=1e3*e-Dn-5e3;return d=setTimeout(function(){"onLine"in navigator&&!navigator.onLine||(u=r(a.video.id))},n),t}function i(e){clearTimeout(d);var t=a;if(isNaN(e)&&"string"!=typeof e)return a=e,s=n(a.request.expires),He.resolve({old:t,loaded:a});var i=(new Date).getTime(),r=a&&a.video&&a.video.id,o=a&&a.request&&a.request.session,c=a&&a.request&&a.request.referrer,u=a&&a.embed&&a.embed.on_site,f=a&&a.embed&&a.embed.context,h=e;if(!isNaN(e)){var p=a&&a.player_url?"https://"+a.player_url:"";h=p+"/video/"+e+"/config"+window.location.search}return c&&(h+=(h.indexOf("?")===-1?"?":"&")+"referrer="+encodeURIComponent(c)),l(h,{allowErrorStatuses:!0}).then(function(e){a=JSON.parse(e),a.view!==Ve.error&&(s=n(a.request.expires),o&&a.video.id===r&&(a.request.session=o),c&&(a.request.referrer=c),u&&(a.embed.on_site=1,a.embed.context=f));(new Date).getTime()-i;return{old:t,loaded:a}})}function r(){clearTimeout(d);var e=(new Date).getTime(),t=a&&a.request.referrer,i=a.request,r=i.signature,c=i.session,f=i.timestamp,h=i.expires,p="https://"+a.player_url+"/video/"+a.video.id+"/config/request?session="+c+"&signature="+r+"&time="+f+"&expires="+h;return l(p).then(function(i){a.request=JSON.parse(i),t&&(a.request.referrer=t),s=n(a.request.expires);(new Date).getTime()-e;return u=null,o.fire($e.requestConfigReloaded),a.request})}var o=e.events,a=null,s=null,c=null,u=null,d=null;return window.addEventListener("online",function(){t()&&(u=r(a.video.id))}),{get isExpired(){return t()},load:function(e){return i(e)},reload:function(){return a&&a.video.id?i(a.video.id):He.reject(new Error("No config loaded."))},toJSON:function(){return a},get config(){return a},set config(e){a=e},verify:function(){return t()?(u||(u=r()),u):He.resolve(a.request)},get _video(){return c},set _video(e){c=e}}}function H(e){return function(t){return ze[t.mime]===e}}function V(e){var t=e.fps;return"metadata"in e&&(t=e.metadata.fps),t>30}function j(e){return e.quality||e.metadata.quality}function z(e){return"string"!=typeof e&&(e=j(e)),parseInt(e,10)}function U(e){return z(e)>=720}function W(e){var t=Vn(e).filter(V).map(j);return function(e){return!(t.indexOf(j(e))!==-1&&!V(e))}}function G(e){return"fps"in e?e.fps:"metadata"in e&&"fps"in e.metadata?e.metadata.fps:0;
}function $(){var e=arguments.length<=0||void 0===arguments[0]?"desc":arguments[0];return function(t,n){var i=z(t),r=G(t),o=z(n),a=G(n);return"asc"===e?i-o||r-a:o-i||a-r}}function X(e,t){var n=j(e);return n=n.replace("1440p","2K").replace("2160p","4K"),U(e)&&t&&(n+=t),n}function J(e){var t=e.files,n=void 0===t?[]:t,i=e.preference,r=void 0===i?"360p":i,o=e.priorityOffset,a=void 0===o?0:o;n=Vn(n),n.sort($());var s=n.map(j);if(r){s.indexOf(r)===-1&&(s.push(r),s.sort(function(e,t){return z(t)-z(e)}));var c=s.indexOf(r),u=s.splice(0,c);u.reverse(),s.push.apply(s,u)}return n.map(function(e){return{id:e.id,src:e.url,mime:e.mime,priority:s.indexOf(e.quality)+1+a,metadata:{profile:e.profile,cdn:e.cdn,origin:e.origin,quality:e.quality,fps:e.fps}}})}function Y(e){function t(){M=!1,L=!1,I=!1,q=!1,R=!1,F=!1,j=null,z=null,B=null,U=null,W=!1,G=0,X=0,J=e.config.embed.autoplay,V=u(),T=n(),E=e.config.request.urls.blurr,N="auto"}function n(){return parseInt(Date.now()/1e3,10)}function i(){return Date.now?Date.now():(new Date).getTime()}function r(e){return i()-e}function o(e){return n()-e}function a(){var t=document.createElement("a");return t.href=e.config.request.referrer,t.origin||t.protocol.replace(":","")+"://"+t.host}function s(){A=!0,setTimeout(c,P)}function c(t){var n=!0;if(t){if(n=!1,y&&L&&l("video-buffered",{time:r(b)/1e3,video_time:k}),_&&(L&&!F&&l("video-stopped-during-playback",{time:r(w)/1e3,video_time:S}),C+=r(w)/1e3),M&&!L){var i=r(m);i>=1e3&&!e.telecine.paused&&l("video-exit-before-start",{time:i/1e3})}L&&!e.config.embed.loop&&l("video-playback-session",v(V))}var o=x;if(x=[],0===o.length)return void s();var a=JSON.stringify(o);if(navigator.sendBeacon&&navigator.sendBeacon(E,a))return void s();var c=new XMLHttpRequest;c.open("POST",E,n),c.setRequestHeader("Content-Type","text/plain"),c.onload=function(){},c.send(a),s()}function u(){return{session_id:e.config.request.session,account_type:e.config.video.owner?e.config.video.owner.account_type:null,referrer:e.config.request.referrer,video_duration:e.config.video.duration,device_pixel_ratio:window.devicePixelRatio||1,startup_time:0,video_start_position:0,video_end_position:0,starting_profile:0,abandoned_during_buffer:0,forced_embed_quality:"none",_fullscreen:[],number_of_down_switches:0,number_of_up_switches:0,number_of_buffers:0,stayed_on_auto:1,alert_displayed:0,alert_dismissed:"none",_speeds:[],_playedProfiles:{},_targetProfiles:{},_embed_size:{},_target_profile_id:{},_profiles:{},session_playback_duration:0}}function d(){var t=e.telecine.video.currentFile||{},n=t.id,i=void 0===n?0:n,r=t.mime,o=void 0===r?Ue.h264:r,a=t.metadata;a=void 0===a?{}:a;var s=a.profile,c=void 0===s?-1:s,u=!1,d=!1;switch(o){case Ue.dash:0===t.restrictedStreamIndexes.length&&(u=!0),e.config.request.files.dash.separate_av&&(d=!0);var l=H,f=l.id;i=void 0===f?0:f;var h=l.profile;c=void 0===h?-1:h;break;case Ue.hls:u=!0}var p={clip_id:e.config.video.id,video_file_id:Number.isInteger(Number(i))?parseInt(i,10):0,delivery:ze[o],profile_id:c,auto:Number(u),player_type:"html",version:e.config.request.build.js,autoplay:J,cdn:t.metadata.cdn||"akamai",origin:t.metadata.origin,secure:t.src&&0===t.src.indexOf("https"),vod:e.config.video.vod?1:0,embed:!e.config.embed.on_site,context:e.config.embed.context,separate_av:d?1:0,video_shape:kt.threeSixtyVideo&&e.config.video.is_panorama?"spatial_mono":"flat_mono"};if(e.config.request.ab_tests)for(var v in e.config.request.ab_tests)p[v+"_test"]=1,p[v+"_group"]=e.config.request.ab_tests[v].group;return p}function l(t,n){var i=d();for(var r in n)n.hasOwnProperty(r)&&(i[r]=n[r]);i.name=t,i.event_time=e.config.request.timestamp+o(T),x.push(i),A||s()}function f(){var t=e.config.video.duration;e.config.request.flags.blurr&&E&&(e.events.on($e.playInitiated,function(){M||e.performDelegateAction(je.playLog,function(n){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];J=r.continuous?2:e.config.embed.autoplay,l("video-start-attempt"),M=!0,m=i();var o=e.config.user.progress,a=e.config.video.duration;!o||e.config.embed.autoplay||e.config.embed.time||setTimeout(function(){var e=o/a*100,n=t<o?"seeked_back":"resume";n=0===t?"beginning":n,l("video-start-attempt-from-resume",{state:n,duration:a,percent:e,playback_time:t,resume_time:o})},1e4)})}),e.events.on($e.playProgress,function(e){if(t=Math.min(e,t),!L){L=!0;var n=r(m)/1e3;l("video-start-time",{time:n}),V.startup_time=n,V.video_start_position=e}}),e.events.on($e.bufferStarted,function(){b||(k=e.telecine.currentTime,b=i()),y=!0}),e.events.on($e.bufferEnded,function(){return y=!1,L?(l("video-buffered",{time:r(b)/1e3,video_time:k}),void(b=null)):void(b=null)}),e.events.on($e.ranIntoBuffer,function(t){w||(S=e.telecine.currentTime,w=i()),_=!0,t&&(D=!0)}),e.events.on($e.playbackResumed,function(){return!L||F?void(w=null):(C+=r(w)/1e3,F=!0,l("video-stopped-during-playback",{time:r(w)/1e3,video_time:S}),w=null,void(_=!1))}),e.events.on($e.error,function(t){var n=arguments.length<=1||void 0===arguments[1]?{final:!0}:arguments[1];if(n.final!==!1&&M){var i=["not-supported","decode","network","unknown"],r=i.indexOf(t)!==-1;return L?void(r&&l("video-playback-error",{type:t,video_time:e.telecine.currentTime})):void(r&&l("video-start-failure",{type:t}))}}),e.events.on($e.didEnterFullscreen,function(e,t){I||(l("video-enter-fullscreen",{fullPlayer:e,requested:t,referrer:a()}),I=!0)}),O(c))}function h(){e.events.on(Ge.changeQuality,function(t){e.telecine.video.currentFile.mime===Ue.dash&&("auto"===t||q?"auto"===t&&q&&!R&&(l("video-switch-back-to-auto",{quality:N,auto:1}),R=!0):(l("video-switch-from-auto",{quality:t,auto:0}),q=!0),N=t)}),e.events.on($e.streamChanged,function(e){H=e})}function p(){function t(e,t){return e+":"+t}function n(e){V._embed_size[e]=V._embed_size[e]||0,U=e}e.events.on($e.playInitiated,function(){U=t(e.config.video.video_width,e.config.video.video_height),n(U)}),e.events.on($e.playProgress,function(e){V._embed_size[U]+=1,W||(W=!0,G=e),X=e,V.video_end_position=e}),e.events.on(Ge.seek,function(){W=!1,V.session_playback_duration+=X-G}),e.events.on($e.seeked,function(e){G=e}),e.events.on($e.ended,function(){W&&(W=!1),V.session_playback_duration+=e.config.video.duration-G,V.video_end_position=e.config.video.duration}),e.events.on($e.didEnterFullscreen,function(e,t){V._fullscreen.push({start:i()})}),e.events.on($e.didExitFullscreen,function(e,t){var n=V._fullscreen.length-1;V._fullscreen[n].end=i()}),e.events.on($e.adaptiveBandwidth,function(e){var t=e.speed;V._speeds.push(t)}),e.events.on($e.streamChanged,function(e,t,n){var r=e.profile,o=i(),a=n[t].bitrate;if(V._profiles[r]=V._profiles[r]||[],V.starting_profile||(V.starting_profile=r),j){var s=V._profiles[j].length-1;V._profiles[j][s]&&(V._profiles[j][s].end=o)}B&&(a>B?V.number_of_up_switches+=1:V.number_of_down_switches+=1),V._profiles[r].push({start:o}),V._playedProfiles[r]={bitrate:a,width:n[t].width,height:n[t].height},j=r,B=a}),e.events.on($e.ranIntoBuffer,function(e){V.number_of_buffers+=1,V.abandoned_during_buffer=1}),e.events.on(Ge.changeQuality,function(e){"auto"!==e&&(V.stayed_on_auto=0)}),e.events.on($e.playbackResumed,function(){V.abandoned_during_buffer=0}),e.events.on($e.resize,function(e){var i=e.width,r=e.height;if(i&&r){var o=t(i,r);n(o)}}),e.events.on($e.streamTargetChange,function(e,t,n){var r=e.profile,o=n[t].bitrate,a=i();if(V._target_profile_id[r]=V._target_profile_id[r]||[],z){var s=V._target_profile_id[z].length-1;V._target_profile_id[z][s]&&(V._target_profile_id[z][s].end=a)}V._target_profile_id[r].push({start:a}),V._targetProfiles[r]={bitrate:o,width:n[t].width,height:n[t].height},z=r}),e.events.on($e.forcedQuality,function(e){V.forced_embed_quality=e}),e.events.on($e.alertVisibilityChanged,function(e,t){return e?void(V.alert_displayed=1):void(V.alert_dismissed=t)})}function v(t){var n={},r=i(),o=$("asc"),a="MediaSourceScanner"===e.telecine.currentScanner,s="HTMLScanner"===e.telecine.currentScanner,c=[];s&&(c=e.config.request.files.progressive),a&&(c=e.config.request.files.dash.streams);var u=Vn(c).sort(o).map(function(e){return e.profile});for(var d in t)t.hasOwnProperty(d)&&(n[d]=t[d]);n.seconds_in_fullscreen=n._fullscreen.reduce(function(e,t){var n=t.end||r;return(n-t.start)/1e3+e},0),n.session_playback_duration+=X-G;var l=null;if(Object.keys(n._embed_size).forEach(function(e){var t=n._embed_size[e];t>l&&(l=e)}),l){var f=l.split(":"),h=et(f,2),p=h[0],v=h[1];n.embed_width=parseInt(p,10),n.embed_height=parseInt(v,10)}var g=-1,m=0,y=null;if(Object.keys(n._profiles).forEach(function(e){var t=u.indexOf(parseInt(e,10));t>g&&(g=t);var i=n._profiles[e].reduce(function(e,t){var n=t.end||r;return(n-t.start)/1e3+e},0);i>m&&(m=i,y=e)}),n.highest_profile=u[g],n.highest_available_profile=u[u.length-1],n.most_used_profile=parseInt(y,10),n.percent_watched=n.session_playback_duration/e.config.video.duration,a&&!function(){n.max_speed=Math.round(Math.max.apply(Math,n._speeds))/1e3,n.min_speed=Math.round(Math.min.apply(Math,n._speeds))/1e3;var e=n._speeds.reduce(function(e,t){return e+t},0);n.average_speed=Math.round(e/n._speeds.length)/1e3;var t=0,i=null;Object.keys(n._target_profile_id).forEach(function(e){var o=n._target_profile_id[e].reduce(function(e,t){var n=t.end||r;return(n-t.start)/1e3+e},0);o>t&&(t=o,i=e)}),n.target_profile=parseInt(i,10);var o=[];Object.keys(n._playedProfiles).forEach(function(e){var t=n._playedProfiles[e],i=t.width,r=t.height,a=parseInt(i,10)*parseInt(r,10);o.push(a)});var a=o.reduce(function(e,t){return e+t},0)/o.length,s=[];Object.keys(n._targetProfiles).forEach(function(e){s.push(n._targetProfiles[e].bitrate)});var c=s.reduce(function(e,t){return e/1e3+t/1e3},0)/s.length,u=[];Object.keys(n._targetProfiles).forEach(function(e){var t=n._targetProfiles[e],i=t.width*t.height;u.push(i)});var d=u.reduce(function(e,t){return e+t},0)/u.length,l=n._playedProfiles[n.most_used_profile],f=l.width,h=l.height,p=f*h,v=Math.min(p,d),g=a*c/(v*Math.min(n.average_speed,c));n.appdex=g,n.rPlayed=a,n.bMax=c,n.rMax=v,n.bufferedWithLowerProfileAvailable=D,n.number_of_switches=n.number_of_up_switches+n.number_of_down_switches}(),"undefined"!=typeof window.performance&&"function"==typeof window.performance.getEntriesByType){var _=performance.getEntriesByType("resource").filter(function(e){return".m4s"===e.name.split("?")[0].substr(-4)});n.ttfb=_.map(function(e){return e.responseStart-e.connectStart}).reduce(function(e,t){return e+t},0)/(_.length||1)}return n.buffer_duration=C,n.buffer_ratio=C/(C+n.session_playback_duration)*100,Object.keys(n).forEach(function(e){"_"===e.charAt(0)&&delete n[e]}),n}function g(){e.events.on($e.configChanged,function(){t()})}var m,y,_,b,w,k,S,x=[],T=n(),E=e.config.request.urls.blurr,P=3e4,A=!1,M=!1,L=!1,C=0,I=!1,q=!1,R=!1,F=!1,B=null,D=!1,N="auto",H={},V=u(),j=null,z=null,U=null,W=!1,G=0,X=0,J=e.config.embed.autoplay;return f(),h(),p(),g(),{}}function K(e){function t(){return Date.now?Date.now():(new Date).getTime()}function n(){f=!1,p=e.telecine?e.telecine.currentTime:0,v=0,g=0,m=0,y=!1}function i(t,n,r,o){e.verifyConfig().then(function(){var a=n;a.signature=e.config.request.signature,a.session=e.config.request.session,a.time=e.config.request.timestamp,a.expires=e.config.request.expires;var s=JSON.stringify(a),c="https://"+e.config.player_url+t;if(navigator.sendBeacon&&navigator.sendBeacon(c,s))return!0;var u=new XMLHttpRequest;return u.open("POST",c,!r),u.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),u.withCredentials=!0,u.onload=function(){200!==u.status&&o<2&&setTimeout(function(){i(t,n,r,o+1)},1e3)},u.send(s),u}).catch(function(e){})}function r(t,n,r){var o=e.telecine.currentFile||{},a=o.id,s=void 0===a?0:a,c=o.mime,u=void 0===c?Ue.h264:c,d=o.metadata;d=void 0===d?{}:d;var l=d.profile,f=void 0===l?-1:l;if(u===Ue.dash){var p=k,g=p.id;s=void 0===g?0:g;var m=p.profile;f=void 0===m?-1:m}e.performDelegateAction(je.playLog,function(a){var c=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];i(t,{referrer:e.config.request.referrer,embed:!e.config.embed.on_site,context:e.config.embed.context,autoplay:c.continuous?2:e.config.embed.autoplay,loop:e.config.embed.loop?1:0,id:e.config.video.id,vodId:e.config.video.vod&&e.config.video.vod.id?e.config.video.vod.id:null,vodSaleId:e.config.video.vod&&e.config.video.vod.sale_id?e.config.video.vod.sale_id:null,sessionTime:h(v),videoShape:kt.threeSixtyVideo&&e.config.video.is_panorama?"spatial_mono":"flat_mono",userId:e.config.user.id,userAccountType:e.config.user.account_type,userIsMod:e.config.user.mod?1:0,ownerId:e.config.video.owner.id,ownerAccountType:e.config.video.owner.account_type,privacy:e.config.video.privacy,rating:e.config.video.rating?e.config.video.rating.id:null,type:We[e.telecine.currentScanner],videoFileId:Number.isInteger(Number(s))?s:0,delivery:ze[u],profileId:f,quality:o.metadata.quality,duration:h(e.config.video.duration),seconds:h(n)},r)})}function o(){!y&&e.config.request.flags.plays&&(y=!0,r("/log/play",0))}function a(){var n=arguments.length<=0||void 0===arguments[0]?0:arguments[0],i=!(arguments.length<=1||void 0===arguments[1])&&arguments[1],o=arguments.length<=2||void 0===arguments[2]||arguments[2];if(e.config.request.flags.plays){var a=t();o&&g+w>a||(g=a,o&&!e.config.request.flags.partials||f||r("/log/partial",n,i))}}function s(t,n){if(!e.config.request.flags.dnt){n=n||{};var r={referrer:e.config.request.referrer,embed:!e.config.embed.on_site,context:e.config.embed.context,id:e.config.video.id,vodId:e.config.video.vod&&e.config.video.vod.id?e.config.video.vod.id:null,vodSaleId:e.config.video.vod&&e.config.video.vod.sale_id?e.config.video.vod.sale_id:null,userId:e.config.user.id,userAccountType:e.config.user.account_type,ownerId:e.config.video.owner?e.config.video.owner.id:0,duration:h(e.config.video.duration),seconds:h(e.telecine.currentTime)};for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o]);i("/log/"+t,r)}}function c(){e.events.on($e.playProgress,function(e,n,i){var r=Math.floor(e);!f&&m+w<t()&&(e>p&&(v+=e-p),p=e),r%_===0&&a(e)}),e.events.on($e.playInitiated,function(){o()}),e.events.on($e.paused,function(t){e.telecine.ended||a(t)}),e.events.on($e.seeked,function(e,t,n){b=e,f||a(b)}),e.events.on($e.scrubbingStarted,function(){m=t(),f=!0}),e.events.on($e.scrubbingEnded,function(){p=e.telecine.currentTime,f=!1,a(b)}),e.events.on($e.hdButtonPressed,function(){a(e.telecine.currentTime)}),e.events.on($e.ended,function(){v+=e.config.video.duration-p;var t=!1,n=!1;a(e.config.video.duration,t,n)}),e.events.on($e.streamChanged,function(e){k=e}),O(function(){if(e.telecine&&e.telecine.currentTime>0){var t=!0,n=!1;a(e.telecine.currentTime,t,n)}})}function u(){function t(e){return function(){s(e)}}if(!e.config.request.flags.dnt){var n=[{type:"share_press",event:$e.shareButtonPressed},{type:"facebook_press",event:$e.facebookButtonPressed},{type:"twitter_press",event:$e.twitterButtonPressed},{type:"tumblr_press",event:$e.tumblrButtonPressed},{type:"email_press",event:$e.emailButtonPressed},{type:"embed_press",event:$e.embedButtonPressed},{type:"login_success",event:$e.userLoggedIn},{type:"airplay",event:$e.airPlayActivated},{type:"vod_press",event:$e.vodButtonPressed},{type:"collection_press",event:$e.collectionsButtonPressed},{type:"email_capture_submitted",event:$e.emailCaptureSubmitted}];n.forEach(function(n){e.events.on(n.event,t(n.type))}),e.events.on($e.outroDisplayed,function(t){var n={outroType:e.config.embed.outro,ownerAccountType:e.config.video.owner.account_type};t.length&&(n.outroVideos=t.join(",")),s("outro_displayed",n)}).on($e.outroVideoPressed,function(t){s("outro_video_press",{ownerAccountType:e.config.video.owner.account_type,videoId:t})}).on($e.likeButtonPressed,function(){s("like_press",{add:!e.config.user.liked})}).on($e.watchLaterButtonPressed,function(){s("watch_later_press",{add:!e.config.user.watch_later})}).on($e.popupOpened,function(e){0===e.indexOf("login-")&&s("login_attempt")}).on($e.captionsChanged,function(e,t){if(!t)return e?void s("text_track_change",{textTrackLanguage:e.language,textTrackKind:e.kind}):void s("text_track_change")}).on($e.badgePressed,function(e){1!==e&&12!==e||s("badge_press",{badgeId:e})}).on($e.overlayOpened,function(e){"email-capture"===e&&s("email_capture_displayed")}).on($e.overlayClosed,function(e){"email-capture"===e&&s("email_capture_dismissed")})}}function d(){e.events.on($e.configChanged,function(e){e&&n()})}function l(){var t=["not-supported","decode","network","aborted","unknown"];e.events.on($e.error,function(n,r){t.indexOf(n)>=0&&i("/log/"+n.replace("-","")+"_error",{id:e.config.video.id,context:e.config.embed.context})})}var f,p,v,g,m,y,_=30,b=0,w=1e3,k={};return n(),c(),u(),d(),l(),e.events.fire($e.statsModuleReady),{}}function Q(e){return e===!0||e===!1?Number(e):"null"===e?null:e}function Z(e){var t=arguments.length<=1||void 0===arguments[1]?document.cookie:arguments[1];return t&&""!==t?t.split(";").reduce(function(t,n){return n=n.trim(),0===n.indexOf(e+"=")?decodeURIComponent(n.substr(e.length+1)):t},null):null}function ee(e,t,n){var i=new Date;i.setFullYear(i.getFullYear()+1),i=i.toGMTString(),t=Q(t);var r=e+"="+t+";";r+="expires="+i+";",r+="path=/;",r+="domain="+n+";",document.cookie=r}function te(e){function t(t){return new He(function(n,i){var r=document.createElement("a");r.href=e.config.request.urls.proxy;var a=document.createElement("iframe");a.src=t,a.setAttribute("title","Vimeo LocalStorage Proxy"),a.setAttribute("aria-hidden","true"),a.setAttribute("hidden",""),a.onload=function(t){var n=o(e.config.request.urls.proxy);a.contentWindow.postMessage({method:"ping"},n)},a.onerror=function(e){i(e)};var s=setTimeout(function(){i()},1e4),c=function e(i){0!==t.indexOf(i.origin)||"ready"!==i.data&&"ping"!==i.data||(window.removeEventListener("message",e,!1),clearTimeout(s),n(a))};window.addEventListener("message",c,!1),document.body.appendChild(a)})}function n(){_&&!zn&&(zn=t(e.config.request.urls.proxy))}function i(t){return zn.then(function(n){var i=o(e.config.request.urls.proxy);return n.contentWindow.postMessage(t,i),n}).catch(function(e){})}function r(t){e.config.embed.on_site&&window.postMessage(t,window.location.origin)}function a(t,n){if(zn){var o={method:"set",key:"sync_"+t,val:n,session:e.config.request.session};return i(o),void r(o)}try{window.localStorage.setItem("sync_"+t,JSON.stringify(n))}catch(e){}}function s(t,n){jn.indexOf(t)>=0&&(e.config.request.cookie[t]=n);var i=[];jn.indexOf(t)>=0&&null!==n&&i.push(t+"="+n);var r=c(jn);for(var o in r)o in r&&null!==r[o]&&o!==t&&i.push(o+"="+r[o]);ee("player",'"'+i.join("&")+'"',e.config.request.cookie_domain)}function c(e){var t=Z("player");if(!t)return null;t=t.substring(1,t.length-1);var n={};t.split("&").forEach(function(e){e=e.split("="),n[e[0]]=Q(decodeURIComponent(e[1]||""))});var i=[].concat(e),r=i.reduce(function(e,t){if(t in n){var i=parseFloat(n[t]);return e[t]=isNaN(i)||"quality"===t?n[t]:i,e}return e[t]=null,e},{});return 1===i.length?r[e]:r}function u(e,t){t=Q(t),a(e,t),s(e,t)}function d(t,n){var i=!0;switch(t){case"sync_quality":e.events.fire(Ge.changeQuality,n,i);break;case"sync_volume":e.events.fire(Ge.changeVolume,n,i);break;case"sync_captions":if(null===n){e.events.fire(Ge.turnCaptionsOff,i);break}e.events.fire(Ge.turnCaptionsOn,n,i);break;case"sync_login":l(n);break;case"sync_active":null!==n&&n!==e.config.request.session&&e.config.embed.autopause&&e.events.fire($e.becameInactive)}}function l(t){b>4||(b++,t&&!e.config.user.logged_in?e.events.fire($e.userLogIn):!t&&e.config.user.logged_in&&e.events.fire($e.userLoggedOut))}function f(){u("login",!!e.config.user.logged_in)}function h(){e.events.on($e.qualityChanged,function(e,t){t||u("quality",e)})}function p(){e.events.on($e.volumeChanged,function(t,n){e.config.request.cookie.volume=Q(t),n||u("volume",t)})}function v(){e.events.on($e.captionsChanged,function(t,n){if(t){var i=t.language+"."+t.kind;return e.config.request.cookie.captions=Q(i),void(n||u("captions",i))}e.config.request.cookie.captions=null,n||u("captions",null)})}function g(){e.events.on($e.playButtonPressed,function(){e.config.embed.settings.background||(u("active",e.config.request.session),e.events.fire($e.becameActive))}),e.events.on([$e.pauseButtonPressed,$e.ended],function(){c("active")===e.config.request.session&&u("active",null)})}function m(){e.events.on($e.userLoggedIn,function(){u("login",!0)})}function y(){return _?void window.addEventListener("message",function(t){var n=o(e.config.request.urls.proxy);t.origin===n&&"object"===Xe(t.data)&&"key"in t.data&&"newValue"in t.data?d(t.data.key,t.data.newValue):t.origin===window.location.origin&&t.data.session!==e.config.request.session&&d(t.data.key,t.data.val)},!1):void window.addEventListener("storage",function(e){if(0===e.key.indexOf("sync_")&&e.oldValue!==e.newValue&&window.localStorage.getItem(e.key)===e.newValue)try{d(e.key,JSON.parse(e.newValue))}catch(e){}},!1)}var _=0!==e.config.request.urls.proxy.indexOf(window.location.origin),b=0;return h(),p(),v(),g(),m(),n(),y(),{reset:f}}function ne(e){e=e||{};var t={};return e.on=function(n,i){n=[].concat(n);for(var r=0,o=n.length;r<o;r++){var a=n[r];if(!a)throw new Error("Tried to listen for an undefined event.");t[a]||(t[a]=[]),t[a].push(i)}return e},e.once=function(t,n){function i(){n.apply(e.off(t,i),arguments)}return i.handler=n,e.on(t,i)},e.off=function(n,i){n=[].concat(n);for(var r=0,o=n.length;r<o;r++){var a=n[r];if(!a)throw new Error("Tried to remove an undefined event.");if(a in t){var s=t[a].indexOf(i);if(s===-1){for(var c=0,u=t[a].length;c<u;c++)if(t[a][c].handler===i){s=r;break}if(s===-1)return e}t[a].splice(s,1)}}return e},e.fire=function(n){if(!n)throw new Error("Tried to fire an undefined event.");if(n in t)for(var i=t[n].slice(0),r=0,o=i.length;r<o;r++)i[r].apply(e,i.slice.call(arguments,1));return e},e}function ie(e,t,n){var i=void 0;try{document.removeChild({})}catch(r){i=Object.create(Object.getPrototypeOf(r),{name:{value:t,configurable:!0,writable:!0},code:{value:e,configurable:!0,writable:!0},message:{value:n,configurable:!0,writable:!0},toString:{value:function(){return t+": DOM Exception "+e},configurable:!0,writable:!0}})}return Object.freeze(i)}function re(e,t){var n,i=0;return n={},Ji(n,Ui.iterator,function(){return this}),Ji(n,"next",function(){if(i<e.length){var n=t?[e[i],t[i++]]:e[i++];return{done:!1,value:n}}return{done:!0}}),n}function oe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.getFileById=sr,e}function ae(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.item=function(e){return this[e]},e.getTrackById=sr,e}function se(e,t){for(var n=e,i=Array.isArray(n),r=0,n=i?n:n[Ui.iterator]();;){var o;if(i){if(r>=n.length)break;o=n[r++]}else{if(r=n.next(),r.done)break;o=r.value}var a=o,s=er(a,2),c=s[0],u=s[1];if(c<=t&&u>=t)return[c,u]}return[]}function ce(){return"undefined"!=typeof window.performance&&"function"==typeof window.performance.now?window.performance.now():Date.now()}function ue(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^16*Math.random()>>e/4).toString(16)})}function de(e){for(var t=window.atob(e),n=t.length,i=new Uint8Array(n),r=0;r<n;r++)i[r]=t.charCodeAt(r);return i}function le(e){return de(e).buffer}function fe(e){for(var t=new ArrayBuffer(2*e.length),n=new Uint16Array(t),i=0,r=e.length;i<r;i++)n[i]=e.charCodeAt(i);return n}function he(e){return setTimeout(e,0)}function pe(e,t,n,i){var r=0,o=0,a=0,s=0,c=e,u=t,d=n/i,l=c/u;return l>=d?(o=u,r=(d*u).toFixed(2)):(r=c,o=(c/d).toFixed(2)),a=Math.max((c-r)/2,0),s=Math.max((u-o)/2,0),{width:r,height:o,left:a,top:s}}function ve(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return Object.freeze(Ji({get length(){return e.length},start:function(t){return cr(e,t)},end:function(e){return cr(t,e)}},Ui.iterator,function(){return re(e,t)}))}function ge(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(0===e.length)return 0;for(var n=0,i=0,r=0;r<e.length;r++){var o=t[r]||1;i+=o,n+=e[r]*o}return n/i}function me(e,t){if(e.sort(),0===e.length)return 0;if(t<=0)return e[0];if(t>=1)return e[e.length-1];var n=e.length*t,i=Math.floor(n),r=i+1,o=n%1;return r>=e.length?e[i]:e[i]*(1-o)+e[r]*o}function ye(e){e.sort(function(e,t){return e-t});var t=Math.floor(e.length/2);return e.length%2?e[t]:(e[t-1]+e[t])/2}function _e(e){e=e||{};var t={};return e.on=function(n,i){n=[].concat(n);for(var r=0,o=n.length;r<o;r++){var a=n[r];if(!a)throw new Error("Tried to listen for an undefined event.");t[a]||(t[a]=[]),t[a].push(i)}return e},e.once=function(t,n){function i(){n.apply(e.off(t,i),arguments)}return i.handler=n,e.on(t,i)},e.off=function(n,i){n=[].concat(n);for(var r=0,o=n.length;r<o;r++){var a=n[r];if(!a)throw new Error("Tried to remove an undefined event.");if(a in t){var s=t[a].indexOf(i);if(s===-1){for(var c=0,u=t[a].length;c<u;c++)if(t[a][c].handler===i){s=r;break}if(s===-1)return e}t[a].splice(s,1)}}return e},e.fire=function(n){if(!n)throw new Error("Tried to fire an undefined event.");if(n in t)for(var i=t[n].slice(0),r=0,o=i.length;r<o;r++)i[r].apply(e,i.slice.call(arguments,1));return e},e}function be(e,t){function n(){e.events.fire($e.bufferStarted,{initial:!0}),_e=!0,ye=!0}function i(){ye&&(e.events.fire($e.bufferEnded),_e=!1,ye=!1)}function r(){return ie.classList.remove("invisible"),Ee?(e.events.fire($e.error,Ee),void u()):(pe||(e.events.fire($e.playInitiated),n(),pe=!0,re.play(),!e.config.user.progress||ce||!e.config.embed.settings.playbar||e.config.embed.autoplay||e.config.embed.time||(re.currentTime=e.config.user.progress,e.config.user.progress=0)),le=!0,fe=!0,ue&&(Ae=!0,e.events.fire(Ge.forceFullscreen)),void(xe&&o()))}function o(){ke||Pe||(_e=!1,Se=!1,fe&&re.paused&&(te&&(re.currentTime=te,te=null),re.play()))}function a(e,t){var n=e.length-1;if(e.length>1)for(var i=0,r=e.length;i<r;i++)if(e.start(i)<=t&&e.end(i)>=t){n=i;break}return n}function c(t){if(!Te&&re.buffered&&re.buffered.length>0){t=t||re.currentTime;var n=a(re.buffered,t),i=re.buffered.end(n),r=i/re.duration;if(e.events.fire($e.loadProgress,i,re.duration,r),ye&&fe&&i===re.duration)return void o()}}function u(){ne.style.backgroundImage="url("+ne.getAttribute("data-thumb")+")"}function d(t){for(var n=t.target,i=n.activeCues,r=[],o=void 0,a=0,s=i.length;a<s;a++)""!==i[a].text.replace(/^\s+|\s+$/gm,"")&&(o=document.createElement("span"),o.appendChild(i[a].getCueAsHTML()),r.push({html:o.innerHTML.replace("\n","<br>"),text:i[a].text}));e.events.fire($e.cueChanged,n,r)}function l(){var t=void 0;e.config.request.ab_tests&&e.config.request.ab_tests.preload_segment&&(t=e.config.request.ab_tests.preload_segment.data.max_preload_stream_index);var n=[Gr,Tr,Jr];re=new oo(ie,n,{externalDisplays:[AirPlayExternalDisplay],swfScanner:{swfUrl:e.config.request.urls.flideo},mediaSourceScanner:{maxPreloadStreamIndex:t}}),re.on("scannerchange",function(){f(),setTimeout(function(){e.events.fire(re.supportsSettingVolume?Ge.enableVolume:Ge.disableVolume),e.events.fire(re.supportsTextTracks?Ge.enableCaptions:Ge.disableCaptions)},0)}),re.on("currentfilechange",function(t){t.mime===Ue.hls&&e.events.fire(Ge.disableHd);var n=t.metadata.quality;if(t.mime===Ue.dash){var i=e.config.request.files.dash.streams.map(function(e){return e.quality});n=P(e.config.embed.quality,i)||"auto",A(n)}e.events.fire($e.qualityChanged,n,!0)}),re.on("streamchange",function(t){var n=t.index,i=t.streams,r=e.config.request.files.dash.streams[n];e.events.fire($e.streamChanged,r,n,i)}),re.on("streambufferstart",function(t){var n=t.hasLowerStreamIndex;e.events.fire($e.ranIntoBuffer,n)}),re.on("streambufferend",function(){e.events.fire($e.playbackResumed)}),re.on("bandwidth",function(t){e.events.fire($e.adaptiveBandwidth,t)}),re.on("alert",function(e){var t=void 0;switch(e){case"streamstudder":if(Oe)return;t=ft.render("stream_studder")}ae.message=t,ae.show()})}function f(){var t="none";("metadata"===e.config.request.flags.preload_video||ue||kt.iOS>=8)&&(t="metadata"),"auto"===e.config.request.flags.preload_video&&(t="metadata","MediaSourceScanner"===re.currentScanner&&(t="auto")),re.preload=t,e.events.on($e.mousedOver,function(){"metadata_on_hover"!==e.config.request.flags.preload_video||pe||e.verifyConfig().then(function(){return re.preload="metadata",!0}).catch(function(e){})})}function h(){re.on("loadedmetadata",function(t){xe=!0;var n=re.duration;isFinite(n)&&n>0&&(e.config.video.duration=n),e.config.video.video_width=re.videoWidth,e.config.video.video_height=re.videoHeight}),re.on("loadeddata",function(){0===re.currentTime&&re.paused&&i()}),re.on("durationchange",function(t){var n=re.duration;isFinite(n)&&(e.config.video.duration>0&&(n<e.config.video.duration-1||n>e.config.video.duration+1)||(e.config.video.duration=n))}),re.on("waiting",function(){we||n()}),re.on("canplay",function(){ge=!0,i(),(e.config.embed.autoplay||fe||le&&!pe&&ve)&&o()}),re.on("canplaythrough",function(){me=!0,i(),!le||pe||ve||o(),(_e||fe&&re.paused)&&o()}),re.on("progress",function(e){c()})}function p(){e.events.on($e.playInitiated,function(){t.classList.remove("invisible")}).on($e.playButtonPressed,r).on($e.pauseButtonPressed,function(){fe=!1,re.pause()}).on($e.becameInactive,function(){window.location.search.indexOf("autopause=0")<0&&!re.paused&&!e.config.embed.settings.background&&(fe=!1,e.events.fire($e.pauseButtonPressed))}),re.on("play",function(t){return Te=!1,pe||(!ve||ge)&&(ve||me)?(ie.classList.remove("invisible"),void e.events.fire($e.played,re.currentTime)):(e.events.fire($e.playInitiated),pe=!0,le=!0,void(fe=!0))}),re.on("pause",function(t){!pe||_e||ke||Se||e.events.fire($e.paused,re.currentTime,re.ended)}),re.on("playing",function(t){pe||(e.events.fire($e.playInitiated),pe=!0),c(),be=!0}),re.on("timeupdate",function(t){var r=re.currentTime;if(be&&ye&&r>0&&(be=!1,i()),re.buffered.length>0&&!ye){var o=a(re.buffered,r),s=re.buffered.end(o);if(!Ae&&r>0&&r<re.duration&&s===r)return void n()}if(!Te){var c=re.duration,u=r/c;e.events.fire($e.playProgress,r,c,u),te&&r>te&&(te=null)}oe&&(oe.classList.add("hidden"),oe=null)}),re.on("ended",function(t){ke||(e.config.embed.loop?re.play():(Ae&&e.events.fire($e.fullscreenButtonPressed),e.events.fire($e.ended),fe=!1,le=!1))}),re.on("drmauthsuccess",function(e){he=!0})}function v(){ae=new Un(t.parentElement),ae.on("show",function(t){e.events.fire($e.alertVisibilityChanged,!0,t)}),ae.on("hide",function(t){var n=t.target,i=n&&"function"==typeof n.getAttribute;if(i)switch(n.getAttribute("data-context")){case"suggestion":e.events.fire(Ge.changeQuality,"auto"),t="suggestion";break;default:t="close"}(i||"qualitymenuauto"===t)&&(Oe=!0),e.events.fire($e.alertVisibilityChanged,!1,t)})}function g(){var t=!1;O(function(){t=!0}),re.on("error",function(n){if(!t)switch(n.name){case"BrowserNotSupported":e.events.fire($e.error,"not-supported"),Ee="not-supported";break;case"DRMFailure":e.events.fire($e.error,"drm-failure",function(t){var n="Impossible de lire la vidéo.",i="Veuillez essayer à nouveau.",r=e.config.request.dynamic_drm_translation_map,o=t.message.code;return r&&parseInt(o,10)>0&&r[o]&&(n=r[o].title,i=r[o].msg),{title:n,message:i}}(n));break;case"FilesNotPlayable":e.events.fire($e.error,"not-supported"),Ee="not-supported";break;case"TextTracksNotSupported":e.events.fire(Ge.disableCaptions);break;case"HTMLSourceNotSupported":e.events.fire($e.error,"not-supported",{final:!1});break;case"HTMLDecode":e.events.fire($e.error,"decode",{final:!1});break;case"HTMLNetwork":e.events.fire($e.error,"network");break;case"HTMLUnknown":e.events.fire($e.error,"unknown")}})}function m(){e.events.on(Ge.changeLoop,function(t){e.config.embed.loop=!!t,re.loop=!!t}),e.events.fire(Ge.changeLoop,e.config.embed.loop)}function y(){e.events.on($e.scrubbingStarted,function(){n(),fe=!re.paused,ke=!0,re.pause()}),e.events.on($e.scrubbingEnded,function(e){ke=!1,e||o()}),e.events.on(Ge.seek,function(t,n){n||(n=(re.duration||e.config.video.duration)*s(t,0,1)),n=s(n,0,re.duration||e.config.video.duration),pe||(e.events.fire($e.playButtonPressed),
pe=!0,le=!0,fe=!0),re.currentTime=n}),re.on("seeking",function(){we=!0},!1),re.on("seeked",function(){c();var t=re.currentTime,n=re.duration;e.events.fire($e.seeked,t,n,t/n),we=!1},!1)}function _(){e.events.on(Ge.changeVolume,function(t,n,i){i&&(t+=re.volume),re.volume=s(t,0,1),e.events.fire($e.volumeChanged,s(t,0,1),n)});var t=e.config.request.cookie.volume;e.config.embed.mute&&(t=0),e.events.fire(Ge.changeVolume,t,!0)}function b(){e.events.on(Ge.changeQuality,function(t,n){if(re.video.currentFile.mime===Ue.dash)n=!0,A(t);else{var i=Vn(e.telecine.video.files).filter(function(e){return parseInt(e.metadata.quality,10)<=parseInt(t,10)});i.sort($()),i.length>0&&(Te=!0,re.video.currentFile=i[0])}"auto"===t&&ae.hide("qualitymenuauto"),e.events.fire($e.qualityChanged,t,n)})}function w(){e.events.on($e.overlayOpened,function(){Pe=!0,pe&&!Me&&(fe=!re.paused,re.pause())}),e.events.on($e.overlayClosed,function(){Pe=!1,fe&&!Me&&o()})}function k(){e.events.on($e.popupOpened,function(e){pe&&!Me&&(fe=!re.paused,re.pause())}),e.events.on($e.popupClosed,function(e){Me||o()})}function S(){e.events.on($e.didEnterFullscreen,function(t,n){ie.classList.remove("hide-webkit-controls"),t||(pe||kt.browser.safari||(re.poster=ne.getAttribute("data-thumb")),Ae=!0,setTimeout(function(){re.video.textTracks.forEach(function(e){"hidden"===e.mode&&(e.mode="showing")})},500)),n||!kt.windowsPhone||kt.browser.edge||e.events.fire(Ge.toggleNativeControls,!0)}),e.events.on($e.didExitFullscreen,function(e){re.poster="",pe||ie.classList.add("invisible"),Ae=!1,de&&ie.classList.add("hide-webkit-controls"),re.video.textTracks.forEach(function(e){"showing"===e.mode&&(e.mode="hidden")})}),e.events.on($e.playInitiated,function(){re.poster=""})}function x(){e.events.on(Ge.toggleNativeControls,function(e){return e?(re.controls=!0,void t.classList.add("native-controls")):(re.controls=!1,void t.classList.remove("native-controls"))})}function T(){e.events.on($e.signatureExpired,function(){te=re.currentTime}),e.events.on($e.requestConfigReloaded,function(e){I()}),e.events.on($e.configChanged,function(e){I(),H()})}function E(){it(ie).on("transitionend",function(e){"opacity"===e.propertyName&&"0"===window.getComputedStyle(this,"").opacity&&ie.classList.remove("transition")},!1),e.events.on(Ge.reset,function(t){Te=!0,re.paused||(re.pause(),e.events.fire($e.paused,re.currentTime)),u(),ie.classList.add("transition"),ie.classList.add("invisible"),t&&(xe=!1),pe=!1,fe=!1,Ee=null,setTimeout(function(){re.currentTime=0},300)})}function P(t){var n=arguments.length<=1||void 0===arguments[1]?[]:arguments[1];return e.config.embed.on_site||kt.android||kt.iOS||kt.windowsPhone||e.config.video.vod||!t?null:n.length&&n.indexOf(t)===-1?null:(e.events.fire($e.forcedQuality,t),t)}function A(t){if("auto"===t)return re.video.currentFile.restrictedStreamIndexes=[],void(Ce=!1);var n=e.config.request.files.dash.streams.map(function(e){return e.quality}).indexOf(t);n!==-1&&(re.video.currentFile.restrictedStreamIndexes=[n],Ce=n)}function M(){var t=e.config.request.files,n=Vn(t.progressive).filter(W(t.progressive)),i=n.some(U);kt.mobileAndroid&&(i=!1);var r="720p";if(i){var o=Vn(n).map(j);o.indexOf("1080p")!==-1&&o.indexOf("720p")===-1&&(r="1080p")}var a=e.config.request.cookie.hd||e.config.video.default_to_hd?r:"360p",s=n.map(function(e){return e.quality}),c=P(e.config.embed.quality,s),u=e.config.request.cookie.quality||c||a,d=J({files:t.progressive,preference:u,priorityOffset:2}),l=e.config.request.drm&&kt.browser.safari;if(t.hls&&(kt.iPhone||kt.iPad)||l){var f=t.hls.default_cdn,h=t.hls.cdns[f].url;d.push({id:"hls-"+e.config.video.id,src:h,mime:Ue.hls,priority:2,metadata:{cdn:f,origin:t.hls.cdns[f].origin,quality:"sd"}})}var p=!1;if(t.dash&&!l){var v=t.dash.default_cdn;p=t.dash.streams.some(U),d.push({id:"dash-"+e.config.video.id,src:t.dash.cdns[v].url,mime:Ue.dash,priority:1,metadata:{cdn:v,origin:t.dash.cdns[v].origin,quality:"sd"}})}return i||p||e.events.fire(Ge.disableHd),d}function L(){return"text_tracks"in e.config.request?e.config.request.text_tracks.map(function(e){return{id:e.id,src:e.url,kind:e.kind,label:e.label,language:e.lang}}):[]}function C(){var t=e.config.request.files,n=t.hls.default_cdn;if(t.hls){var i=t.hls.cdns[n].url;return t.hls.cdns[n].captions&&(i=t.hls.cdns[n].captions),{src:i,mime:Ue.hls,metadata:{cdn:e.config.request.files.hls.cdn,origin:e.config.request.files.hls.origin,quality:"sd"}}}return null}function I(){var t=M(),n=L();if(re.video&&re.video.id===""+e.config.video.id)return t.forEach(function(e){var t=re.video.files.getFileById(e.id);t&&(t.src=e.src)}),void n.forEach(function(e){var t=re.video.textTracks.getTrackById(e.id);t&&(t.src=e.src)});if(re.video={id:e.config.video.id,title:e.config.video.title,subtitle:"from "+e.config.video.owner.name,files:t,textTracks:n,externalDisplayFiles:{AirPlay:C()},metadata:{thumbnail:e.config.video.thumbs[640],useHls:e.config.request.drm&&kt.browser.safari,drm:e.config.request.drm}},0===n.length){var i=!0;return void e.events.fire(Ge.turnCaptionsOff,i)}if(re.video.textTracks.forEach(function(t){t.on("cuechange",d),t.on("modechange",function(n){Ae&&"showing"===t.mode&&e.events.fire($e.captionsChanged,t)})}),null===e.config.request.cookie.captions||"null"===e.config.request.cookie.captions)return void e.events.fire(Ge.turnCaptionsOff);var r=!0;e.events.fire(Ge.turnCaptionsOn,e.config.request.cookie.captions,r)}function q(e,t,n,i){if(he){var r=new XMLHttpRequest;r.open("DELETE",e+"/plays/"+t+"/"+n+"?token="+i,!1),r.send(),he=!1}}function R(){e.config.embed.time>0&&(re.currentTime=e.config.embed.time,e.config.embed.time=0)}function B(){e.events.on(Ge.turnCaptionsOn,function(t,n){if(!Le||Le.id!==t){var i=re.video.textTracks.getTrackById(t),r=!0;if(!i){var o=F(t,re.video.textTracks);i=o.track,r=o.exactMatch}i!==Le&&setTimeout(function(){re.video.textTracks.forEach(function(e){e.mode=e===i?"hidden":"disabled"}),e.events.fire($e.captionsChanged,i,n||!r),Le=i},0)}}).on(Ge.turnCaptionsOff,function(){var t=!(arguments.length<=0||void 0===arguments[0])&&arguments[0];setTimeout(function(){re.video.textTracks.forEach(function(e){e.mode="disabled"}),e.events.fire($e.cueChanged),Le&&(Le=null,e.events.fire($e.captionsChanged,null,t))},0)})}function D(){re.on("externaldisplayavailable",function(t){var n=t.type;if(!e.config.request.drm)switch(n){case"AirPlay":e.events.fire($e.airPlayAvailable)}}),re.on("externaldisplayunavailable",function(t){var n=t.type;if(!e.config.request.drm)switch(n){case"AirPlay":e.events.fire($e.airPlayNotAvailable)}}),re.on("externaldisplayactivated",function(t){var n=t.type;switch(Me=!0,n){case"AirPlay":e.events.fire($e.airPlayActivated)}}),re.on("externaldisplaydeactivated",function(t){var n=t.type;switch(Me=!1,n){case"AirPlay":e.events.fire($e.airPlayDeactivated)}}),e.events.on($e.airPlayButtonPressed,function(){re.showExternalDisplayPicker("AirPlay")})}function N(){re.on("play",function(){return re.supportsPresentationMode("picture-in-picture")?void e.events.fire($e.pictureInPictureAvailable):void e.events.fire($e.pictureInPictureNotAvailable)}),re.on("presentationmodechange",function(t){e.events.fire("picture-in-picture"===t?$e.pictureInPictureActivated:$e.pictureInPictureDeactivated),re.video.textTracks.forEach(function(e){"picture-in-picture"===t&&"hidden"===e.mode&&(e.mode="showing"),"inline"===t&&"showing"===e.mode&&(e.mode="hidden")})}),e.events.on(Ge.activatePictureInPicture,function(){re.supportsPresentationMode("picture-in-picture")&&(re.presentationMode="picture-in-picture")}),e.events.on(Ge.deactivatePictureInPicture,function(){re.supportsPresentationMode("picture-in-picture")&&(re.presentationMode="inline")})}function H(){e.config.embed.autoplay&&(le=!0,e.events.fire($e.playButtonPressed))}function V(){e.events.on($e.enteredTinyMode,function(){ce=!0}).on([$e.enteredMiniMode,$e.enteredNormalMode],function(){ce=!1})}function z(){var t=0,n=null,i=function(){n||(n=e.config.embed.color),e.events.fire(Ge.changeColor,"#46d439")},r=function(){n&&(e.events.fire(Ge.changeColor,n),n=null)};e.events.on(Ge.setEffect,function(n){if(re.deactivateEffects(),"ascii"===n||"ascii-color"===n){if(re.supportsEffect($r)){re.activateEffect($r,{color:"ascii-color"===n,fps:t||re.video.currentFile.metadata.fps});try{var o=e.config.request.files.dash.streams;o.sort($("asc"));var a=e.config.request.files.dash.streams.indexOf(o[0]);re.video.currentFile.restrictedStreamIndexes=[a]}catch(e){}return e.element.setAttribute("data-filter",n),"ascii"===n?void i():void r()}return void e.events.fire(Ge.setEffect,"none")}if("ascii"!==n&&"ascii-color"!==n){var s=[];Ce!==!1&&s.push(Ce),re.video.currentFile.restrictedStreamIndexes=s}r(),e.element.setAttribute("data-filter",n)}).on($e.streamChanged,function(e,n,i){t=e.fps})}function G(){O(function(){var t=e.config.request.drm;t&&q(t.hoover_url,t.user,t.asset,t.hoover_token)}),e.events.on($e.loadVideo,function(){var t=e.config.request.drm;t&&q(t.hoover_url,t.user,t.asset,t.hoover_token)})}function X(){function t(){window.addEventListener("resize",l,!1),window.addEventListener("orientationchange",l,!1),e.events.on($e.didEnterFullscreen,l),kt.android&&window.addEventListener("deviceorientation",y,!1),kt.pointerEvents?it(u).on("pointerdown",f).on("pointermove",h).on("pointerup",p).on("pointerleave",_):it(u).on("touchstart",v).on("touchend",m).on("touchmove",g).on("mousedown",f).on("mousemove",h).on("mouseup",p).on("mouseleave",_)}var n=this;if(!kt.threeSixtyVideo)return void e.events.on($e.playInitiated,function(){e.config.video.is_panorama&&(ae.message=ft.render("threesixty_support_alert",{faqLink:"https://vimeo.com/faq"}),ae.show())});var i="v1"===e.config.video.design_version_360,r="v2"===e.config.video.design_version_360,o=null,a=function(){ne.querySelector("video").classList.remove("threesixty-video"),e.element.classList.remove("threesixty-grabbable"),e.element.classList.remove("threesixty-grabbing"),se&&se.hide()},s=function(){qe=!1,a(),o&&(re.deactivateEffect(ho),o=null),e.config.video.is_panorama&&re.supportsEffect(ho)&&(o=re.activateEffect(ho,{threeUrl:e.config.request.urls.three_js,fps:e.config.video.fps,isMobile:kt.android,dimensions:e.config.embed.on_site?{width:1080,height:540}:{width:640,height:360},transparentCanvasWrap:i||r}),qe=!0)};s(),e.events.on($e.configChanged,s);var c=function(e){return function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];qe&&e.apply(n,i)}};re.on("seeked",c(function(){e.element.classList.add("threesixty-grabbable"),se&&!se.visible&&se.reveal()})),re.on("play",c(function(t){e.element.classList.add("threesixty-grabbable"),se&&!se.visible&&se.reveal()})),re.on("ended",c(function(e){a()})),re.on("cameraupdate",function(e){se&&se.setAngle(e.lat,e.lon)});var u=e.element.querySelector(".target"),d=!1,l=c(function(){o.adjustRenderSize(),d=!1}),f=c(function(t){d||(d=!0,t.preventDefault(),e.element.classList.add("threesixty-grabbing"),o.makeContact({x:t.clientX,y:t.clientY}))}),h=c(function(e){d&&(Re&&clearTimeout(Re),o.move({x:e.clientX,y:e.clientY}))}),p=c(function(t){e.element.classList.remove("threesixty-grabbing"),o.releaseContact(),d=!1}),v=c(function(e){d||(d=!0,o.makeContact({x:e.touches[0].clientX,y:e.touches[0].clientY}))}),g=c(function(e){d&&(e.preventDefault(),Re&&clearTimeout(Re),o.move({x:e.touches[0].clientX,y:e.touches[0].clientY}))}),m=c(function(e){re.fire("360releasecontact"),d=!1}),y=c(function(e){d||(Re&&clearTimeout(Re),o.moveDevice(e.alpha,e.beta,e.gamma,e.orientation))}),_=c(function(t){d=!1,e.element.classList.remove("threesixty-grabbing"),o.abandonMotion()}),b=!1;e.events.on($e.playInitiated,function(){b||(t(),b=!0),e.config.video.is_panorama&&(ne.querySelector("video").classList.add("threesixty-video"),ie.classList.add("telecine--fade"),i?Y():r?K():o.showRenderer())})}function Y(){var t=new Date,n=re.getEffectByName("ThreeSixtyEffect");se=new Wn(e.element.querySelector(".controls-wrapper"),function(){n.snapToCenter()},1),se.reveal(),re.once("timeupdate",function(){n.showRenderer(),ie.classList.remove("telecine--fade"),ie.classList.add("telecine--blackout"),setTimeout(function(){window.requestAnimationFrame(function(){ee()})},Math.min(new Date-t,4500))}),Z(!0),Ie.querySelector(".intro-wrap").classList.add("pre-play")}function K(){var t=re.getEffectByName("ThreeSixtyEffect");se=new Wn(e.element.querySelector(".controls-wrapper"),function(){t.snapToCenter()},2),se.reveal(),re.once("timeupdate",function(){t.showRenderer(),ie.classList.remove("telecine--fade"),ie.classList.add("telecine--blackout"),Ie&&!function(){var e=Ie.querySelector(".intro-wrap");e.classList.remove("pre-play"),window.requestAnimationFrame(function(){e.classList.add("instruct-reveal"),setTimeout(function(){window.requestAnimationFrame(function(){e.classList.add("fadeto--phase-b")})},1500),setTimeout(function(){window.requestAnimationFrame(function(){ee()})},4e3)})}()}),Z(!1),Ie.querySelector(".intro-wrap").classList.add("pre-play")}function Q(e){var n=t.parentElement;if(!Ie){var i=Ie=document.createElement("div");i.classList.add("player-alert-round"),e?i.classList.add("player-alert-round--top"):i.classList.add("player-alert-round--mid"),i.classList.add("cloaked");var r=document.createElement("div");r.innerHTML=ft.render("threesixty_instruct",{textOnly:e}),i.appendChild(r),n.appendChild(i)}}function Z(e){Ie||Q(e),Ie.classList.remove("cloaked"),window.requestAnimationFrame(function(){Ie.classList.add("in")})}function ee(){Ie.classList.add("leaving"),window.requestAnimationFrame(function(){it(Ie).on("transitionend",function e(t){"opacity"===t.propertyName&&(Ie.classList.remove("in"),Ie.classList.remove("leaving"),Ie.classList.add("cloaked"),it(Ie).off("transitionend",e))})})}var te,ne=t.querySelector(".video"),ie=t.querySelector(".telecine"),re=null,oe=null,ae=null,se=null,ce=!1,ue=kt.mobileAndroid||kt.android&&!kt.browser.chrome&&!kt.browser.firefox&&!kt.browser.opera||kt.windowsPhone||kt.iOS>=8&&!kt.iPad,de=kt.iOS>=8&&!kt.iPad,le=!1,fe=!1,he=!1,pe=!1,ve=!0,ge=!1,me=!1,ye=!1,_e=!1,be=!1,we=!1,ke=!1,Se=!1,xe=!1,Te=!0,Ee=null,Pe=!1,Ae=!1,Me=!1,Le=null,Oe=!1,Ce=!1;ie.classList.add("invisible"),de&&ie.classList.add("hide-webkit-controls");var Ie=null,qe=!1,Re=null;return l(),f(),h(),p(),v(),g(),m(),y(),_(),b(),w(),k(),S(),x(),T(),E(),B(),R(),D(),N(),V(),z(),I(),X(),G(),e.ready().then(function(){return setTimeout(function(){return H()},0),null}).catch(function(e){}),e.events.fire($e.videoModuleReady),{telecine:re}}function we(e){function t(){var e=T(g.clientWidth*kt.devicePixelRatio,g.clientHeight*kt.devicePixelRatio),t=e.width,n=e.height,i=x.getAttribute("data-thumb-width");if(t<=parseInt(i,10)||0===t)return He.resolve();var r=E({width:t,height:n,baseUrl:k.config.video.thumbs.base,webpSupport:k.config.request.flags.webp});if(x.setAttribute("data-thumb",r),x.setAttribute("data-thumb-width",t),k.config.embed.autoplay&&"beginning"!==k.config.embed.outro)return He.resolve();var o=P(r).then(function(e){"none"!==x.style.backgroundImage&&(x.style.backgroundImage="url("+e.src+")");var t=k.config.video.width/k.config.video.height,n=e.width/e.height;return(n<=.95*t||n>=1.05*t)&&x.classList.remove("cover"),e}).catch(function(e){});return He.race([o,new He(function(e){return setTimeout(e,2e3)})])}function n(){var e=a({width:k.config.video.width,height:k.config.video.height,elementWidth:g.clientWidth,elementHeight:g.clientHeight}),t=(e.extraWidth,e.extraHeight,e.scaleFactor);t>1?(x.classList.add("cover"),M.style.webkitTransform="scale("+t+")",M.style.transform="scale("+t+")"):(x.classList.remove("cover"),M.style.webkitTransform="",M.style.transform="")}function i(e){var t=e.old,n=e.loaded;if(!t);if(window.parent!==window){var i="Private Video on Vimeo";n.view!==Ve.main&&n.view!==Ve.privateUnlocked||(i=n.video.title+" from "+n.video.owner.name+" on Vimeo"),document.title=i,history&&history.replaceState&&n.video&&t&&history.replaceState({id:n.video.id},"","/video/"+n.video.id)}if(n.view!==Ve.main&&n.view!==Ve.privateUnlocked)throw new Error("Config not authorized: "+n.view);t&&t.embed&&t.embed.color!==n.embed.color&&w.fire(Ge.changeColor,n.embed.color),j&&j.reset(),(kt.mobileAndroid||kt.iPhone||kt.windowsPhone||kt.browser.bb10||kt.iPad||kt.android)&&(n.embed.autoplay=0);var r=!t||!t.video||t.video.id!==n.video.id;return r&&x.removeAttribute("data-thumb-width"),I=null,w.fire(Ge.reset),w.fire($e.configChanged,r),e}function r(){window.requestAnimationFrame(function(){g.classList.remove("loading"),z()})}function o(e){return b.then(function(){if(h(e),x.setAttribute("data-thumb",""),x.setAttribute("data-thumb-width",""),x.style.backgroundImage="","function"!=typeof H.authorizationHandler)throw new Error("Config was not authorized.");return H.authorizationHandler(r)}).then(function(e){k.config=e;var t=!0;return I=null,w.fire(Ge.reset),w.fire($e.configChanged,t),e})}function c(){var e=document.location.hash,t=d(e);null!==t&&(k.config.embed.time=s(t,0,k.config.video.duration),kt.touch||(k.config.embed.autoplay=1),e.indexOf("at=")!==-1&&history&&history.replaceState&&history.replaceState("","",window.location.pathname+window.location.search))}function u(){w.on($e.userLogIn,function(e){k.reload().then(function(t){if(!k.config.user.logged_in)return w.fire($e.loginFailure),t;switch(w.fire($e.userLoggedIn,e),e){case"like":k.config.user.liked&&w.fire($e.liked);break;case"watch-later":k.config.user.watch_later&&w.fire($e.addedToWatchLater);break;case"private":w.fire($e.privateUnlocked)}return t}).catch(function(e){})}),w.on($e.userLoggedOut,function(){k.reload().catch(function(e){})})}function l(){R=t(),w.on([$e.playInitiated,$e.playButtonPressed],function(){var e=kt.threeSixtyVideo&&k.config.video.is_panorama;e||(x.style.backgroundImage="none")}),w.on($e.didEnterFullscreen,function(){"none"===x.style.backgroundImage&&"beginning"!==k.config.embed.outro||(R=t())});var e=null;window.addEventListener("resize",function(){clearTimeout(e),e=setTimeout(function(){R=R.then(function(){return t()}).catch(function(e){})},250),n()},!1)}function f(e){n(),c(),u(),l(),p(e)}function h(e){V||(V=new B(e),Object.keys(V).forEach(function(e){if("function"==typeof V[e])return void Object.defineProperty(W,e,{enumerable:!0,value:V[e]});var t={enumerable:!0,get:V[e].get};V[e].set&&(t.set=V[e].set),Object.defineProperty(W,e,t)}))}function p(e){var t=k.config.embed.settings.background&&(kt.iOS||kt.android);if(!t){var n=new be(e,g.querySelector(".video-wrapper"));O=n.telecine}void new C(e),void new D(e,g.querySelector(".captions")),void new Y(e),void new K(e),j=new te(e),h(e)}var g=e.element,m=e.delegate,y=void 0===m?{}:m,_=e.cssLoadedPromise,b=void 0===_?He.resolve(null):_,w=(e.name,A()),k=new N({events:w}),S=v();g.classList.add("player-"+S),g.classList.add("loading"),g.id||(g.id="player"+S),g.innerHTML=ft.render("outer",{strings:{back:"Retour",close:"Fermer l’incrustation"}});var x=g.querySelector(".video"),M=g.querySelector(".telecine");if(kt.iOS){var L=document.createElement("video");M.appendChild(L);try{L.play(),L.pause()}catch(e){}}var O=null,I=null,q=null,R=null,F=null,H={},V=null,j=null,z=void 0,U=new He(function(e,t){z=e}).then(function(){return w.fire($e.ready),null}),W={get config(){return k.config},set config(e){k.config=e},get delegate(){return y},set delegate(e){y=e},ready:function(e){return e?void U.then(function(){return e()}).catch(function(e){}):U},get sessionId(){return k.config.request.session}},G={get config(){return k.config},get element(){return g},get events(){return w},get uuid(){return S},get externalApi(){return W},get telecine(){return O},init:function(e,t){return q?q:(H=t,q=k.load(e).then(i).catch(function(e){return o(G)}).then(function(){return"function"==typeof H.initializationHandler?He.resolve(t.initializationHandler()):null}).then(function(){return f(G),"function"==typeof H.postInitializationHandler?He.resolve(t.postInitializationHandler()):null}).then(function(){return He.all([R,b])}).then(r).catch(function(e){}))},loadVideo:function(e){return F===e&&I?I:(w.fire($e.loadVideo),F=e,g.classList.add("loading"),I=k.load(e).then(i).catch(function(e){return o(G)}).then(function(e){return R=t(),He.resolve(R)}).then(r))},performDelegateAction:function(e){var t=arguments.length<=1||void 0===arguments[1]?function(){}:arguments[1],n=arguments.length<=2||void 0===arguments[2]?[]:arguments[2],i=void 0;if(y&&y[e.will]){var r;if(i=(r=y)[e.will].apply(r,[k.config.video.id].concat(n)),i===!1)return}t.apply(void 0,[k.config.video.id].concat(n,[i])),y&&y[e.did]&&y[e.did]()},ready:function(){return U},verifyConfig:function(){return k.verify()}};return G}function ke(e,t,i,o){function a(){S.style.left="-999999px";var e=r(t),o=r(i),a=r(S),s=e.left+e.width/2-a.width/2-o.left,c=o.height,u=o.left+s+a.width,d=i.classList.contains("play-bar")?o.right:o.width-parseInt(window.getComputedStyle(i).paddingRight,10);if(u>d){var l=u-d;s-=l;var f=e.left-(o.left+s)+e.width/2;f!==b&&(n(".player .menu::after","left:"+f+"px",document.styleSheets[document.styleSheets.length-1]),b=f)}S.style.left=s+"px",S.style.bottom=c+"px"}function s(){S.style.height="auto";var e=r(o.element),t=r(S),n=e.bottom-t.bottom,i=0,a=o.element.querySelector(".title");if(a){var s=r(a);i=Math.max(10,s.height)}var c=e.height-n-i,u=e.height/2,d=Math.max(c,u),l=S.querySelector(".scrollable-items"),f=l.children,h=0;if(f&&f.length){var p=f[0],v=getComputedStyle(p),g=p.clientHeight+parseInt(v.marginTop,10)+parseInt(v.marginBottom,10);h=g/2}t.height>d&&(S.style.height=Math.min(d-h,t.height)+"px")}function c(e){var t=document.createElement("ul");t.classList.add("menu"),t.classList.add("rounded-box"),t.classList.add("hidden"),t.classList.add("invisible"),t.setAttribute("hidden",""),t.setAttribute("id",E),t.setAttribute("role","menu"),O=document.createElement("div"),O.classList.add("item-container");var n=document.createDocumentFragment();e.forEach(function(e){var t=document.createElement("li");t.setAttribute("tabindex","0"),t.setAttribute("role","menuitemradio"),t.setAttribute("aria-checked","false"),t.setAttribute("data-id",e.id),t.innerHTML="<span>"+e.label+"</span>",e.active&&(t.classList.add("active"),t.setAttribute("aria-checked","true"),x=t),n.appendChild(t)}),L=document.createElement("div"),L.classList.add("scrollable-items");var i=document.createElement("div");i.classList.add("sticky-items"),i.appendChild(n.lastChild),L.appendChild(n);var r=document.createElement("div");return r.classList.add("top-shadow"),O.appendChild(L),O.appendChild(i),O.appendChild(r),t.appendChild(O),C=L.firstChild,I=L.lastChild,L.addEventListener("mousewheel",u),L.addEventListener("scroll",u),L.addEventListener("focusin",d),o.events.on($e.menuVisibilityChanged,function(e){setTimeout(u,10)}),o.events.on([$e.enteredTinyMode,$e.enteredMiniMode,$e.enteredNormalMode],function(e){u(),a(),T&&o.events.fire($e.menuVisibilityChanged,T,_)}),t}function u(e){var t=L,n=t.scrollHeight,i=t.scrollTop,r=t.clientHeight,o=n-r,a=e||{},s=a.deltaY,c=void 0===s?0:s;return O.classList.remove("scroll-off"),n-r<=1?void O.classList.add("scroll-off"):(i>=o?(P=!0,O.classList.add("scroll-end")):P&&(P=!1,O.classList.remove("scroll-end")),i<=0?(M=!0,O.classList.add("scroll-start")):M&&(M=!1,O.classList.remove("scroll-start")),void((P&&c>0||M&&c<0)&&e.preventDefault()))}function d(e){var t=e.target,n=C.contains(t),i=I.contains(t);n?L.scrollTop=0:i&&(L.scrollTop=L.scrollHeight)}function l(e){T||(e=e||t.contains(document.activeElement),S.classList.remove("hidden"),S.removeAttribute("hidden"),a(),a(),s(),t.setAttribute("aria-expanded","true"),T=!0,o.events.fire($e.menuVisibilityChanged,T,_),window.requestAnimationFrame(function(){S.classList.remove("invisible"),S.classList.add("open"),u(),e&&(x||g()[0]).focus()}))}function f(){T&&(t.setAttribute("aria-expanded","false"),T=!1,o.events.fire($e.menuVisibilityChanged,T,_),S.classList.add("invisible"))}function h(e){return T?(f(),!1):(l(e),!0)}function p(e){x&&(x.classList.remove("active"),x.setAttribute("aria-checked","false"));var t=S.querySelector('[data-id="'+e+'"]');t&&(x=t,x.classList.add("active"),x.setAttribute("aria-checked","true"))}function v(){S.parentElement.removeChild(S)}function g(){var e=Vn(S.querySelectorAll('[tabindex="0"]'));return e}function m(){S=c(e),t.setAttribute("aria-controls",E),t.setAttribute("aria-expanded","false"),t.setAttribute("aria-haspopup","true"),w(S,["li","span"],function(){var e="SPAN"===this.tagName?this.parentElement:this;k.fire("selected",e.getAttribute("data-id"))}),w(t,function(){h()}),it(window).on("focus",function(e){var n=document.activeElement,i=S.contains(n),r=t.contains(n);i||r||f()});var n=function(e){if(("keypress"===e.type&&13===e.which||"keydown"===e.type&&32===e.which)&&S.contains(document.activeElement))return k.fire("selected",document.activeElement.getAttribute("data-id")),f(),!1};it(S).on("keydown",n),it(S).on("keypress",n),window.addEventListener("resize",a),i.insertBefore(S,t.nextSibling)}function y(){it(document).on("click",function(e){T&&!t.contains(e.target)&&f()}),it(S).on("transitionend",function(e){this===S&&"opacity"===e.propertyName&&S.classList.contains("invisible")&&(S.classList.add("hidden"),S.setAttribute("hidden",""),S.classList.remove("open"))}),window.addEventListener("blur",f,!1),o.events.on($e.didExitFullscreen,f).on($e.controlBarVisibilityChanged,function(e){e||f()})}var _,b,k=A(),S=null,x=null,T=!1,E="menu-"+Math.round(1e3*Math.random()+(new Date).getTime()),P=!1,M=!1,L=void 0,O=void 0,C=void 0,I=void 0;return m(),y(),_={show:l,hide:f,toggle:h,setActiveItem:p,on:k.on,off:k.off,destroy:v,button:t,element:S,get focusableItems(){return g()}}}function Se(e,t,n){return e=String(e),new Array(t-e.length+1).join(n||"0")+e}function xe(e,t){var n=Math.floor(e/3600%60),i=Math.floor(e/60%60);if(e=Math.floor(e%60),t){var r=e+" second"+(1===e?"":"s");return i>0&&(r=i+" minute"+(1===i?"":"s")+", "+r),n>0&&(r=n+" hour"+(1===n?"":"s")+", "+r),r}return(n>0?n+":":"")+Se(i,2)+":"+Se(e,2)}function Te(e,t){function n(){Re=null,Fe=null}function i(){if(!Fe){var e=te.getBoundingClientRect().left;te.offsetWidth<te.clientWidth&&(e*=100);var t=parseInt(window.getComputedStyle(te,"").borderLeftWidth,10);Fe=e+t}return Fe}function r(){if(!Re){var e=te.getBoundingClientRect().right;te.offsetWidth<te.clientWidth&&(e*=100);var t=parseInt(window.getComputedStyle(te,"").borderRightWidth,10);Re=e-t}return Re}function o(t){var n=i(),o=r(),a=o-n,c=t-n;if(e.config.user.progress&&c<=10&&!be)return 0;var u=c/a;return s(u,0,1)}function a(t,n){be&&!Oe&&(n=n||e.config.video.duration*t||0,window.requestAnimationFrame(function(){c(t,n),u(t,n)}))}function c(e,t){oe.style.left=Math.min(h(100*e),100)+"%",ae.innerHTML=xe(t)}function u(e,t){var n=Math.min(h(100*e),100);re.style.width=n+"%",re.setAttribute("aria-valuenow",h(t)),re.setAttribute("aria-valuetext",xe(Math.round(t),!0)+" played"),Z.setAttribute("width",n+"%")}function d(e,t){var n=Math.min(h(100*e),100);ie.style.width=n+"%",ie.setAttribute("aria-valuenow",h(t)),ie.setAttribute("aria-valuetext",xe(t,!0)+" loaded"),Q.setAttribute("width",n+"%")}function l(){return be=!0,qe&&(Ce=!1,t.classList.add("invisible"),S(),g()),Y.classList.contains("state-playing")?(e.events.fire($e.pauseButtonPressed),f()):(e.events.fire($e.playButtonPressed),p()),!kt.android}function f(){Ie=!1,Y.classList.remove("state-playing"),Y.classList.add("state-paused");var e=Y.getAttribute("data-title-play");Y.setAttribute("title",e),Y.setAttribute("aria-label",e)}function p(){Ie=!0,qe&&S(),Y.classList.add("state-playing"),Y.classList.remove("state-paused");var e=Y.getAttribute("data-title-pause");Y.setAttribute("title",e),Y.setAttribute("aria-label",e)}function v(){Ce&&(_e||(be&&Le||Se||Xe)&&(we||(!je&&!We||Se)&&(Se&&e.config.view===Ve.privateUnlocked||Pe||Te||(Ce=!1,e.events.fire($e.controlBarVisibilityChanged,Ce),t.classList.add("invisible")))))}function g(){Ce||Se||(t.classList.remove("hidden"),t.removeAttribute("hidden"),setTimeout(function(){Ce=!0,e.events.fire($e.controlBarVisibilityChanged,Ce),t.classList.remove("invisible")},0))}function m(t,n){var i=[];"text_tracks"in e.config.request&&(e.config.request.text_tracks.forEach(function(e){var t="CC"===e.label.substring(e.label.length-2),n="captions"!==e.kind||t?"":" CC";i.push({label:e.label+n,id:e.id,active:Ne===""+e.id})}),i.push({label:"Aucun",id:"off",active:null===Ne}));var r=new ke(i,t,n,e);return r.on("selected",function(t){return"off"===t?void e.events.fire(Ge.turnCaptionsOff):void e.events.fire(Ge.turnCaptionsOn,t)}),r}function y(){window.requestAnimationFrame(function(){c(0,e.config.video.duration),u(0,0),d(0,0)})}function _(){be=!1,we=!1,Te=!1,Ae=!1,Oe=!1,_e=!1,Le=!1,De=!0,ve&&(ve.destroy(),ve=null),Be&&(Be.destroy(),Be=null)}function b(){if(!e.config.embed.settings.custom_logo)return null;var t=e.config.embed.settings.custom_logo,n=t.img;return kt.devicePixelRatio>=2&&(n=n.replace(/(mw|mh)=(\d+)/g,function(e,t,n){return t+"="+2*parseInt(n,10)})),{showLink:null!==t.url,url:t.url,img:n,sticky:t.sticky,width:t.width,height:t.height}}function k(){var e=arguments.length<=0||void 0===arguments[0]?1:arguments[0];if(le){var t,n=1/fe.length,i=e/n,r=Math.ceil(i),o=i%1;o<=.33&&(t="fill1"),o>.33&&o<=.66&&(t="fill2"),fe.forEach(function(e,n){return e.classList.remove("fill0"),e.classList.remove("fill1"),e.classList.remove("fill2"),n===r-1&&o&&o<=.66?void e.classList.add(t):void(n>r-1&&e.classList.add("fill0"))}),le.setAttribute("aria-valuenow",e.toFixed(3)),le.setAttribute("aria-valuetext",Math.round(100*e)+"%")}}function S(){if(e.config.view===Ve.main||e.config.view===Ve.privateUnlocked){var n=e.config.embed.settings,i={show:n.logo,showLink:!!e.config.video.url,url:e.config.video.url},r=b();if(e.config.embed.settings.watch_trailer&&!be&&!Ie&&!e.config.embed.autoplay&&e.config.embed.on_site)return void x(i,r);var o=!e.telecine||e.telecine.supportsSettingVolume,a=!e.telecine||e.telecine.supportsTextTracks,s="text_tracks"in e.config.request&&e.config.request.text_tracks.length,c={targetBlank:0===e.config.embed.on_site,playState:Ie?"playing":"paused",volume:o&&n.volume,ccButton:a&&s,ccOn:null!==Ne,hdButton:De&&e.config.video.hd,airplayButton:kt.airPlay,fullscreenButton:n.fullscreen,vimeoLogo:i,duration:xe(e.config.video.duration),rawDuration:e.config.video.duration,strings:{play:"Lire",pause:"Pause",loadedBar:"chargé",playedBar:"lue",volume:"Volume (utiliser les flèches pour changer)",captions:"Choisir les légendes",hd:"Sélectionner la qualité de la vidéo",effect:"Choose an effect to apply to the video",airPlay:"Choisir un appareil AirPlay",airPlayOff:"Désactiver AirPlay",pipEnter:"Afficher la fonction Incrustation (PIP)",pipReturn:"Quitter la fonction Incrustation",fullscreen:"Plein écran",enterFullscreen:"Afficher en plein écran",exitFullscreen:"Quitter le mode plein écran",watchOnVimeo:"Regarder sur vimeo.com"}};r&&(c.customLogo=r),t.classList.remove("trailer"),qe=!1,t.innerHTML=ft.render("controlbar",c),Y=t.querySelector(".play"),K=Y.querySelector(".buffer"),Q=Y.querySelector(".loaded"),Z=Y.querySelector(".played"),ee=t.querySelector(".play-bar"),te=t.querySelector(".progress"),ne=ee.querySelector(".buffer"),ie=ee.querySelector(".loaded"),re=ee.querySelector(".played"),oe=t.querySelector(".timecode"),ae=oe.querySelector(".box"),se=t.querySelector(".ghost-timecode"),ce=se.querySelector(".box"),ue=t.querySelector(".thumb-preview"),de=t.querySelector(".thumb"),le=t.querySelector(".volume"),le&&(fe=Vn(le.querySelectorAll("div")),k(e.config.request.cookie.volume)),he=t.querySelector(".hd"),pe=t.querySelector(".play-bar .cc"),He=t.querySelector(".effect"),ge=t.querySelector(".pip"),kt.airPlay&&(me=t.querySelector(".airplay")),ye=t.querySelector(".fullscreen"),we=!1,be||G(),Ce&&e.events.fire($e.controlBarVisibilityChanged,Ce),Xe&&v()}}function x(n,i){t.classList.add("trailer");var r={vimeoLogo:n,text:e.config.video.vod.button_text||"Voir la bande-annonce",strings:{playTrailer:"Lire la bande-annonce",watchOnVimeo:"Regarder sur vimeo.com"}};i&&(r.customLogo=i),t.innerHTML=ft.render("controlbar_trailer",r),Y=t.querySelector(".play"),qe=!0;
}function T(){w(t,".play",l),e.events.on([$e.playInitiated,$e.playButtonPressed],p),e.events.on([$e.pauseButtonPressed,$e.paused,$e.error],f),e.events.on($e.played,function(){p()}),e.events.on($e.ended,function(){Oe=!1,f(),a(1)}),e.events.on($e.overlayOpened,function(e){"notsupported"===e&&f()})}function E(){e.events.on($e.loadProgress,function(e,t,n){_e||window.requestAnimationFrame(function(){d(n,e)})})}function A(){e.events.on($e.bufferStarted,function(e){e.initial;ne.classList.remove("hidden"),ie.classList.add("hidden"),K.setAttribute("class",K.getAttribute("class").replace(/\s+hidden/,"")),Pe=!0,Xe||g()}),e.events.on($e.bufferEnded,function(){ne.classList.add("hidden"),ie.classList.remove("hidden"),K.setAttribute("class",K.getAttribute("class")+" hidden"),Pe=!1})}function M(){function n(n){if(!n.button||2!==n.button){e.element.classList.add("scrubbing"),e.events.fire($e.scrubbingStarted);var d=n.type;if("pointerdown"===d||"MSPointerDown"===d){s=n.pointerId;try{n.target.msSetPointerCapture?n.target.msSetPointerCapture(s):n.target.setPointerCapture(s)}catch(e){}it(t).on("pointermove",".progress",i).on("pointerup",".progress",r)}else"touchstart"===d?it(t).on("touchmove",i).on("touchend",r):it(document).on("mousemove",i).on("mouseup",r);var l=n.clientX;n.targetTouches&&n.targetTouches.length>0&&(l=n.targetTouches[0].clientX,n.preventDefault());var f=o(l),h=null;if(be)a(f);else{var p=e.config.video.duration*f;c(f,p),u(f,p),Oe=!0}return e.events.fire(Ge.seek,f,h),!1}}function i(t){if(Oe=!1,s===t.pointerId&&t.isPrimary!==!1){var n=t.clientX;t.targetTouches&&t.targetTouches.length>0&&(n=t.targetTouches[0].clientX,t.preventDefault());var i=o(n);a(i),e.events.fire(Ge.seek,i)}}function r(n){var o=n.type;"pointerup"===o||"MSPointerUp"===o?it(t).off("pointermove",".progress",i).off("pointerup",".progress",r):"touchend"===n.type?it(t).off("touchmove",i).off("touchend",r):it(document).off("mousemove",i).off("mouseup",r),e.events.fire($e.scrubbingEnded),e.element.classList.remove("scrubbing")}e.events.on($e.playProgress,function(t,n,i){Oe&&(0===e.config.embed.time||e.config.embed.time>0&&t>=e.config.embed.time)&&(Oe=!1),Te||a(i,t)}),e.events.on($e.scrubbingStarted,function(e){Te=!0,Ee=e}),e.events.on($e.scrubbingEnded,function(){Te=!1,Ee=!1});var s;e.events.on($e.seeked,function(e,t,n){Ee&&a(n)}),it(t).on(kt.pointerEvents?"pointerdown":["touchstart","mousedown"],".progress",n)}function L(){function n(){return v||(v=e.verifyConfig().then(function(e){return P(e.thumb_preview.url)})),v.then(function(t){var n=e.config.request.thumb_preview;return de.style.backgroundImage||(de.style.width=n.frame_width/2+"px",de.style.height=n.frame_height/2+"px",de.style.backgroundImage="url("+n.url+")",de.style.backgroundSize=n.width/2+"px "+n.height/2+"px"),t})}function s(t){if(t.target===ee){var n=o(t.clientX);a(n),e.events.fire(Ge.seek,n)}}function c(e){return se.classList.contains("hidden")?e:(ue.classList.remove("hidden"),window.requestAnimationFrame(function(){window.requestAnimationFrame(function(){ue.classList.remove("invisible")})}),e)}function u(t){Me||Ae||(se.classList.remove("hidden"),Me=!0,l(t),window.requestAnimationFrame(function(){window.requestAnimationFrame(function(){se.classList.remove("invisible")})}),e.config.request.thumb_preview&&g&&n().then(c).catch(function(){}),it(ee).on("click",s))}function d(t){var n=e.config.video.duration/e.config.request.thumb_preview.frames,i=Math.min(e.config.request.thumb_preview.frames-1,Math.ceil(t/n)),r=i%e.config.request.thumb_preview.columns,o=Math.floor(i/e.config.request.thumb_preview.columns),a=-(r*e.config.request.thumb_preview.frame_width/2),s=-(o*e.config.request.thumb_preview.frame_height/2);return[a,s]}function l(t){if(e.config.request.thumb_preview&&null===g){var i=te.getBoundingClientRect().width,a=document.querySelector(".player").clientHeight,s=215,u=185;if(g=a>=s&&i>=u,!g)return void ue.classList.add("hidden");n().then(c).catch(function(){})}Me&&!function(){var i=o(t.clientX),a=e.config.video.duration*i;e.config.request.thumb_preview&&g&&n().then(function(e){var t=d(a),n=et(t,2),i=n[0],r=n[1];return window.requestAnimationFrame(function(){de.style.backgroundPosition=i+"px "+r+"px"}),e}).catch(function(){}),window.requestAnimationFrame(function(){ce.innerHTML=xe(a);var e=(100*i).toFixed(3);se.style.left=e+"%",h(i,t.clientX),t.clientX>r()+10&&p()})}()}function f(){var e=Y.getBoundingClientRect().left,t=ee.getBoundingClientRect().right,n=ue.getBoundingClientRect().width,o=e+Math.ceil(n/2),a=t-Math.ceil(n/2),s=i(),c=r(),u=c-s,d=(o-s)/u,l=(a-s)/u;return[d,l]}function h(e,t){var n=f(),i=et(n,2),r=i[0],o=i[1],a=Math.max(r,Math.min(o,e)),s=(100*a).toFixed(3);ue.style.left=s+"%"}function p(){se&&(se.classList.add("invisible"),ue.classList.add("invisible")),Me=!1,it(ee).off("click",s)}var v=void 0,g=null;e.events.on($e.resize,function(){g=null}),it(t).on("mouseenter",".progress",u).on("mousemove",".play-bar",l).on("mouseleave",".play-bar",p),it(t).on("transitionend",".ghost-timecode",function(e){"opacity"===e.propertyName&&"0"===window.getComputedStyle(this,"").opacity&&(se.classList.add("hidden"),ue.classList.add("hidden"))},!1),e.events.on($e.mousedOut,p),e.events.on($e.configChanged,function(){v=null})}function O(){function n(e){Ne=e,ve&&(ve.setActiveItem(e),setTimeout(function(){ve.hide()},100)),pe&&(pe.classList.add("on"),pe.classList.remove("off"))}function i(){Ne=null,ve&&(ve.setActiveItem("off"),setTimeout(function(){ve.hide()},100)),pe&&(pe.classList.add("off"),pe.classList.remove("on"))}w(t,".cc",function(){e.events.fire($e.ccButtonPressed)}),e.events.on($e.ccButtonPressed,function(e){ve?e&&ve.toggle(e):(ve=m(pe,ee),ve.show(e))}),e.events.on($e.captionsChanged,function(e){return e?void n(e.id):void i()}).on($e.controlBarVisibilityChanged,function(e){e||ve&&ve.hide()}).on([Ge.enableCaptions,Ge.disableCaptions],function(){S()})}function C(){function n(){var t=ft.render("icon_hd");if(e.telecine.video.currentFile.mime===Ue.dash){var n=e.config.request.files.dash.streams,i=Vn(n).sort($()).filter(W(n)).map(function(e){var n=j(e);return{id:n,label:X(e,t),active:r===n}});return i.push({id:"auto",label:"Auto",active:!r||"auto"===r}),i}var o=e.telecine.video.files;return Vn(o).filter(H("progressive")).filter(W(o)).sort($()).map(function(e){return{label:X(e,t),id:j(e),active:r===e.metadata.quality}})}function i(){var t=n(),i=new ke(t,he,ee,e);return i.on("selected",function(t){e.events.fire(Ge.changeQuality,t)}),i}var r=null;w(t,".hd",function(){e.events.fire($e.hdButtonPressed)}),e.events.on($e.hdButtonPressed,function(e){return Be?void(e&&Be.toggle(e)):(Be=i(),void Be.show(e))}),e.events.on($e.qualityChanged,function(e){r=e,Be&&Be.setActiveItem(e)}),e.events.on(Ge.disableHd,function(){De=!1,S()})}function I(){var n=document.createElement("a");if(n.style.cssText="-moz-filter:blur(2px);-webkit-filter:blur(2px);filter:blur(2px);",!(n.style.length<1)){var i=null,r=function(){var t=[{label:"Soporific",id:"aden"},{label:"Escutcheon",id:"earlybird"},{label:"Pluvious",id:"hudson"},{label:"Moribund",id:"inkwell"},{label:"Fecundity",id:"mayfair"},{label:"Jejune",id:"toaster"},{label:"Aucun",id:"none",active:!0}],n=kt.browser.safari,i=e.telecine.supportsEffect($r),r=ze[e.telecine.video.currentFile.mime],o="dash"===r;return!n&&o&&i&&t.unshift({label:"ASCII",id:"ascii"}),t};w(t,".effect",function(){return e.events.fire($e.effectButtonPressed)}),e.events.on($e.effectButtonPressed,function(t){return He.classList.remove("hidden"),i?void(t&&i.toggle(t)):(i=new ke(r(),He,ee,e),i.on("selected",function(t){return e.events.fire(Ge.setEffect,t)}),void i.show(t))}),e.events.on(Ge.setEffect,function(e){return i.setActiveItem(e),"none"===e?(He.classList.add("off"),void He.classList.remove("on")):(He.classList.add("on"),void He.classList.remove("off"))}),e.events.on($e.ready,function(){e.telecine.on("scannerchange",function(){i&&(i.destroy(),i=null)})})}}function q(){w(t,".pip",function(){return"picture-in-picture"===e.telecine.presentationMode?void e.events.fire(Ge.deactivatePictureInPicture):void e.events.fire(Ge.activatePictureInPicture)}),e.events.on($e.pictureInPictureAvailable,function(){ge&&(ge.classList.remove("hidden"),ge.hidden=!1,n())}).on($e.pictureInPictureNotAvailable,function(){ge&&(ge.classList.add("hidden"),ge.hidden=!0,n())}).on($e.pictureInPictureActivated,function(){We=!0,ge&&(ge.classList.add("return"),ge.classList.remove("enter"),ge.setAttribute("title",ge.getAttribute("data-title-return")))}).on($e.pictureInPictureDeactivated,function(){We=!1,ge&&(ge.classList.add("enter"),ge.classList.remove("return"),ge.setAttribute("title",ge.getAttribute("data-title-enter")))})}function R(){kt.airPlay&&(w(t,".airplay",function(){e.events.fire($e.airPlayButtonPressed)}),e.events.on($e.airPlayAvailable,function(){me&&(me.classList.remove("hidden"),me.hidden=!1,n())}).on($e.airPlayNotAvailable,function(){me&&(me.classList.add("hidden"),me.hidden=!0,n())}).on($e.airPlayActivated,function(){je=!0,me&&(me.classList.remove("off"),me.classList.add("on"),me.setAttribute("title",me.getAttribute("data-title-on"))),g()}).on($e.airPlayDeactivated,function(){je=!1,me&&(me.classList.remove("on"),me.classList.add("off"),me.setAttribute("title",me.getAttribute("data-title-off")))}))}function F(){w(t,".fullscreen",function(){e.events.fire($e.fullscreenButtonPressed)}),e.events.on($e.didEnterFullscreen,function(){t.classList.remove("tiny"),ye&&ye.setAttribute("title",ye.getAttribute("data-title-unfullscreen"))}),e.events.on($e.didExitFullscreen,function(e){ye&&ye.setAttribute("title",ye.getAttribute("data-title-fullscreen")),e||(_e=!0,y()),J&&t.classList.add("tiny")})}function B(){e.events.on([$e.mousedOver,$e.scrubbingStarted,Ge.changeVolume],g).on([$e.mousedOut,$e.mouseTimeout],v).on($e.willEnterFullscreen,function(){we=!1,v()}).on($e.willExitFullscreen,function(){we=!1}).on($e.targetTimeReached,function(){Le=!0,v()}).on(Ge.changeVolume,function(e,t){t||g()});var n=[".play",".play-bar",".custom-logo",".menu"];it(t).on(["pointerenter","pointerleave","mouseenter","mouseleave"],n,function(e){return"pointerType"in e?void("mouse"!==e.pointerType&&e.pointerType!==e.MSPOINTER_TYPE_MOUSE||(we="pointerenter"===e.type||"MSPointerEnter"===e.type)):void(kt.touch||(we="mouseover"===e.type))}),it(t).on("transitionend",function(e){this===t&&"opacity"===e.propertyName&&t.classList.contains("invisible")&&(t.classList.add("hidden"),t.setAttribute("hidden",""))})}function D(){function n(n){if(1===n.which){le.setAttribute("data-tabindex",le.getAttribute("tabindex")),le.removeAttribute("tabindex"),Ae=!0,e.element.classList.add("scrubbing"),e.events.fire($e.volumeScrubbingStarted);var s=n.type;if("pointerdown"===s||"MSPointerDown"===s){a=n.pointerId;try{n.target.msSetPointerCapture?n.target.msSetPointerCapture(a):n.target.setPointerCapture(a)}catch(e){}it(t).on("pointermove",".volume",i).on("pointerup",".volume",r)}else"touchstart"===s?it(document).on("touchmove",i).on("touchend",r):it(document).on("mousemove",i).on("mouseup",r);var c=n.clientX;n.targetTouches&&(c=n.targetTouches[0].clientX);var u=o(c);e.events.fire(Ge.changeVolume,u),k(u)}}function i(t){var n=t.clientX;t.targetTouches&&(n=t.targetTouches[0].clientX,t.preventDefault());var i=o(n);e.events.fire(Ge.changeVolume,i),k(i)}function r(n){Ae=!1,e.events.fire($e.volumeScrubbingEnded),e.element.classList.remove("scrubbing");var o=n.type;"pointerup"===o||"MSPointerUp"===o?it(t).off("pointermove",".volume",i).off("pointerup",".volume",r):"touchend"===n.type?it(document).off("touchmove",i).off("touchend",r):it(document).off("mousemove",i).off("mouseup",r),le.setAttribute("tabindex",le.getAttribute("data-tabindex")),le.removeAttribute("data-tabindex")}function o(e){var t=le.getBoundingClientRect().left,n=le.getBoundingClientRect().right,i=n-t,r=e-t,o=r/i;return s(o,0,1)}it(t).on("mouseover",".volume div",function(){var e=this;e.classList.add("hover"),window.requestAnimationFrame(function(){window.requestAnimationFrame(function(){e.classList.remove("hover"),e.classList.add("animate")})})}),it(t).on("transitionend",".volume div",function(e){"height"===e.propertyName&&12===this.clientHeight&&this.classList.remove("animate")}),it(document).on("contextmenu",".volume",function(){this.blur()});var a;it(t).on(kt.pointerEvents?"pointerdown":["touchstart","mousedown"],".volume",n),e.events.on($e.volumeChanged,function(e){!Ae&&fe&&k(e)}).on([Ge.enableVolume,Ge.disableVolume],function(){S()})}function N(){e.events.on($e.overlayOpened,function(e){if("notsupported"!==e&&"private-unlocked"!==e&&"help"!==e)Se=!0,v();else for(var n=t.querySelectorAll("a, button, input, [tabindex]"),i=0,r=n.length;i<r;i++){var o=n[i].getAttribute("tabindex");o&&n[i].setAttribute("data-tabindex",o),n[i].setAttribute("tabindex","-1")}}).on($e.overlayClosed,function(){Se=!1,g();for(var e=t.querySelectorAll("[tabindex]"),n=0,i=e.length;n<i;n++){var r=e[n].getAttribute("data-tabindex");r&&"null"!==r?e[n].setAttribute("tabindex",r):e[n].removeAttribute("tabindex"),e[n].removeAttribute("data-tabindex")}})}function V(){e.events.on($e.configChanged,function(){S(),e.config.view===Ve.privateUnlocked&&g(),n(),De=!0})}function z(){e.events.on(Ge.reset,function(){y(),g(),_()}),it(window).on("resize",function(){n()})}function U(){e.events.on($e.enteredTinyMode,function(){J=!0,t.classList.add("tiny")}).on($e.enteredMiniMode,function(){J=!1,t.classList.remove("tiny")}).on($e.enteredNormalMode,function(){J=!1,t.classList.remove("tiny")})}function G(){var t=e.config.user.progress,n=t/e.config.video.duration;!t||e.config.embed.autoplay||e.config.embed.time||(c(n,t),u(n,t),Oe=!0)}var J,Y,K,Q,Z,ee,te,ne,ie,re,oe,ae,se,ce,ue,de,le,fe,he,pe,ve,ge,me,ye,_e=!1,be=!1,we=!1,Se=!1,Te=!1,Ee=!1,Pe=!1,Ae=!1,Me=!1,Le=!1,Oe=!1,Ce=!0,Ie=!1,qe=!1,Re=null,Fe=null,Be=null,De=!0,Ne=null,He=null,je=!1,We=!1,Xe=e.config.embed.autoplay&&e.config.request.flags.autohide_controls;return S(),T(),M(),A(),L(),D(),O(),C(),I(),q(),R(),F(),B(),N(),V(),z(),G(),U(),e.events.on($e.playInitiated,function(){E(),be=!0;var t=e.config.embed.time||e.telecine.currentTime;a(t/e.config.video.duration,t),Oe=!0}),e.events.fire($e.controlBarModuleReady),{}}function Ee(e,t){function n(){clearTimeout(_),_=null}function i(){P&&(clearTimeout(_),_=setTimeout(s,b))}function o(){pt.element&&pt.element.classList.contains("js-player-fullscreen")&&(S||(t.style.cursor="none",k=!0,S=!0))}function a(){S&&(t.style.cursor="default",S=!1)}function s(t){if((T||x)&&(n(),!document.activeElement||!document.body.classList.contains("showfocus")||!L.contains(document.activeElement)&&!O.contains(document.activeElement))){e.events.fire(t?$e.mousedOut:$e.mouseTimeout),k=!0;var i=kt.threeSixtyVideo&&e.config.video.is_panorama;i||(M.classList.add("hidden"),M.setAttribute("hidden","")),w=!0,o()}}function c(){T&&x||(e.events.fire($e.mousedOver),M.classList.remove("hidden"),M.removeAttribute("hidden")),i()}function u(){T||x?t.removeAttribute("tabindex"):T||x||E||t.setAttribute("tabindex","0")}function d(){function u(){c()}function d(t){if(b=m,k)return void(k=!1);if(a(),0!==t.screenX&&t.screenX!==screen.width-1&&0!==t.screenY&&t.screenY!==screen.height-1){if(_=!0,kt.threeSixtyVideo&&e.config.video.is_panorama){var u=r(e.element),d=t.clientX-u.left,l=t.clientY-u.top,f=55,h=45,p=180,v=l>e.element.clientHeight-f,g=d>e.element.clientWidth-h&&l<p;if(!v&&!g)return}w&&c(),i()}else if(n(),o(),_){var y=!0;s(y),_=!1}}function l(){b=y,i()}function f(){var e=!0;s(e)}function h(e){var t=O.contains(e.target)||L.contains(e.target);if(T&&x){if(!t&&(T||x)){var n=!0;s(n)}}else c()}function p(e){return"mouse"===e.pointerType||e.pointerType===e.MSPOINTER_TYPE_MOUSE?(b=m,u(e)):(b=y,void h(e))}function v(e){if("mouse"===e.pointerType||e.pointerType===e.MSPOINTER_TYPE_MOUSE)return d(e)}function g(e){if("mouse"===e.pointerType||e.pointerType===e.MSPOINTER_TYPE_MOUSE)return f(e)}var _=!0;return kt.pointerEvents?void it(t).on("pointerenter",p).on("pointermove",v).on("pointerleave",g):void it(t).on("touchmove",l).on("touchend",h).on("mouseenter",u).on("mousemove",d).on("mouseleave",f)}function l(){e.events.on($e.played,function(e){q||0===e||c()}).on([$e.ended,$e.paused],c).on([$e.bufferEnded,$e.scrubbingEnded,$e.volumeChanged],i).on($e.playInitiated,function(){P=!0}),e.events.on($e.overlayOpened,u).on($e.controlBarVisibilityChanged,function(e){x=e,u()}).on($e.sidedockVisibilityChanged,function(e){T=e,u()})}function f(){function n(e){return(e.classList.contains("title")||e.classList.contains("target")||C.contains(e.parentNode)&&"HEADER"===e.parentNode.tagName||I.contains(e))&&!L.contains(e)}function i(t){if(!o&&2!==t.button&&t.target.classList&&n(t.target)){var i=("pointerup"===t.type||"MSPointerUp"===t.type)&&"mouse"!==t.pointerType&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE;if(kt.touch||i){var r=e.telecine.supportedPresentationModes.indexOf("inline")!==-1&&!kt.mobileAndroid;if(P&&r)return;return void e.events.fire($e.playButtonPressed)}a++,1===a&&setTimeout(function(){return P&&kt.threeSixtyVideo&&e.config.video.is_panorama?(1!==a&&e.telecine.getEffectByName("ThreeSixtyEffect").snapToCenter(),void(a=0)):(1===a?e.events.fire(e.telecine.paused?$e.playButtonPressed:$e.pauseButtonPressed):e.events.fire($e.fullscreenButtonPressed),void(a=0))},200)}}var r=!1,o=!1,a=0;e.events.on($e.menuVisibilityChanged,function(e){o=e}),it(t).on(kt.pointerEvents?"pointerup":"click",i),it(t).on("mousedown",".video-wrapper",function(e){if(!r){if(M.classList.remove("hidden"),M.removeAttribute("hidden"),2!==e.button){var t;document.createEvent&&(t=document.createEvent("MouseEvents"),t.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,0,null),M.dispatchEvent(t))}return!1}}).on("contextmenu",".video",function(e){return M.classList.remove("hidden"),M.removeAttribute("hidden"),!1}),e.events.on(Ge.toggleNativeControls,function(e){return e?(r=!0,void M.classList.add("hidden")):(r=!1,void M.classList.remove("hidden"))})}function h(){if(!kt.touch){var n,i;it(t).on("focus","a, button, input, [tabindex]",function(){i=this,clearTimeout(n),n=null,document.activeElement===this&&c()}),it(t).on("blur","a, button, input, [tabindex]",function(){document.activeElement===this&&(n=setTimeout(s,50))}),t.addEventListener("focus",function(e){c(),i&&i.focus()},!1),e.events.on($e.overlayOpened,function(){E=!0,t.removeAttribute("tabindex")}),e.events.on($e.overlayClosed,function(){E=!1})}}function p(){e.events.on($e.didEnterFullscreen,o).on($e.didExitFullscreen,function(e){return w=!0,e?void s():(c(),void n())})}function v(){e.events.on([$e.playProgress,$e.seeked],function t(n){n>=A&&null===_&&(e.events.fire($e.targetTimeReached),e.events.off([$e.playProgress,$e.seeked],t))})}function g(){e.events.on(Ge.reset,function(){w=!0,k=!0,x=!0,T=!1,P=!1,v(),n()})}var m=2e3,y=4500,_=null,b=kt.touch?y:m,w=!0,k=!0,S=!1,x=!0,T=!1,E=!1,P=!1,A=1.75,M=t.querySelector(".target"),L=t.querySelector(".sidedock"),O=t.querySelector(".controls"),C=t.querySelector(".title"),I=t.querySelector(".video"),q=e.config.embed.autoplay&&e.config.request.flags.autohide_controls;return d(),l(),f(),h(),p(),v(),g(),{}}function Pe(e,t){function n(){return t.classList.contains("overflow")?void t.classList.remove("overflow"):void(t.clientHeight<t.clientHeight&&t.classList.add("overflow"))}function i(e){if(!e)return{};var t=window.getComputedStyle(e);if(!t)return{};var n=t.width,i=t.height;return{width:n,height:i}}function r(e,t){return e&&t?parseInt(e,10)+"×"+parseInt(t,10)+" "+h():""}function o(){t.classList.add("hidden"),t.setAttribute("hidden",""),t.setAttribute("aria-hidden","true")}function a(){t.classList.remove("hidden"),t.removeAttribute("hidden"),t.setAttribute("aria-hidden","false"),n()}function s(){return Object.keys(e.config.request.ab_tests).map(function(t){return t+": "+e.config.request.ab_tests[t].group}).join(", ")}function c(){function t(t){function i(e){return window.btoa(unescape(encodeURIComponent(e)))}function r(t){var n=arguments.length<=1||void 0===arguments[1]||arguments[1],i=t;n&&(i="https://"+e.config.player_url+"/debug?v="+t),j.value=i}var o={sessionId:e.config.request.session,clipId:O.textContent,playing:I.textContent,dimensions:q.textContent,cdn:R.textContent,ua:navigator.userAgent,referrer:e.config.request.referrer,country:e.config.request.country,graphEvents:x,graphLines:S,graphSpeeds:k.map(function(e){return e.map(function(e){return{speed:Math.round(e.speed)/1e3,time:Math.round(100*e.time)/100}})}),duration:e.telecine.duration};if(e.config.request.ab_tests&&(o.testGroup=s()),C&&(o.profileId=C.textContent),V&&(o.droppedFrames=V.textContent),D&&(o.bandwidth={avg:D.textContent,min:N.textContent,max:H.textContent}),window.btoa){var a=i(JSON.stringify(o));return r(a),void t()}var c=new XMLHttpRequest;c.open("POST","https://"+e.config.player_url+"/debug",!0),c.onload=function(){var e=JSON.parse(c.responseText);r(e,!1),t()},c.onerror=function(){n("Error!")},c.send(JSON.stringify(o))}function n(){var e=arguments.length<=0||void 0===arguments[0]?"Copied!":arguments[0];d(z,e),clearTimeout(U),U=setTimeout(function(){d(z,"Open link")},2e3)}t(function(){z.href=j.value,window.open(j.value)})}function u(){var n=e.telecine.currentFile;if(n){var a=n.metadata,u=e.telecine.currentScanner,d="MediaSourceScanner"===u;W=t.parentElement.querySelector("video");var l=i(W),f=l.width,h=l.height;T=r(f,h);var p={clipId:e.config.video.id,scanner:u,cdn:a.cdn,delivery:ze[e.telecine.video.currentFile.mime],resolution:""+a.quality+(a.fps?"@"+a.fps:""),dimensions:T,displayProfile:d,displayBandwidth:d,displayDroppedFrames:d,displayAudioVideoStream:d};p.displayAudioVideoStream&&(p.separateAudioVideo=e.config.request.files.dash.separate_av),e.config.request.ab_tests&&(p.testGroup=s()),t.innerHTML=ft.render("stats_debug",p),O=t.querySelector(".stats-debug-clip-id"),C=t.querySelector(".stats-debug-profile-id"),I=t.querySelector(".stats-debug-resolution"),q=t.querySelector(".stats-debug-dimensions"),R=t.querySelector(".stats-debug-cdn"),F=t.querySelector(".stats-debug-delivery"),B=t.querySelector(".stats-debug-time-series"),D=t.querySelector(".stats-debug-bandwidth"),N=t.querySelector(".stats-debug-bandwidth-min"),H=t.querySelector(".stats-debug-bandwidth-max"),V=t.querySelector(".stats-debug-dropped-frames"),z=t.querySelector(".stats-debug-copy"),j=t.querySelector(".stats-debug-code"),w(t,".stats-debug-close",o),w(t,".stats-debug-copy",c),L=!0}}function d(e,t){var n=arguments.length<=2||void 0===arguments[2]?"textContent":arguments[2];window.requestAnimationFrame(function(){var i=e.parentElement;return"undefined"==typeof t?void(i.style.display="none"):(i.style.display="block",void(e[n]=t))})}function l(e,t,n){return Math.min(Math.max(e,t),n)}function f(t,n){var o=200,a=14;if(t!==X){X=t,t>G&&(G=t,d(H,Math.floor(t/1e3).toLocaleString()+" Kbps")),t<$&&($=t,d(N,Math.floor(t/1e3).toLocaleString()+" Kbps"));var s=e.telecine.currentTime;k[A].push({speed:t,time:s})}var c='<svg width="'+o+'" height="'+a+'" viewBox="0 0 '+o+" "+a+'">',u=k[A].map(function(t){var n=t.time/e.telecine.duration*o,i=a-a*t.speed/G;return isNaN(i)&&(i=0),n+","+l(i,0,a)});if(Y){var f={time:e.telecine.currentTime,color:Y,type:K[Y]};switch(f.type){case"resize":var h=i(W),p=r(h.width,h.height);T=p,f.title="Resized from "+T+" to "+p;break;case"downswitch":case"upswitch":f.title="Switched from "+E+" to "+P;break;default:f.title=K[Y]}S[A].push(f),Y=!1}return S[A].forEach(function(t){var n=t.time,i=t.color,r=t.title,s=n/e.telecine.duration*o,u="<g>";u+="<title>"+r+"</title>",u+='<line x1="'+s+'" y1="0" x2="'+s+'" y2="'+a+'" stroke-width="1" stroke="'+i+'" />',u+="</g>",c+=u}),c+="<g>",c+='<polyline stroke="white" fill="none" points="',c+=u.join(" "),c+='"></polyline>',c+="</g></svg></span></span>"}function h(){return window.devicePixelRatio&&window.devicePixelRatio>1?"@"+window.devicePixelRatio+"x":""}function p(e,t){A+=1,k.push([]),S.push([]),x.push([{title:e,time:Math.round(100*t)/100}])}function v(n,o){var a;M[n]||(M[n]=[]),M[n].length===b&&M[n].pop(),L||u(),M[n].unshift(o);var s=void 0;switch(n){case"resize":return Y=Q.resize,s=i(W),e.events.fire($e.resize,s),void d(q,""+r(s.width,s.height));case"streamchange":var c=o.index,l=o.streams,h=l[c],v=e.config.request.files.dash.cdn,g=e.config.request.files.dash.streams[c].profile;return J!==h.bitrate&&(null!==J&&(Y=Q.upswitch,h.bitrate<J&&(Y=Q.downswitch)),J=h.bitrate),E!==P&&(E=P),W||(W=t.querySelector("video")),P=h.width+"×"+h.height+"@"+Math.round(h.framerate)+" "+Math.round(h.bitrate/1e3).toLocaleString()+" Kbps",d(I,P),s=i(W),d(q,""+r(s.width,s.height)),d(R,v),void d(C,g);case"scannerchange":return void d(F,ze[e.telecine.video.currentFile.mime]);case"streamtargetchange":var m=e.config.request.files.dash.streams[o.index],y=[m,o.index,o.streams];return void(a=e.events).fire.apply(a,[$e.streamTargetChange].concat(y));case"bandwidth":var _=o.speed,w=o.bitrate;d(D,Math.floor(_/1e3).toLocaleString()+" Kbps");var k=f(_,w);return void d(B,k,"innerHTML");case"droppedframes":var S=o.dropped,x=o.total;return void d(V,S.toLocaleString()+" / "+x.toLocaleString());case"seeked":case"ended":return void p(n,e.telecine.currentTime)}}function g(){e.events.on($e.debugButtonPressed,function(){return t.classList.contains("hidden")?void a():void o()})}function m(){e.events.on($e.configChanged,function(e){window.requestAnimationFrame(u)})}function y(){["streamchange","droppedframes","bandwidth","scannerchange","streamtargetchange","seeked","ended"].forEach(function(t){e.telecine.on(t,function(e){return v(t,e)})})}function _(){it(window).on("resize",function(){v("resize"),n()})}var b=100,k=[[]],S=[[]],x=[],T=void 0,E=void 0,P=void 0,A=0,M={},L=!1,O=void 0,C=void 0,I=void 0,q=void 0,R=void 0,F=void 0,B=void 0,D=void 0,N=void 0,H=void 0,V=void 0,j=void 0,z=void 0,U=void 0,W=void 0,G=Number.NEGATIVE_INFINITY,$=Number.POSITIVE_INFINITY,X=-1,J=null,Y=!1,K={"#FB5454":"downswitch","#54FB54":"upswitch","#F9FF4B":"resize"},Q={downswitch:"#FB5454",upswitch:"#54FB54",resize:"#F9FF4B"};u(),g(),m(),y(),_()}function Ae(e,t){function n(){return!A&&(e.config.view===Ve.main||e.config.view===Ve.privateUnlocked)}function i(){L&&"help"===P&&e.events.fire($e.overlayCloseButtonPressed)}function r(e){return"number"!=typeof e.which&&(e.which=e.keyCode),e}function o(e){if("keypress"===e.type){var t=String.fromCharCode(e.which);return e.shiftKey||(t=t.toLowerCase()),t}return e.which in vo?vo[e.which]:String.fromCharCode(e.which).toLowerCase()}function a(e){return!(e.ctrlKey||e.metaKey||e.altKey)&&(e.which in vo?"keydown"===e.type:"keypress"===e.type)}function s(e){var t=e.target||e.srcElement;return"INPUT"===t.tagName||"SELECT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable}function c(t){if(t=Array.isArray(t)?t:[t],L&&"help"===P){if(e.events.fire($e.overlayCloseButtonPressed),t[0]===Ge.showOverlay&&"help"===t[1])return!1;if(t[0]!==Ge.openVimeo)return setTimeout(function(){e.events.fire.apply(null,t)},250),!1}return e.events.fire.apply(null,t),!1}function u(t,n){if(!B){n&&!e.telecine.paused&&e.events.fire($e.pauseButtonPressed);var i=!0;e.events.fire($e.scrubbingStarted,i),B=!0}f(F),F++,1===F&&(R=e.config.video.fps);var r=n?1:R,o="right"===t?r:-r,a=Math["right"===t?"ceil":"floor"](e.telecine.currentTime*e.config.video.fps);d(a+o)}function d(t){var n=null,i=t/e.config.video.fps;e.events.fire(Ge.seek,n,i)}function l(t){R=C,F=0;var n=t.shiftKey;e.events.fire($e.scrubbingEnded,n),B=!1}function f(e){var t=e,n=Math.ceil(C),i=Math.ceil(I-C),r=q;R=h(t,n,i,r)}function h(e,t,n,i){return e/=i,e--,n*(e*e*e+1)+t}function v(e){var t=O.focusableItems,n=t.indexOf(document.activeElement),i="up"===e?n-1:n+1,r=null;return r=i>=t.length?t[0]:i<0?t[t.length-1]:t[i],!r||(r.focus(),!1)}function g(){return!!O||(document.activeElement&&document.activeElement!==document.body?void 0:(e.events.fire($e[e.telecine.paused?"playButtonPressed":"pauseButtonPressed"]),i(),!1))}function m(){return O?(O.element.contains(document.activeElement)&&O.button.focus(),O.hide(),!1):document.activeElement&&t.contains(document.activeElement)?(document.activeElement.blur(),!0):L?(e.events.fire($e.overlayCloseButtonPressed),!1):void 0}function y(){if(O)return!O.element.contains(document.activeElement)||v("up");if(kt.threeSixtyVideo&&e.config.video.is_panorama)return e.telecine.getEffectByName("ThreeSixtyEffect").keyPress("up"),!1;if(e.config.embed.on_site&&document.activeElement&&!t.contains(document.activeElement))return!0;i();var n=!1,r=!0;return e.events.fire(Ge.changeVolume,po,n,r),!1}function _(){if(O)return!O.element.contains(document.activeElement)||v("down");if(kt.threeSixtyVideo&&e.config.video.is_panorama)return e.telecine.getEffectByName("ThreeSixtyEffect").keyPress("down"),!1;if(e.config.embed.on_site&&document.activeElement&&!t.contains(document.activeElement))return!0;i();var n=!1,r=!0;return e.events.fire(Ge.changeVolume,-po,n,r),!1}function b(t,n){if(O)return!O.element.contains(document.activeElement)||v("left"===n?"up":"down");if(i(),kt.threeSixtyVideo&&e.config.video.is_panorama)return e.telecine.getEffectByName("ThreeSixtyEffect").keyPress(n),!1;if(document.activeElement&&document.activeElement===M){var r=!1,o=!0,a="left"===n?-po:po;return e.events.fire(Ge.changeVolume,a,r,o),!1}return t.shiftKey||0===F?void u(n,t.shiftKey):void D(n,t.shiftKey)}function w(){e.events.on($e.overlayOpened,function(e){L=!0,P=e,"notsupported"===e&&(A=!0)}),e.events.on($e.overlayClosed,function(){L=!1,P=null})}function k(){e.events.on($e.menuVisibilityChanged,function(e,t){O=!!e&&t})}function S(){e.events.on($e.configChanged,function(e){e&&(A=!1)})}function x(){function t(e){if(r(e),a(e)&&!s(e)&&n()){var t=o(e);if(t in u){if("function"==typeof u[t])return void(u[t](e,t)===!1&&(e.preventDefault(),e.stopPropagation()));c(u[t])===!1&&(e.preventDefault(),e.stopPropagation())}}}function i(t){if(r(t),!s(t)&&n()){var i=o(t);return kt.threeSixtyVideo&&e.config.video.is_panorama&&("left"===i||"right"===i||"up"===i||"down"===i)?void e.telecine.getEffectByName("ThreeSixtyEffect").keyUp(i):void("left"!==i&&"right"!==i||l(t))}}var u={l:$e.likeButtonPressed,w:$e.watchLaterButtonPressed,s:$e.shareButtonPressed,c:[$e.ccButtonPressed,!0],h:[$e.hdButtonPressed,!0],f:$e.fullscreenButtonPressed,x:[$e.effectButtonPressed,!0],e:[$e.effectButtonPressed,!0],d:$e.debugButtonPressed,space:g,up:y,down:_,left:b,right:b,esc:m,"?":[Ge.showOverlay,"help"]};e.config.embed.on_site||(u.v=Ge.openVimeo),document.addEventListener("keydown",t,!1),document.addEventListener("keypress",t,!1),document.addEventListener("keyup",i,!1)}function T(){e.events.on($e.becameActive,function(){A=!1}).on($e.becameInactive,function(){A=!0}),e.config.embed.on_site&&document.querySelector(".player")===t&&(A=!1)}function E(){var e=void 0,t=!1;document.body.addEventListener("keydown",function(n){9!==n.which||document.body.classList.contains("showfocus")?27===n.which?document.body.classList.remove("showfocus"):32!==n.which&&13!==n.which||(t=!0,clearTimeout(e),e=setTimeout(function(){t=!1},200)):document.body.classList.add("showfocus")}),document.body.addEventListener("click",function(e){t||document.body.classList.remove("showfocus")})}var P,A=!!e.config.embed.on_site,M=t.querySelector(".volume"),L=!1,O=!1,C=e.config.video.fps/5,I=Math.max(C,.618*e.config.video.duration),q=100,R=C,F=0,B=!1,D=p(u,80);return w(),k(),S(),x(),T(),E(),{pause:function(){A=!0},unpause:function(){A=!1}}}function Me(e,t){function n(e){var n="watchlater"===e||"unwatchlater"===e?.5:.4,i=t.clientHeight;return t.clientHeight>t.clientWidth&&(i=t.clientWidth),{height:Math.round(i*n),width:Math.round(i*n*1.6)}}function i(e,t){var n=e.querySelector(".hour-hand"),i=e.querySelector(".minute-hand");if(n&&i){var r=t?1:-1,o=new Date,a=Math.abs(o.getHours()-12),s=o.getMinutes(),c=s/60*360-135,u=a/12*360+s/60*5,d=1.5,l=u+30*d*r,f=c+360*d*r;if(kt.browser.firefox||kt.browser.opera){var h="10 10";n.setAttribute("transform","rotate("+u+","+h+")"),i.setAttribute("transform","rotate("+c+","+h+")");var p=document.createElementNS("http://www.w3.org/2000/svg","animateTransform");p.setAttribute("attributeName","transform"),
p.setAttribute("type","rotate"),p.setAttribute("begin","0.1s"),p.setAttribute("repeatCount","indefinite");var v=p.cloneNode(!1);v.setAttribute("from",u+" "+h),v.setAttribute("to",u+360*r+" "+h),v.setAttribute("dur","0.8s"),n.appendChild(v);var g=p.cloneNode(!1);g.setAttribute("from",c+" "+h),g.setAttribute("to",c+360*r+" "+h),g.setAttribute("dur","9.6s"),i.appendChild(g)}else n.style[kt.transformProperty+"Origin"]="46% 81.5%",i.style[kt.transformProperty+"Origin"]="25.5% 26.5%",n.style[kt.transformProperty]="rotate("+u+"deg)",i.style[kt.transformProperty]="rotate("+c+"deg)";window.requestAnimationFrame(function(){e.classList.add("animate"),kt.browser.firefox||kt.browser.opera||window.requestAnimationFrame(function(){n.style[kt.transformProperty]="rotate("+l+"deg)",i.style[kt.transformProperty]="rotate("+f+"deg)"})})}}function r(e,r){if(null!==t.parentElement.offsetParent){t.classList.remove("hidden"),t.removeAttribute("hidden"),t.setAttribute("data-name",e);var a=n(e),s="width:"+a.width+"px;height:"+a.height+"px";l.style.cssText=s,l.innerHTML=r,"watchlater"!==e&&"unwatchlater"!==e||i(l,"watchlater"===e),clearTimeout(d),t.classList.remove("animate"),window.requestAnimationFrame(function(){t.classList.remove("invisible"),d=setTimeout(o,750)})}}function o(){t.classList.add("animate"),t.classList.add("invisible")}function a(){t.classList.remove("animate"),t.classList.remove("invisible"),t.classList.add("hidden"),t.setAttribute("hidden",""),t.removeAttribute("data-name"),l.innerHTML="",l.classList.remove("filled"),l.classList.remove("animate"),e.events.fire($e.notificationHidden)}function s(){e.events.on($e.liked,function(e){e||r("like",ft.render("icon_heart"))}),e.events.on($e.unliked,function(e){e||r("unlike",ft.render("icon_broken_heart"))})}function c(){e.events.on($e.addedToWatchLater,function(e){e||r("watchlater",ft.render("icon_clock"))}),e.events.on($e.removedFromWatchLater,function(e){e||r("unwatchlater",ft.render("icon_clock"))})}function u(){it(t).on("transitionend",function(e){l.contains(e.target)&&"height"===e.propertyName?setTimeout(o,100):e.target===t&&"opacity"===e.propertyName&&window.requestAnimationFrame(a)})}var d,l=t.querySelector(".notification");return u(),s(),c(),e.events.fire($e.notificationModuleReady),{}}function Le(e,t){function n(t){if("vod"===e.config.embed.outro){var n="undefined"!=typeof e.config.video.vod.is_preorder?e.config.video.vod.is_preorder:!!e.config.video.vod.date_available,i=e.config.video.vod.is_coming_soon,o=e.config.video.vod.date_available_formatted_datetime||e.config.video.vod.date_available,s="Bientôt disponible sur Vimeo On Demand.";return i&&o&&(s="Disponible sur Vimeo On Demand le "+o+" !"),n&&(s="Précommander maintenant. Accessible le "+o+"."),m={purchased:e.config.user.purchased,title:e.config.video.vod.feature_title,url:e.config.video.vod.url,currency:e.config.request.currency,countries:e.config.video.vod.countries,country:e.config.request.country,buttons:e.config.video.vod.purchase_options,translationMap:e.config.request.dynamic_translation_map,isPreorder:n,isComingSoon:i,releaseDate:o,strings:{watch:n?"Accessible le "+o:"Regarder",preRelease:s}},void(b===!0&&a())}S=!0;var c=new XMLHttpRequest;c.open("GET","https://"+e.config.player_url+"/video/"+e.config.video.id+"/outro?on_site="+e.config.embed.on_site+"&type="+e.config.embed.outro,!0),c.withCredentials=!0,c.onload=function(){try{var n=JSON.parse(c.response);m=n.data,"videos"!==n.type&&"promoted"!==n.type||(m={contexts:Array.isArray(m)?m:[m],owner:e.config.video.owner.id},r()),"function"==typeof t&&t()}catch(e){}},c.send()}function i(e){for(var t=e.innerHTML;e.scrollHeight>e.clientHeight;)t=t.substring(0,t.length-1),e.innerHTML=t+"&hellip;"}function r(){for(var e=0,t=m.contexts.length;e<t;e++)for(var n=0,i=m.contexts[e].videos.length;n<i;n++){var r=new Image;r.src=m.contexts[e].videos[n].thumbnail}}function o(){var e=window.getComputedStyle(g.querySelector("header h1"),null),t=e.getPropertyValue("-webkit-line-clamp"),n=e.textOverflow;if(!t)for(var r=g.querySelectorAll("header h1"),o=0,a=r.length;o<a;o++)"clip"===n?i(r[o]):r[o].style.display="inherit"}function a(){if("beginning"===e.config.embed.outro)return void e.events.fire(Ge.reset);if(null===m&&!S)return void n(a);if(m){if("videos"===e.config.embed.outro||"promoted"===e.config.embed.outro){var i=m.contexts.reduce(function(e,t){return e+t.videos.length},0);if(0===i)return}m.target=!e.config.embed.on_site,g.innerHTML=ft.render("outro_"+("promoted"===e.config.embed.outro?"videos":e.config.embed.outro),m),g.setAttribute("data-type",e.config.embed.outro),t.classList.remove("hidden"),t.removeAttribute("hidden"),y=!0,"videos"===e.config.embed.outro&&o(),window.requestAnimationFrame(function(){window.requestAnimationFrame(function(){t.classList.add("in"),c()})})}}function s(){y&&(_=!1,y=!1,window.requestAnimationFrame(function(){t.classList.remove("in"),e.events.fire($e.outroHidden),v()}))}function c(){if(!_&&t.clientWidth){window.removeEventListener("resize",x),_=!0;var n=[];if(m.contexts)for(var i=0;i<m.contexts.length;i++)for(var r=0;r<m.contexts[i].videos.length;r++){var o=m.contexts[i].videos[r].id,a=g.querySelector('[data-video-id="'+o+'"]');a&&a.clientWidth>0&&n.push(o)}e.events.fire($e.outroDisplayed,n)}}function u(){e.events.on($e.playProgress,function(e,t,i){b=!1,!S&&null===m&&e>=t-k&&n()})}function d(){e.events.on($e.playInitiated,function(){"nothing"!==e.config.embed.outro&&"beginning"!==e.config.embed.outro||(m=!1)}),e.events.on($e.ended,function(){return e.config.embed.email&&1===e.config.embed.email.time?(e.events.fire(Ge.showOverlay,"email-capture"),void e.events.once($e.overlayClosed,function(){return e.events.fire(Ge.showOutro)})):void e.events.fire(Ge.showOutro)}),e.events.on(Ge.showOutro,function(){e.performDelegateAction(je.showOutro,function(){b=!0,a()})}),e.events.on(Ge.hideOutro,function(){s()}),it(t).on("click",".videos a",function(t){e.events.fire($e.outroVideoPressed,parseInt(this.getAttribute("data-video-id"),10))}),it(t).on("transitionend",function(e){t.classList.contains("in")||(t.classList.add("hidden"),t.setAttribute("hidden",""))},!1),e.events.on([$e.played,$e.seeked,$e.scrubbingStarted],s)}function l(){e.events.on(Ge.showOverlay,function(){setTimeout(function(){t.classList.add("hidden")},150)}),e.events.on($e.overlayClosed,function(){t.classList.contains("in")&&t.classList.remove("hidden")})}function f(){e.events.on(Ge.reset,function(){m=null,S=!1})}function h(){w(t,".vod-button",function(){var t=this.getAttribute("data-product-id");return e.events.fire($e.vodButtonPressed,t),!1}),w(t,".vod-watch-button",function(){if(!("date_available"in e.config.video.vod))return s(),e.events.fire($e.vodButtonPressed),!1})}function v(){window.removeEventListener("resize",x),window.addEventListener("resize",x)}var g=t.querySelector(".outro"),m=null,y=!1,_=!1,b=!1,k=10,S=!1,x=p(c,250);return u(),d(),l(),f(),h(),v(),{}}function Oe(){return go[Math.floor(Math.random()*go.length)]}function Ce(e,t){function n(){var e=t.getBoundingClientRect(),n=Q.getBoundingClientRect(),i=te.getBoundingClientRect(),r=n.bottom+(e.height-n.bottom)/2;return e.height-r-i.height/2+"px"}function i(){var e=t.getBoundingClientRect(),n=Q.getBoundingClientRect(),i=Z.getBoundingClientRect(),r=e.height/2,o=n.bottom+(e.height-n.bottom)/2;return{top:r-i.height/2+"px",transform:"translateY("+(o-r)+"px)"}}function r(r,o){t.setAttribute("data-name",r),Q.innerHTML=o.template,Y=document.activeElement,Y.blur(),o.modal&&c(),o.preventBackgroundClose&&t.setAttribute("data-background-close","false"),o.wrapperClass&&t.classList.add(o.wrapperClass),o.icon.type&&(o.logo&&(te.classList.remove("hidden"),Z.classList.add("cloaked"),window.requestAnimationFrame(function(){te.innerHTML=ft.render("logo"),te.style.bottom=n()})),Z.classList.remove("hidden"),ee.innerHTML=o.icon.html,window.requestAnimationFrame(function(){var e=i();Z.style.top=e.top,Z.style[kt.transformProperty]=e.transform}),t.setAttribute("data-icon",o.icon.type),Z.setAttribute("data-icon",o.icon.type),ee.setAttribute("data-icon",o.icon.type),"private-unlocked"===r&&ee.classList.add("open")),t.classList.add("invisible"),t.classList.remove("hidden"),t.removeAttribute("hidden"),t.classList.add("in"),re=o,ie=r,ne=!0,e.events.fire($e.overlayOpened,r),["share","hd-not-allowed"].indexOf(r)>-1&&f(t),window.requestAnimationFrame(function(){t.classList.remove("invisible"),window.requestAnimationFrame(function(){Q.classList.add("in"),K.classList.add("in")})})}function o(){Q.classList.remove("in"),Q.classList.add("out")}function a(n){if(!l()&&ne){t.removeAttribute("data-background-close"),K.classList.remove("in"),K.classList.add("out"),o(),t.classList.remove("in"),t.classList.add("out"),clearTimeout(X),X=setTimeout(s,200),n&&n.preventDefault&&n.preventDefault();var i=t.querySelector(".back");i&&i.classList.add("cloaked"),e.events.fire($e.overlayClosed,ie),ne=!1,ie=null,re=null,window.requestAnimationFrame(function(){Y&&(Y.focus(),Y=null)})}}function s(){t.setAttribute("hidden",""),t.removeAttribute("data-name"),t.removeAttribute("data-icon"),t.classList.add("hidden"),t.classList.remove("out"),t.classList.remove("embed-active"),t.classList.remove("modal"),t.classList.remove("embed-only"),K.classList.remove("out"),K.classList.remove("in"),Z.removeAttribute("data-icon"),Z.classList.add("hidden"),Z.classList.remove("animate"),ee.removeAttribute("data-icon"),ee.innerHTML="",te.classList.add("hidden"),Q.classList.remove("out"),Q.innerHTML="",e.events.fire($e.overlayCleared)}function c(){t.classList.add("modal"),t.setAttribute("data-modal","true")}function d(){t.setAttribute("data-modal","false")}function l(){return"true"===t.getAttribute("data-modal")}function h(e){if("yes"===e.form.getAttribute("data-bubble")){e.form.setAttribute("data-bubble","no");var n=t.querySelector(".validation-bubble"),i=n.querySelector(".validation-bubble-message");i.innerHTML=e.validationMessage||"There is an error with this input.";var r=e.getBoundingClientRect(),o=e.form.getBoundingClientRect();n.style.left=r.left-o.left+"px",n.style.top=r.height+1+"px",n.classList.remove("hidden"),e.focus(),window.requestAnimationFrame(function(){n.classList.add("animate")}),p()}}function p(e){var n=t.querySelector(".validation-bubble");if(n){if(e)return clearTimeout(J),void n.classList.remove("animate");clearTimeout(J),J=setTimeout(function(){n.classList.remove("animate")},5e3)}}function v(e){var n=t.querySelector("input[type=password]");return n.form.classList.contains("submitted")?(n.setAttribute("aria-invalid","false"),n.setCustomValidity(""),n.checkValidity&&!n.checkValidity()?(n.setAttribute("aria-invalid","true"),n.validity.valueMissing&&n.setCustomValidity("Veuillez saisir le mot de passe."),e||h(n),!1):(p(!0),!0)):null}function g(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=e.showBubble,i=void 0===n||n,r=t.querySelector("input[type=email]");return r.setAttribute("aria-invalid","false"),r.setCustomValidity(""),r.checkValidity&&!r.checkValidity()?(r.setAttribute("aria-invalid","true"),r.validity.valueMissing&&r.setCustomValidity("Veuillez saisir votre adresse e-mail."),r.validity.typeMismatch&&r.setCustomValidity("Veuillez saisir une adresse e-mail valide."),i&&h(r),!1):(p(!0),!0)}function m(e,n,i){f(t);var r=Vn(e.querySelectorAll("input")),o=r.map(function(e){return e.name?encodeURIComponent(e.name)+"="+encodeURIComponent(e.value):encodeURIComponent(e.value)}).join("&"),a=new XMLHttpRequest;a.open(e.method,e.action+window.location.search,!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.withCredentials=!0,a.timeout=3e3,a.onload=function(){var e;try{e=JSON.parse(a.responseText)}catch(e){}n(e,a)},a.onerror=function(e){i(e)},a.send(o)}function y(){_(),k(),d(),o()}function _(){te.classList.add("animate")}function b(){te.classList.add("hidden"),te.classList.remove("animate")}function k(){Z.classList.remove("cloaked"),Z.classList.add("animate"),window.requestAnimationFrame(function(){Z.style[kt.transformProperty]="translateY(-10px)"})}function S(){Z.classList.add("centered"),Z.style[kt.transformProperty]=""}function x(){ee.classList.add("open")}function T(){ee.classList.add("pulled-back")}function E(){ee.classList.add("out"),ee.classList.remove("pulled-back")}function P(){it(t).on("transitionend",".overlay-logo",function(e){"opacity"===e.propertyName&&this.classList.contains("animate")&&b()}),it(t).on("transitionend",".overlay-icon-wrapper",function(e){e.propertyName.indexOf("transform")>-1&&(""===this.style[kt.transformProperty]?(this.classList.remove("centered"),"lock"!==this.getAttribute("data-icon")||ee.classList.contains("open")||ee.querySelector("canvas")?T():setTimeout(x,100)):"translateY(-10px)"===this.style[kt.transformProperty]&&S())}),it(t).on("transitionend",".overlay-icon",function(e){e.propertyName.indexOf("transform")>-1&&(this.classList.contains("out")?(d(),a()):this.classList.contains("pulled-back")?E():this.classList.contains("open")&&T())})}function A(){return{modal:!1,template:null,logo:!1,icon:{type:null,html:null}}}function M(t,n){var i=e.config.video.title,r=e.config.video.owner.name,o=e.config.video.share_url;return t.template=ft.render("share",{url:e.config.video.url,shareUrl:o,playerShareUrl:"https://"+e.config.player_url+"/video/"+e.config.video.id+"/share",title:i,owner:r,embed:"public"===e.config.video.embed_permission&&e.config.embed.settings.embed,embedOnly:e.config.embed.settings.share&&e.config.embed.settings.share.embed_only,embedCode:e.config.video.embed_code.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"),copyButton:oe||kt.flash.installed,customizeEmbed:!!e.config.video.url,readOnly:!kt.touch,strings:{share:"Partager",facebook:"Partager sur Facebook",twitter:"Partager sur Twitter",tumblr:"Partager sur Tumblr",email:"Partager par e-mail",emailSubject:"Découvrez « "+i+" » de "+r+" sur Vimeo",emailBody:"Découvrez « "+i+" » de "+r+" sur Vimeo.\n\nLa vidéo est disponible et peut être vue depuis "+o+"\n\nSi vous aimez cette vidéo, partagez-là !\n\nVimeo regorge de vidéos incroyables. Voir d’autres vidéos sur https://vimeo.com.",embedCode:"Obtenir le code d’intégration",embedTitle:"Intégration",embedSubtitle:"Ajoutez cette vidéo à votre site en utilisant le code d’intégration ci-dessous.",copy:"Copier",copySuccess:"Copié !",customize:'<a href="'+e.config.video.url+'#embed" target="_blank">Personnalisez cette intégration</a> sur Vimeo'}}),e.config.embed.settings.share&&e.config.embed.settings.share.embed_only&&(t.wrapperClass="embed-only"),t}function L(t){return t.icon={type:"lock",html:ft.render("icon_lock")},t.modal=!0,t.logo=!0,t.template=ft.render("private_locked",{action:"https://"+e.config.vimeo_url+"/log_in",strings:{title:"Vidéo privée",subtitle:"Connectez-vous pour visionner (si vous avez la permission)",logIn:"Se connecter",logInLabel:"Se connecter (s’ouvre dans une autre fenêtre)"}}),t}function O(t){return t.icon={type:"lock",html:ft.render("icon_lock")},t.template=ft.render("password",{action:"https://"+e.config.player_url+"/video/"+e.config.video.id+"/check-password?referrer="+e.config.request.referrer,strings:{title:"Mot de passe requis",subtitle:"Si vous l’avez, saisissez-le ci-dessous",password:"Mot de passe ",watch:"Regarder cette vidéo"}}),t.modal=!0,t.logo=!!e.config.embed.settings.branding,t}function C(e){return e.icon={type:"lock",html:ft.render("icon_lock")},e.template=ft.render("private_unlocked",{strings:{title:"Vidéo privée",subtitle:"Vous êtes connecté et avez la permission de visionner le contenu (félicitations).",watch:"Regarder cette vidéo"}}),e}function I(e){return e.template=ft.render("content_rating",{logo:ft.render("logo"),strings:{title:"Stop !",subtitle:"Cette vidéo est cachée car elle pourrait contenir du contenu pour adultes dont de la nudité, du langage injurieux ou de la violence.",update:'Vous pouvez <a href="">mettre à jour votre filtre de contenu pour adultes</a> à tout moment.',watch:"Je souhaite toujours regarder cette vidéo"}}),e.modal=!0,e}function q(e,t){return e.template=ft.render("error",{title:t.title,message:t.message}),e.modal=!!t.modal,e.logo=!!t.logo,t.icon&&"lock"===t.icon&&(e.icon={type:"lock",html:ft.render("icon_lock")}),e}function R(t){return t.template=ft.render("help",{onSite:e.config.embed.on_site,strings:{title:"Raccourcis clavier",volumeUp:"Augmenter le volume",volumeDown:"Baisser le volume",scrubForward:"Avancer",scrubBackwards:"Revenir en arrière",like:"J’aime",share:"Partager",watchLater:"Regarder plus tard",captions:"Activer les légendes",hd:"Afficher le menu HD",fullscreen:"Activer le plein écran",viewOnVimeo:"Regarder sur Vimeo"}}),t}function F(t){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return t.template=ft.render("overlay_email_capture",{text:n.text||e.config.embed.email.text,subtitle:n.subtitle||"Partagez votre adresse e-mail avec "+e.config.video.owner.name+" :",action:"https://"+e.config.player_url+"/video/"+e.config.video.id+"/submit-email",confirmation:n.confirmation||e.config.embed.email.confirmation,referrer:e.config.request.referrer,strings:{email:"Adresse e-mail",fullName:"Nom complet (optionnel)",submit:"Envoyer"}}),t.modal=!1,t.logo=!1,t.preventBackgroundClose=!0,t}function B(e){var t=window.getComputedStyle(e),n=document.createElement("button");n.style.visibility="hidden",n.style.padding=0,e.parentElement.appendChild(n),n.innerText="Copier";var i=n.clientWidth;n.innerText="Copié !";var r=n.clientWidth,o=parseFloat(t.fontSize),a=parseFloat(t.paddingLeft),s=parseFloat(t.paddingRight),c=a+Math.max(i,r)+s;return e.parentElement.removeChild(n),(c+2)/o+"em"}function D(){e.events.on(Ge.showOverlay,function(n,i){oe=document.queryCommandSupported&&document.queryCommandSupported("copy");var o=function(){var e=A();switch(n){case"share":r(n,M(e,i));var o=t.querySelector(".embed-copy");return void(o.style.width=B(o));case"private-locked":return void r(n,L(e));case"password":return void r(n,O(e));case"private-unlocked":return void r(n,C(e));case"error":return void r(n,q(e,i));case"help":return void r(n,R(e));case"content-rating":return void r(n,I(e));case"email-capture":return void r(n,F(e,i))}};return ne?"share"!==ie&&"help"!==ie&&"hd-not-allowed"!==ie||ie!==n?(e.events.once($e.overlayCleared,o),d(),void a()):void a():void o()}),it(t).on("input","input",function(){this.form.classList.add("interacted")}).on(["focus","blur"],"input",function(){p(!0)}).on("transitionend",".validation-bubble",function(e){"opacity"===e.propertyName&&"0"===window.getComputedStyle(this,"").opacity&&this.classList.add("hidden")}),e.events.on([$e.overlayCloseButtonPressed,$e.played],a),e.events.on($e.privateUnlocked,function(){"private-locked"===ie&&(d(),a())}),e.events.on($e.configChanged,function(){"share"===ie&&(re=M(A(),e.config.embed.settings.share.embed_only),Q.innerHTML=re.template)}),it(window).on("resize",function(){if(ne){te.style.bottom=n();var e=i();Z.style.top=e.top,Z.style[kt.transformProperty]=e.transform}})}function N(){function n(){e.events.fire($e.embedCodeCopied);var t=document.querySelector(".embed-copy");t.innerHTML=t.getAttribute("data-success-label"),clearTimeout(i),i=setTimeout(function(){t.innerHTML=t.getAttribute("data-label")},2e3)}var i;it(t).on("transitionend",".share-screen",function(e){"opacity"===e.propertyName&&"0"===window.getComputedStyle(this,"").opacity&&this.classList.add("cloaked")}).on("transitionend",".embed-screen",function(e){"opacity"===e.propertyName&&"0"===window.getComputedStyle(this,"").opacity&&(t.querySelector(".back").classList.add("cloaked"),this.classList.add("cloaked"),f(t))}).on("copy","input[name=embed_code]",function(){e.events.fire($e.embedCodeCopied)}),w(t,".back",function(){return t.querySelector(".share-screen").classList.remove("cloaked"),t.classList.remove("embed-active"),!1}),w(t,".facebook",function(){e.events.fire($e.facebookButtonPressed,this.href);try{document.activeElement.blur()}catch(e){}return!1}),w(t,".twitter",function(){e.events.fire($e.twitterButtonPressed,this.href);try{document.activeElement.blur()}catch(e){}return!1}),w(t,".tumblr",function(){e.events.fire($e.tumblrButtonPressed,this.href);try{document.activeElement.blur()}catch(e){}return!1}),w(t,".email",function(){e.events.fire($e.emailButtonPressed),window.location=this.href;try{document.activeElement.blur()}catch(e){}return!1}),w(t,".embed",function(){e.events.fire($e.embedButtonPressed);try{document.activeElement.blur()}catch(e){}return!1}),w(t,".embed-copy",function(){if(oe){var e=document.querySelector("input[name=embed_code]");e.select();try{document.execCommand("copy")&&n()}catch(e){}return document.activeElement.blur(),!1}}),kt.touch?it(Q).on("focus","input[name=embed_code]",function(){var e=this;setTimeout(function(){e.setSelectionRange(0,9999),e.setAttribute("readonly","readonly")},0)}).on("blur","input",function(){this.removeAttribute("readonly")}):it(Q).on("click","input[name=embed_code]",function(){this.setSelectionRange(0,9999)}),e.events.on($e.facebookButtonPressed,function(e){u(e,"facebook",{width:580,height:400})}).on($e.twitterButtonPressed,function(e){u(e,"twitter",{width:550,height:420})}).on($e.tumblrButtonPressed,function(e){u(e,"tumblr",{width:540,height:600})}).on($e.embedButtonPressed,function(){function i(){var t=document.querySelector(".embed-copy"),i=new ZeroClipboard(t,{moviePath:e.config.request.urls.zeroclip_swf,trustedDomains:["*"],allowScriptAccess:"always"});i.on("complete",n)}if(e.config.embed.settings.share.embed_only||(t.querySelector(".back").classList.remove("cloaked"),t.querySelector(".embed-screen").classList.remove("cloaked"),t.classList.add("embed-active")),!oe&&kt.flash.installed){var r="zc_script_loaded";if(!document.getElementById(r)){var o,a=document.createElement("script");return a.setAttribute("id",r),a.setAttribute("src",e.config.request.urls.zeroclip_js),a.onreadystatechange=a.onload=function(){o||i(),o=!0},void document.getElementsByTagName("head")[0].appendChild(a)}i()}})}function H(){it(Q).on("click",".popup",function(){return e.events.fire(Ge.openPopup,"login-private-locked"),!1})}function V(){function t(t){function n(t,n){return t===!1?void i(n.status,n):(e.events.fire($e.passwordUnlocked,t),"icon-hidden"===window.getComputedStyle(K,":after").content?(d(),void a()):void y())}function i(e){s.classList.remove("loading"),o.setCustomValidity("Oh oh. Un problème s’est produit. Veuillez réessayer."),o.setAttribute("aria-invalid","true"),h(o)}var r=v();if(!r)return!1;var o=t.querySelector("input[type=password]"),s=t.querySelector("input[type=submit]");s.classList.add("loading"),m(t,n,i)}it(Q).on("click",".password input[type=submit]",function(){this.form.classList.add("submitted"),this.form.setAttribute("data-bubble","yes"),v(!0)}).on("submit",".password form",function(){return t(this),!1}).on(["focus","input"],[".password input[type=email]",".password input[type=password]"],function(){v()})}function j(){w(Q,".unlocked button",function(){y(),kt.iPad||kt.iPhone||e.events.once($e.overlayCleared,function(){e.events.fire($e.playButtonPressed)})})}function z(){w(Q,".content-rating button",function(){d(),a()})}function U(){function t(){var e=Q.querySelector(".email-capture-form"),t=Q.querySelector(".email-capture-confirm");e.classList.add("invisible"),t.classList.remove("hidden"),window.requestAnimationFrame(function(){window.requestAnimationFrame(function(){t.classList.add("in"),setTimeout(a,2750)})})}function n(n){function i(n,i){return n===!1?void r(i.status,i):(e.events.fire($e.emailCaptureSuccess),void t())}function r(e){a.classList.remove("loading"),o.setCustomValidity("Uh oh. There was a problem. Please try again."),o.setAttribute("aria-invalid","true"),h(o)}if(!g())return!1;var o=n.querySelector("input[type=email]"),a=n.querySelector("input[type=submit]"),s={signature:"signature",time:"timestamp",expires:"expires"};Object.keys(s).forEach(function(t){var i=n.querySelector("input[name="+t+"]");i.value=e.config.request[s[t]]}),a.classList.add("loading"),m(n,i,r)}it(Q).on("click",".email-capture input[type=submit]",function(){this.form.classList.add("submitted"),this.form.setAttribute("data-bubble","yes"),g()}).on("submit",".email-capture form",function(){return e.events.fire($e.emailCaptureSubmitted),n(this),!1}).on(["focus","input"],".email-capture input[type=email]",function(){g({showBubble:!1})})}function W(){var t=function(e,t,n){var i=window.location.search.indexOf("partypooper=1")>-1||window.location.search.indexOf("fun=0")>-1;switch(e){case"not-supported":return{name:"notsupported",title:i?"Désolé":Oe(),message:n>.5?"Une erreur est survenue lors de la lecture de cette vidéo.":"Cette vidéo ne peut être lue avec votre système actuel."};default:return{name:e,title:t&&t.title||"Désolé",message:t&&t.message||"Un problème est survenu lors du playback."}}};e.events.on($e.error,function(n){var i=arguments.length<=1||void 0===arguments[1]?{modal:!0,final:!0}:arguments[1];if(i.final!==!1){var o=e.telecine?e.telecine.currentTime:0,s=t(n,i,o),c=s.name,u=s.title,d=s.message,l=A();return l.modal=i.modal,l.template=ft.render("error",{title:u,message:d}),ne?(a(),void e.events.once($e.overlayClosed,function(){return r(c,l)})):void r(c,l)}})}function G(){e.events.on($e.configChanged,function(){window.requestAnimationFrame(function(){d(),a()})})}function $(){w(t,".close",function(){e.events.fire($e.overlayCloseButtonPressed)}),it(t).on(["click","touchend"],[".window-wrapper",".share-wrapper",".overlay-logo"],function(e){e.stopPropagation()}).on(["click","touchend"],[".overlay-cell","nav"],function(){return"false"===t.getAttribute("data-background-close")||(e.events.fire($e.overlayCloseButtonPressed),!1)})}var X,J,Y,K=t.querySelector(".overlay-cell"),Q=t.querySelector(".overlay"),Z=t.querySelector(".overlay-icon-wrapper"),ee=Z.querySelector(".overlay-icon"),te=t.querySelector(".overlay-logo"),ne=!1,ie=null,re=null,oe=!1;return D(),P(),N(),H(),V(),j(),z(),U(),W(),G(),$(),e.events.fire($e.overlayModuleReady),{}}function Ie(e,t){function i(e,t){var n=".player-"+u+" ",i=n+e.join(","+n);if(t){var r=d+" ";i+=","+r+e.join(","+r)}return l&&(i=i.replace(/:hover/g,":active")),i=i.replace(/ &/g,"")}function r(){var e=document.createElement("style");return e.setAttribute("data-player",u),document.querySelector("head").appendChild(e),f=e.sheet}function o(){for(;f.cssRules.length>0;)f.deleteRule(0)}function a(){f?o():r()}function s(e){a();var t=e.complement,r=new R(23,35,34,.75),o=new R(0,0,0,.15),s=o.overlayOn(e);r.contrast(t).ratio<3&&t.lighten(5,3,r);var c,u=e.lightness<40?e.clone().lighten(15,3,e):e.clone().darken(15,3,e);return n(i(mo,!0),"color:"+e.hex+" !important",f),n(i(yo,!0),"color:"+t.hex+" !important",f),n(i(_o),"color:"+e.hex,f),n(i(ko),"fill:"+e.hex,f),n(i(xo),"stroke:"+e.hex,f),n(i(Eo),"background-color:"+e.hex,f),n(i(Po),"border-color:"+e.hex,f),n(i(bo),"color:"+t.hex,f),n(i(wo),"fill:"+t.hex,f),n(i(So),"fill:"+u.hex,f),n(i(To),"stroke:"+u.hex,f),n(i(qo),"border-color:"+s.hex,f),n(i(Ro),"background-color:"+s.hex,f),e.luminance>.95&&(t=e.clone().darken(15,3,e),n(i(Ao),"color:"+t.hex,f),n(i(Mo),"fill:"+t.hex,f),n(i(Lo),"stroke:"+t.hex,f),u=t.clone().darken(15,3,t),n(i(So),"fill:"+u.hex,f),n(i(To),"stroke:"+u.hex,f)),e.yiq>175&&e.luminance<.95&&(c=u.clone().darken(15,3,u),n(i(So),"fill:"+c.hex,f),n(i(To),"stroke:"+c.hex,f),n(i(Oo),"color:"+u.hex,f),n(i(Co),"fill:"+u.hex,f),n(i(Io),"stroke:"+u.hex,f)),{main:e.hex,selected:u.hex,sidedockHover:c?u.hex:e.luminance>.95?t.hex:R.white.hex,sidedockSelected:e.luminance>.95?t.hex:e.hex,sidedockSelectedHover:c?c.hex:u.hex}}function c(){e.events.on(Ge.changeColor,function(t){var n;try{n=new R(t)}catch(e){n=new R("00adef")}var i=s(n);e.config._colors=i,e.config.embed.color=i.main.replace("#",""),e.events.fire($e.colorChanged,e.config.embed.color)}),e.events.fire(Ge.changeColor,e.config.embed.color)}var u=t.uuid,d=t.id,l=t.isMobileDevice,f=null;return c(),{}}function qe(e){function t(){e.events.on(Ge.openPopup,function(t,n){var i="https://"+e.config.player_url,o=i+"/video/"+e.config.video.id,a=670,s=545;switch(t){case"login-like":r=u(o+"/login/like","login",{width:a,height:s}),e.events.fire($e.popupOpened,t);break;case"login-watch-later":r=u(o+"/login/watch-later","login",{width:a,height:s}),e.events.fire($e.popupOpened,t);break;case"login-private-locked":r=u(o+"/login/private","login",{width:a,height:s}),e.events.fire($e.popupOpened,t);break;case"purchase":var c=i+"/video/"+(e.config.video.vod.feature_id||e.config.video.id)+"/purchase/vod";n&&n.productId&&(c+="/"+n.productId),c+="?referrer="+encodeURIComponent(e.config.request.referrer),r=u(c,"purchase",{width:790,height:670}),e.events.fire($e.popupOpened,t)}}),window.closePopup=function(t){if(r){try{r.close(),e.events.fire($e.popupClosed,t)}catch(e){}r=null}}}function n(){e.config.embed.on_site||(window.confirmPurchase=function(t,n,i){return n?void e.loadVideo(t):void(i&&e.events.fire($e.playButtonPressed))})}function i(){e.config.embed.on_site||(window.confirmLoginAction=function(t,n){e.events.fire($e.userLogIn,n)})}var r=null;return t(),n(),i(),{}}function Re(e,t){function n(){D&&(J||(N&&X||V||U||K)&&(H||(!j&&!z||V||U)&&(D=!1,e.events.fire($e.sidedockVisibilityChanged,D),(Y||t).classList.add("invisible"))))}function i(){if(!D&&!U&&!V){var n=Y||t;n.classList.add("invisible"),n.classList.remove("hidden"),n.removeAttribute("hidden"),t.classList.remove("hidden"),t.removeAttribute("hidden"),t.classList.contains("vod")&&t.classList.remove("vod"),setTimeout(function(){D=!0,e.events.fire($e.sidedockVisibilityChanged,D),n.classList.remove("invisible")},0)}}function r(){N=!1,H=!1,J=!1}function o(t,n,i){var r="data-label-"+i,o="add"!==i||e.config.user.logged_in?r:"data-label-add-logged-out";t.setAttribute("aria-label",t.getAttribute(o)),n.classList.add("hidden"),n.setAttribute("hidden",""),n.firstChild.innerHTML=t.getAttribute(r)}function a(){var e=W.indexOf(this);G.forEach(function(t,n){n!==e&&t&&t.classList.add("invisible")}),e>=0&&G[e]&&(G[e].classList.add("invisible"),G[e].classList.remove("hidden"),G[e].removeAttribute("hidden",""),$=window.requestAnimationFrame(function(){$=window.requestAnimationFrame(function(){G[e].classList.remove("invisible"),G[e].classList.add("visible")})}))}function s(){var e="BUTTON"===this.tagName?this:this.querySelector("button"),t=W.indexOf(e);t>=0&&G[t]&&($&&(window.cancelAnimationFrame($),$=null),G[t].classList.add("invisible"))}function c(){if(M){var e=M.parentElement;Y.insertBefore(e,Y.firstChild)}}function u(){if(M){var e=M.parentElement;t.insertBefore(e,Y)}}function d(){if(e.config.view===Ve.main||e.config.view===Ve.privateUnlocked){var n=e.config.embed.settings,i=e.config.video.vod&&"purchase_options"in e.config.video.vod&&e.config.video.vod.purchase_options.length,r=i&&e.config.video.vod.is_coming_soon,o="ondemand.main"===e.config.embed.context,a=e.config.video.vod&&e.config.user.purchased?1:0,s=i&&n.vod&&y(e.config.video.vod.countries,e.config.request.country);s&&r&&o&&(s=!1);var u=i&&e.config.video.vod.purchase_options[0],d=null;u&&(d=g(e.config.request.dynamic_translation_map,"label_string",e.config.request.currency,u)),t.innerHTML=ft.render("sidedock",{loggedIn:!!e.config.user.logged_in,vodButton:s,purchased:a,vodPurchaseInfo:u,vodDisplayLabel:d,likeButton:n.like,liked:e.config.user.liked,watchLaterButton:n.watch_later,addedToWatchLater:e.config.user.watch_later,collectionsButton:n.collections,shareButton:n.share,strings:{like:"J’aime",likeLoggedOut:"J’aime (s’ouvre dans une autre fenêtre)",unlike:"Je n’aime plus",watchLaterAdd:"Ajouter à la liste Regarder plus tard",watchLaterAddLoggedOut:"Ajouter à la liste Regarder plus tard (s’ouvre dans une autre fenêtre)",watchLaterRemove:"Enlever de la liste Regarder plus tard",collections:"Ajouter aux collections",share:n.share&&n.share.embed_only?"Intégration":"Partager"}}),M=t.querySelector(".vod-button"),s&&(Y=t.querySelector(".sidedock-inner"),a&&c());var l=Y||t;i&&s&&!e.config.embed.settings.instant_sidedock?t.classList.add("vod"):kt.touch&&(D=!0,
e.events.fire($e.sidedockVisibilityChanged,D),l.classList.remove("hidden"),l.removeAttribute("hidden"),l.classList.remove("invisible")),L=t.querySelector(".like-button"),O=t.querySelector(".like-label"),C=t.querySelector(".watch-later-button"),I=t.querySelector(".watch-later-label"),q=t.querySelector(".collections-button"),R=t.querySelector(".collections-label"),F=t.querySelector(".share-button"),B=t.querySelector(".share-label"),W=[M,L,C,F,q],G=[null,O,I,B,R]}}function l(){var t=e.config.embed.settings.instant_sidedock,n=e.config.video.vod,r=n&&"purchase_options"in n&&n.purchase_options.length,o=n&&y(e.config.video.vod.countries,e.config.request.country);(t||r&&o)&&(K||i())}function f(){w(t,".vod-button",function(){var t=M.getAttribute("data-product-id");e.events.fire($e.vodButtonPressed,t)},s),e.events.on($e.outroDisplayed,function(){c()}),e.events.on($e.outroHidden,function(){u()})}function h(){w(t,".like-button",function(){e.events.fire($e.likeButtonPressed)},s),e.events.on($e.liked,function(){L&&(L.classList.add("on"),o(L,O,"remove"))}),e.events.on($e.unliked,function(){L&&(L.classList.remove("on"),o(L,O,"add"))})}function p(){w(t,".watch-later-button",function(){e.events.fire($e.watchLaterButtonPressed)},s),e.events.on($e.addedToWatchLater,function(){C&&(C.classList.add("on"),o(C,I,"remove"))}),e.events.on($e.removedFromWatchLater,function(){C&&(C.classList.remove("on"),o(C,I,"add"))})}function v(){w(t,".collections-button",function(){e.events.fire($e.collectionsButtonPressed)},s)}function m(){w(t,".share-button",function(){return e.events.fire(e.config.embed.settings.share.embed_only?$e.embedButtonPressed:$e.shareButtonPressed),!1},s)}function _(){var e=function(e){"opacity"===e.propertyName&&e.target.classList.contains("invisible")&&(e.target.classList.add("hidden"),e.target.setAttribute("hidden",""),e.target.classList.remove("visible"))};it(t).on("blur","button",s).on("mouseleave",".box",s).on(["focus","pointerdown","touchstart","mouseenter"],"button",a).on("transitionend","label",e),w(t,"label",function(){var e=G.indexOf(this);e>=0&&W[e].click()})}function b(){e.events.on([$e.mousedOut,$e.mouseTimeout],n).on($e.mousedOver,i).on($e.targetTimeReached,function(){X=!0,n()}).on($e.played,function(){N=!0}),it(t).on(["pointerenter","pointerleave","mouseenter","mouseleave"],function(e){return"pointerType"in e?void("mouse"!==e.pointerType&&e.pointerType!==e.MSPOINTER_TYPE_MOUSE||(H="pointerenter"===e.type||"MSPointerEnter"===e.type)):void(H="mouseover"===e.type)}),it(t).on("transitionend",function(e){var n=Y||t;"opacity"===e.propertyName&&n.classList.contains("invisible")&&(n.classList.add("hidden"),n.setAttribute("hidden",""),M&&n.contains(M)&&(t.classList.add("hidden"),t.setAttribute("hidden","")))})}function k(){e.events.on($e.willEnterFullscreen,function(){H=!1,n()}).on($e.didExitFullscreen,function(e){e||(J=!0)})}function S(){e.events.on([$e.airPlayActivated],function(){j=!0,i()}).on([$e.airPlayDeactivated],function(){j=!1})}function x(){e.events.on($e.pictureInPictureActivated,function(){z=!0,i()}).on($e.pictureInPictureDeactivated,function(){z=!1})}function T(){e.events.on($e.overlayOpened,function(){V=!0,H=!1,n()}).on($e.overlayClosed,function(){V=!1,i()})}function E(){e.events.on($e.alertVisibilityChanged,function(e){U=e,e&&n()})}function P(){e.events.on($e.configChanged,function(){d()})}function A(){e.events.on(Ge.reset,function(){H=!1,X=!1,n(),r()})}var M,L,O,C,I,q,R,F,B,D=!1,N=!1,H=!1,V=!1,j=!1,z=!1,U=!1,W=[],G=[],$=null,X=!1,J=!1,Y=null,K=e.config.embed.autoplay&&e.config.request.flags.autohide_controls;return d(),l(),f(),h(),p(),v(),m(),_(),b(),k(),S(),x(),T(),E(),P(),A(),e.events.fire($e.sidedockModuleReady),{}}function Fe(e,t){function n(){p=!1,t.classList.add("invisible")}function i(){t.classList.remove("hidden"),t.removeAttribute("hidden"),setTimeout(function(){p=!0,t.classList.remove("invisible")},0)}function r(){if(p){if(g)return void n();if(b)return void n();if(!m&&y)return _&&v?void 0:void n()}}function o(){if(!p){if(m&&!g)return void i();if(_&&!k&&!b)return y||g?e.config.embed.settings.info_on_pause&&_&&!g?void i():void 0:void i()}}function a(){if(e.config.view===Ve.main||e.config.view===Ve.privateUnlocked){var n=!!e.config.embed.settings.byline,i=null!==e.config.video.owner.url,r=e.config.video.owner.url,o=0===e.config.embed.on_site,a="v1"===e.config.video.design_version_360,s="v2"===e.config.video.design_version_360,c={linkToOwner:i,ownerLink:r,targetBlank:o,showPortrait:!!e.config.embed.settings.portrait,portraitImg:e.config.video.owner[kt.devicePixelRatio>1?"img_2x":"img"],showByline:n,showTitle:!!e.config.embed.settings.title,showTitleLink:null!==e.config.video.url,titleLink:e.config.video.url,title:e.config.video.title,is360:e.config.video.is_panorama&&(a||s),strings:{}};if(e.config.embed.settings.byline){var u=e.config.embed.settings.byline_badge,d="";u&&u.type&&(d=ft.render("title_byline_badge",{targetBlank:o,cssClass:u.type,link:u.url||!1})),c.strings.byline="de "+ft.render("title_owner_byline",{linkToOwner:i,ownerLink:r,targetBlank:o,owner:e.config.video.owner.name})+d}var l=e.config.embed.settings.badge;if(l){var f=kt.devicePixelRatio>1?"img_2x":"img";kt.svg&&l.svg&&(f="svg"),c.showPortrait=!1,c.badge={link:l.link,img:l[f],offset:l.offset||!1,width:l.width,height:l.height,name:l.name,shadow:l.shadow||!1}}e.config.embed.autoplay&&(t.classList.add("hidden"),t.setAttribute("hidden","")),t.innerHTML=ft.render("title",c)}}function s(){e.events.on([$e.mousedOut,$e.mouseTimeout],r).on($e.mousedOver,o).on($e.playInitiated,function(){y=!0,_=!1,r()}).on([$e.playButtonPressed,$e.played],function(){_=!1,k=!1,r()}).on($e.paused,function(e,t){t||(_=!0,o())}).on($e.ended,function(){b=!0,r()}).on($e.scrubbingStarted,function(){S=_,k=!0}).on($e.scrubbingEnded,function(){S&&(k=!1)}).on($e.willEnterFullscreen,function(){r()}).on($e.didExitFullscreen,function(e){e||o()}),it(t).on(["pointerenter","pointerleave","mouseenter","mouseleave"],function(e){return"pointerType"in e?void("mouse"!==e.pointerType&&e.pointerType!==e.MSPOINTER_TYPE_MOUSE||(v="pointerenter"===e.type||"MSPointerEnter"===e.type)):void(v="mouseover"===e.type)}),it(t).on("transitionend",function(e){"opacity"===e.propertyName&&t.classList.contains("invisible")&&(t.classList.add("hidden"),t.setAttribute("hidden",""))},!1)}function c(){e.events.on($e.ended,function(e){r()})}function u(){e.events.on([$e.airPlayActivated],function(){m=!0,o()}).on([$e.airPlayDeactivated],function(){m=!1,r()})}function d(){e.events.on($e.overlayOpened,function(e){"notsupported"!==e&&"private-unlocked"!==e&&"help"!==e&&(g=!0,v=!1,r())}).on($e.overlayClosed,function(){g=!1,v=!1,setTimeout(o,0)})}function l(){w(t,".badge",function(){e.events.fire($e.badgePressed,e.config.embed.settings.badge.id)})}function f(){e.events.on($e.configChanged,function(){a(),e.config.view===Ve.privateUnlocked&&o()})}function h(){e.events.on(Ge.reset,function(){y=!1,_=!0,b=!1,k=!1,o()})}var p=!0,v=!1,g=!1,m=!1,y=!1,_=!0,b=!1,k=!1,S=!1;return a(),s(),c(),u(),d(),l(),f(),h(),e.events.fire($e.titleModuleReady),{}}function Be(e,t,n,r){function o(){var t=q,n=window.getComputedStyle(e,":after");n&&(q=n.getPropertyValue("content").replace(/["'\s]*/g,""),q&&t!==q&&"undefined"!=typeof R[q]&&x.events.fire(R[q]))}function a(){var t=(x.config.view===Ve.main||x.config.view===Ve.privateUnlocked)&&x.config.embed.settings&&!x.config.embed.settings.playbar;e.classList.toggle("no-playbar",t),e.classList.toggle("with-fullscreen",!!x.config.embed.settings.fullscreen);var n=x.config.embed.settings.custom_logo;e.classList.toggle("with-custom-logo",!!n),e.classList.toggle("with-sticky-custom-logo",n&&n.sticky),e.classList.toggle("background-mode",!!x.config.embed.settings.background),e.classList.toggle("touch-support",kt.touch)}function s(e){var t=arguments.length<=1||void 0===arguments[1]?x.config.video.url:arguments[1];if(!(!t||e&&e.metaKey))return t.indexOf("#")===-1&&x.telecine.currentTime>0&&x.telecine.currentTime<x.config.video.duration-30&&!x.telecine.paused&&(t+="#at="+Math.floor(x.telecine.currentTime)),x.config.embed.on_site?void(window.location=t):(window.open(t),i(e),x.events.fire($e.pauseButtonPressed),!1)}function u(){a(),x.events.on($e.configChanged,a)}function d(){M=new He(function(e,t){var n=function(){return window.innerWidth>0&&window.innerHeight>0},i=null,r=function t(){return clearTimeout(i),n()?void e():void(i=setTimeout(t,250))};x.events.once($e.ready,r),x.events.once($e.error,r)})}function f(){var e=function(e,t){return x.verifyConfig().then(function(){var n=x.config.request,i=n.signature,r=n.session,o=n.timestamp,a=n.expires,s="https://"+x.config.player_url+"/video/"+x.config.video.id+"/"+e+"?signature="+i+"&session="+r+"&time="+o+"&expires="+a;return l(s,{method:t})})};x.events.on($e.vodButtonPressed,function(e){if(x.config.user.purchased){if(!x.config.video.vod.is_feature&&x.config.video.vod.feature_id)return void x.loadVideo(x.config.video.vod.feature_id).then(function(){return x.events.fire($e.playButtonPressed),x.config.video.vod.feature_id}).catch(function(e){x.events.fire(Ge.showOverlay,"error",{title:"Désolé",message:"Un problème s’est produit. Veuillez essayer à nouveau."})});if(x.config.video.vod&&x.config.video.vod.is_coming_soon)return;return void x.events.fire($e.playButtonPressed)}x.performDelegateAction(je.purchase,function(){x.events.fire(Ge.openPopup,"purchase",{productId:e})},e)}),x.events.on($e.likeButtonPressed,function(){return x.config.user.logged_in?void(x.config.user.id!==x.config.video.owner.id&&(x.config.user.liked?x.performDelegateAction(je.unlike,function(){e("like","DELETE"),x.config.user.liked=!1,x.events.fire($e.unliked)}):x.performDelegateAction(je.like,function(){e("like","PUT"),x.config.user.liked=!0,x.events.fire($e.liked)}))):void x.performDelegateAction(je.loginForm,function(){x.events.fire(Ge.openPopup,"login-like")},"like")}),x.events.on($e.watchLaterButtonPressed,function(){if(x.config.video.url||"unlisted"===x.config.video.privacy)return x.config.user.logged_in?x.config.user.watch_later?void x.performDelegateAction(je.removeFromWatchLater,function(){e("watch-later","DELETE"),x.config.user.watch_later=!1,x.events.fire($e.removedFromWatchLater)}):void x.performDelegateAction(je.addToWatchLater,function(){e("watch-later","PUT"),x.config.user.watch_later=!0,x.events.fire($e.addedToWatchLater)}):void x.performDelegateAction(je.loginForm,function(){x.events.fire(Ge.openPopup,"login-watch-later")},"watch-later")}),x.events.on($e.collectionsButtonPressed,function(){x.performDelegateAction(je.collectionsOverlay,function(){return x.config.video.vod&&x.config.video.vod.url?void s(null,x.config.video.vod.url+"#collections"):x.config.video.url?void s(null,x.config.video.url+"#collections"):void 0})}),x.events.on($e.shareButtonPressed,function(){var e=x.config.embed.settings.share&&x.config.embed.settings.share.embed_only,t=function(){x.events.fire(Ge.showOverlay,"share",e)};return pt.element?void t():void x.performDelegateAction(je.shareOverlay,t)}),x.events.on($e.embedButtonPressed,function(){x.config.embed.settings.share.embed_only&&x.performDelegateAction(je.shareOverlay,function(){x.events.fire(Ge.showOverlay,"share",!0)})})}function h(){function t(){var e=90===Math.abs(window.orientation)?screen.height:screen.width;return kt.mobileAndroid&&!kt.browser.chrome&&!kt.browser.opera&&kt.android>=4&&(e/=window.devicePixelRatio),e/window.innerWidth}function n(e){var t=Math.round(10*Math.pow(e,-1.2));return Math.max(t,10)+"px"}function i(e){var t=Math.round(10*Math.pow(e,-.7));return Math.max(t,10)+"px"}function r(){M.then(function(){var e=t(),r=n(e),o=i(e);return L.style.fontSize=r,O.style.fontSize=o,C.style.fontSize=o,!0}).catch(function(){})}function o(){L.style.fontSize="",O.style.fontSize="",C.style.fontSize=""}x.events.on($e.didEnterFullscreen,o),x.events.on($e.didExitFullscreen,r),I&&(e.classList.add("mobile"),r())}function p(){if(it(window).on("resize",o),"undefined"!=typeof MutationObserver){var t=new MutationObserver(o);t.observe(e,{attributes:!0,attributeFilter:["class"]})}}function v(){function t(){var t=e;if(r&&r.getFullscreenElement&&"function"==typeof r.getFullscreenElement){var n=r.getFullscreenElement();n&&n instanceof HTMLElement&&n.contains(e)&&n.classList.contains("js-player-fullscreen")&&(t=n)}return t}function n(t,n){return s?void(s=!1):void(o||(o=!0,x.events.fire($e.didEnterFullscreen,e===t,a)))}function i(e){return s?void(s=!1):void(o&&(o=!1,x.events.fire($e.didExitFullscreen,a),a||x.events.fire(Ge.toggleNativeControls,!1),a=!1))}x.config.embed.fullscreen=!0,kt.iPad&&e.classList.add("no-fullscreen-api-support"),pt.enabled&&!kt.browser.bb10||kt.iPad||(e.classList.add("no-fullscreen-support"),kt.iOS||(x.config.embed.fullscreen=!1));var o=!1,a=!1,s=!1;x.events.on([$e.pictureInPictureActivated,$e.pictureInPictureDeactivated],function(){s=!0}),x.events.on(Ge.forceFullscreen,function(){return pt.enabled||pt.videoEnabled(e)?(x.events.fire($e.willEnterFullscreen),a=!1,void pt.request(t())):void x.events.fire(Ge.toggleNativeControls,!0)}),x.events.on($e.fullscreenButtonPressed,function(){"picture-in-picture"===x.telecine.presentationMode&&x.events.fire(Ge.deactivatePictureInPicture),pt.element?(x.events.fire($e.willExitFullscreen),pt.exit()):(x.events.fire($e.willEnterFullscreen),a=!0,pt.request(t()))});var c=pt.onenter,u=pt.onexit;if(pt.onenter=function(t){if(!o)return e.contains(t)?void n(t,!0):void("function"==typeof c&&c(t))},pt.onexit=function(){return o?void i(!0):void("function"==typeof u&&u())},it(e).on("click","a",function(e){pt.element===t()&&pt.exit()}),it(e).on("gestureend",function(e){e.scale>1&&x.events.fire($e.fullscreenButtonPressed)}),"undefined"!=typeof MSGesture){var d=1,l=new MSGesture;l.target=e,it(e).on("pointerdown",function(e){l.addPointer(e.pointerId)}).on(["MSGestureChange"],function(e){d*=e.scale}).on(["MSGestureEnd"],function(){(!o&&d>=2||o&&d<1)&&x.events.fire($e.fullscreenButtonPressed),d=1})}}function g(){w(e,"a[data-clip-link]",s),x.events.on(Ge.openVimeo,s)}function m(){u(),d(),f(),h(),p(),v(),g()}function y(){E||(E=new Ce(x,e.querySelector(".overlay-wrapper")))}function _(){P||(P=new Ie(x,{uuid:x.uuid,id:e.id,isMobileDevice:!1}))}function b(){A||(A=new qe(x))}function k(){y(),_(),b(),void new Te(x,L),void new Ee(x,e);var t=new Ae(x,e);void new Me(x,e.querySelector(".notification-wrapper")),void new Le(x,e.querySelector(".outro-wrapper")),void new Re(x,O),void new Fe(x,C),Object.defineProperties(T,{pauseKeyboard:{enumerable:!0,value:t.pause},unpauseKeyboard:{enumerable:!0,value:t.unpause}})}ft.helpers=tt;var S=c(n),x=new we({element:e,delegate:r,cssLoadedPromise:S});e.classList.add("js-player-fullscreen");var T=x.externalApi,E=null,P=null,A=null,M=null,L=e.querySelector(".controls"),O=e.querySelector(".sidedock"),C=e.querySelector(".title"),I=kt.mobileAndroid||kt.iPhone||kt.windowsPhone||kt.browser.bb10,q="normal",R={tiny:$e.enteredTinyMode,mini:$e.enteredMiniMode,normal:$e.enteredNormalMode,none:$e.enteredNormalMode},F={initializationHandler:function(){return k(),m(),He.resolve()},postInitializationHandler:function(){return x.telecine&&void new Pe(x,e.querySelector(".stats-debug")),He.resolve()},authorizationHandler:function(e){e(),y(),_();var t="Error",n="Unhandled video privacy";switch(x.config.view){case Ve.privatePassword:return new He(function(e,t){x.events.fire(Ge.showOverlay,"password"),x.events.once($e.passwordUnlocked,function(t){e(t)})});case Ve.privateLocked:b();var i="private-locked",r=null;return x.config.user.logged_in&&(i="error",r={title:"Vidéo privée",message:"Désolé, vous n’avez pas la permission de regarder.",modal:!0,logo:!!x.config.embed.settings.branding,icon:"lock"}),x.events.fire(Ge.showOverlay,i,r),He.reject();case Ve.error:t=x.config.title,n=x.config.message}return x.events.fire(Ge.showOverlay,"error",{title:t,message:n,modal:!0}),He.reject()}};return x.init(t,F).then(function(){return x.config.view!==Ve.privateUnlocked||x.config.embed.autoplay||x.events.fire(Ge.showOverlay,"private-unlocked"),!0}).catch(function(t){y(),_(),e.classList.remove("loading"),x.events.fire($e.error,"error",{message:"Une erreur est subvenue lors du chargement de cette vidéo.",modal:!0,final:!0})}),T}var De="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Ne=t(function(e){!function(t,n,i){n[t]=n[t]||i(),"undefined"!=typeof e&&e.exports?e.exports=n[t]:"function"==typeof define&&define.amd&&define(function(){return n[t]})}("Promise","undefined"!=typeof De?De:De,function(){function e(e,t){f.add(e,t),l||(l=p(f.drain))}function t(e){var t,n=typeof e;return null==e||"object"!=n&&"function"!=n||(t=e.then),"function"==typeof t&&t}function n(){for(var e=0;e<this.chain.length;e++)i(this,1===this.state?this.chain[e].success:this.chain[e].failure,this.chain[e]);this.chain.length=0}function i(e,n,i){var r,o;try{n===!1?i.reject(e.msg):(r=n===!0?e.msg:n.call(void 0,e.msg),r===i.promise?i.reject(TypeError("Promise-chain cycle")):(o=t(r))?o.call(r,i.resolve,i.reject):i.resolve(r))}catch(e){i.reject(e)}}function r(i){var a,c=this;if(!c.triggered){c.triggered=!0,c.def&&(c=c.def);try{(a=t(i))?e(function(){var e=new s(c);try{a.call(i,function(){r.apply(e,arguments)},function(){o.apply(e,arguments)})}catch(t){o.call(e,t)}}):(c.msg=i,c.state=1,c.chain.length>0&&e(n,c))}catch(e){o.call(new s(c),e)}}}function o(t){var i=this;i.triggered||(i.triggered=!0,i.def&&(i=i.def),i.msg=t,i.state=2,i.chain.length>0&&e(n,i))}function a(e,t,n,i){for(var r=0;r<t.length;r++)!function(r){e.resolve(t[r]).then(function(e){n(r,e)},i)}(r)}function s(e){this.def=e,this.triggered=!1}function c(e){this.promise=e,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function u(t){if("function"!=typeof t)throw TypeError("Not a function");if(0!==this.__NPO__)throw TypeError("Not a promise");this.__NPO__=1;var i=new c(this);this.then=function(t,r){var o={success:"function"!=typeof t||t,failure:"function"==typeof r&&r};return o.promise=new this.constructor(function(e,t){if("function"!=typeof e||"function"!=typeof t)throw TypeError("Not a function");o.resolve=e,o.reject=t}),i.chain.push(o),0!==i.state&&e(n,i),o.promise},this.catch=function(e){return this.then(void 0,e)};try{t.call(void 0,function(e){r.call(i,e)},function(e){o.call(i,e)})}catch(e){o.call(i,e)}}var d,l,f,h=Object.prototype.toString,p="undefined"!=typeof setImmediate?function(e){return setImmediate(e)}:setTimeout;try{Object.defineProperty({},"x",{}),d=function(e,t,n,i){return Object.defineProperty(e,t,{value:n,writable:!0,configurable:i!==!1})}}catch(e){d=function(e,t,n){return e[t]=n,e}}f=function(){function e(e,t){this.fn=e,this.self=t,this.next=void 0}var t,n,i;return{add:function(r,o){i=new e(r,o),n?n.next=i:t=i,n=i,i=void 0},drain:function(){var e=t;for(t=n=l=void 0;e;)e.fn.call(e.self),e=e.next}}}();var v=d({},"constructor",u,!1);return u.prototype=v,d(v,"__NPO__",0,!1),d(u,"resolve",function(e){var t=this;return e&&"object"==typeof e&&1===e.__NPO__?e:new t(function(t,n){if("function"!=typeof t||"function"!=typeof n)throw TypeError("Not a function");t(e)})}),d(u,"reject",function(e){return new this(function(t,n){if("function"!=typeof t||"function"!=typeof n)throw TypeError("Not a function");n(e)})}),d(u,"all",function(e){var t=this;return"[object Array]"!=h.call(e)?t.reject(TypeError("Not an array")):0===e.length?t.resolve([]):new t(function(n,i){if("function"!=typeof n||"function"!=typeof i)throw TypeError("Not a function");var r=e.length,o=Array(r),s=0;a(t,e,function(e,t){o[e]=t,++s===r&&n(o)},i)})}),d(u,"race",function(e){var t=this;return"[object Array]"!=h.call(e)?t.reject(TypeError("Not an array")):new t(function(n,i){if("function"!=typeof n||"function"!=typeof i)throw TypeError("Not a function");a(t,e,function(e,t){n(t)},i)})}),u})}),He=e(Ne),Ve={main:1,privateLocked:2,privateUnlocked:3,privatePassword:4,error:7,contentRating:9},je={like:{will:"willLikeVideo",did:"didLikeVideo"},unlike:{will:"willUnlikeVideo",did:"didUnlikeVideo"},addToWatchLater:{will:"willAddToWatchLater",did:"didAddToWatchLater"},removeFromWatchLater:{will:"willRemoveFromWatchLater",did:"didRemoveFromWatchLater"},purchase:{will:"willOpenVodPurchaseForm",did:"didOpenVodPurchaseForm"},shareOverlay:{will:"willOpenShareOverlay",did:"didOpenShareOverlay"},loginForm:{will:"willOpenLoginForm",did:"didOpenLoginForm"},collectionsOverlay:{will:"willOpenCollectionsOverlay",did:"didOpenCollectionsOverlay"},showOutro:{will:"willShowOutro",did:"didShowOutro"},playLog:{will:"willSendPlayLog",did:"didSendPlayLog"}},ze={"application/vnd.apple.mpegurl":"hls","application/vnd.vimeo.dash+json":"dash","video/mp4":"progressive","video/webm":"progressive","video/x-flv":"progressive"},Ue={h264:"video/mp4",hls:"application/vnd.apple.mpegurl",dash:"application/vnd.vimeo.dash+json",vp6:"video/x-flv",vp8:"video/webm",webm:"video/webm",hds:"application/f4m"},We={HTMLScanner:"html",MediaSourceScanner:"html",SWFScanner:"flash"},Ge={seek:1,changeVolume:3,showOverlay:5,openPopup:6,reset:7,changeLoop:8,changeQuality:9,openVimeo:10,changeColor:11,disableHd:14,disableVolume:15,enableVolume:16,disableCaptions:17,enableCaptions:18,forceFullscreen:19,turnCaptionsOn:20,turnCaptionsOff:21,toggleNativeControls:22,showOutro:23,hideOutro:24,setEffect:25,activatePictureInPicture:26,deactivatePictureInPicture:27},$e={apiError:48,error:49,playInitiated:50,paused:51,played:52,loadProgress:53,playProgress:54,seeked:55,ended:56,bufferStarted:57,bufferEnded:58,volumeChanged:59,qualityChanged:60,targetTimeReached:61,cueChanged:62,streamChanged:63,ranIntoBuffer:64,playbackResumed:65,adaptiveBandwidth:66,resize:67,streamTargetChange:68,forcedQuality:69,fullscreenButtonPressed:100,pauseButtonPressed:101,playButtonPressed:102,hdButtonPressed:103,ccButtonPressed:104,scrubbingStarted:105,scrubbingEnded:106,volumeScrubbingStarted:107,volumeScrubbingEnded:108,controlBarVisibilityChanged:109,sidedockVisibilityChanged:110,menuVisibilityChanged:111,captionsChanged:112,badgePressed:140,willEnterFullscreen:150,didEnterFullscreen:151,willExitFullscreen:152,didExitFullscreen:153,likeButtonPressed:200,watchLaterButtonPressed:201,shareButtonPressed:202,embedButtonPressed:203,vodButtonPressed:205,collectionsButtonPressed:206,overlayOpened:250,overlayClosed:251,overlayCleared:252,overlayCloseButtonPressed:253,facebookButtonPressed:254,twitterButtonPressed:255,tumblrButtonPressed:256,emailButtonPressed:257,embedCodeCopied:258,popupOpened:259,effectButtonPressed:260,debugButtonPressed:261,emailCaptureSubmitted:262,popupClosed:263,mousedOut:300,mousedOver:301,mouseTimeout:302,liked:303,unliked:304,addedToWatchLater:305,removedFromWatchLater:306,userLogIn:307,userLoggedIn:308,userLoggedOut:309,loginFailure:310,colorChanged:311,configChanged:312,passwordUnlocked:313,privateUnlocked:314,enteredTinyMode:315,enteredMiniMode:320,enteredNormalMode:316,signatureExpired:317,requestConfigReloaded:318,embedSettingChanged:319,outroDisplayed:321,outroHidden:322,outroVideoPressed:323,becameActive:324,becameInactive:325,tipped:326,emailCaptureSuccess:327,loadVideo:328,titleModuleReady:350,sidedockModuleReady:351,controlBarModuleReady:352,videoModuleReady:353,overlayModuleReady:354,notificationModuleReady:355,statsModuleReady:356,apiModuleReady:357,analyticsModuleReady:358,ready:359,notificationHidden:400,alertVisibilityChanged:401,airPlayAvailable:500,airPlayNotAvailable:501,airPlayActivated:502,airPlayDeactivated:503,airPlayButtonPressed:504,pictureInPictureAvailable:505,pictureInPictureNotAvailable:506,pictureInPictureActivated:507,pictureInPictureDeactivated:508},Xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},Je=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Ye=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),Ke=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},Qe=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},Ze=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},et=function(){function e(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),tt=Object.freeze({formatVodLabel:g,getDisplayPrice:m,isAvailableInCountry:y,translateFromRequest:_}),nt=t(function(e){!function(){function t(e,t,n){var i="blur"==t||"focus"==t;e.element.addEventListener(t,n,i)}function n(e){e.preventDefault(),e.stopPropagation()}function i(e){return d?d:d=e.matches?e.matches:e.webkitMatchesSelector?e.webkitMatchesSelector:e.mozMatchesSelector?e.mozMatchesSelector:e.msMatchesSelector?e.msMatchesSelector:e.oMatchesSelector?e.oMatchesSelector:u.matchesSelector}function r(e,t,n){if("_root"==t)return n;if(e!==n)return i(e).call(e,t)?e:e.parentNode?(l++,r(e.parentNode,t,n)):void 0}function o(e,t,n,i){h[e.id]||(h[e.id]={}),h[e.id][t]||(h[e.id][t]={}),h[e.id][t][n]||(h[e.id][t][n]=[]),h[e.id][t][n].push(i)}function a(e,t,n,i){if(h[e.id])if(t){if(!i&&!n)return void(h[e.id][t]={});if(!i)return void delete h[e.id][t][n];if(h[e.id][t][n])for(var r=0;r<h[e.id][t][n].length;r++)if(h[e.id][t][n][r]===i){h[e.id][t][n].splice(r,1);break}}else for(var o in h[e.id])h[e.id].hasOwnProperty(o)&&(h[e.id][o]={})}function s(e,t,n){if(h[e][n]){var i,o,a=t.target||t.srcElement,s={},c=0,d=0;l=0;for(i in h[e][n])h[e][n].hasOwnProperty(i)&&(o=r(a,i,p[e].element),o&&u.matchesEvent(n,p[e].element,o,"_root"==i,t)&&(l++,h[e][n][i].match=o,s[l]=h[e][n][i]));for(t.stopPropagation=function(){t.cancelBubble=!0},c=0;c<=l;c++)if(s[c])for(d=0;d<s[c].length;d++){if(s[c][d].call(s[c].match,t)===!1)return void u.cancel(t);if(t.cancelBubble)return}}}function c(e,t,n,i){function r(e){return function(t){s(d,t,e)}}if(this.element){e instanceof Array||(e=[e]),n||"function"!=typeof t||(n=t,t="_root");var c,d=this.id;for(c=0;c<e.length;c++)i?a(this,e[c],t,n):(h[d]&&h[d][e[c]]||u.addEvent(this,e[c],r(e[c])),o(this,e[c],t,n));return this}}function u(e,t){if(!(this instanceof u)){for(var n in p)if(p[n].element===e)return p[n];return f++,p[f]=new u(e,f),p[f]}this.element=e,this.id=t}var d,l=0,f=0,h={},p={};u.prototype.on=function(e,t,n){return c.call(this,e,t,n)},u.prototype.off=function(e,t,n){return c.call(this,e,t,n,!0)},u.matchesSelector=function(){},u.cancel=n,u.addEvent=t,u.matchesEvent=function(){return!0},"undefined"!=typeof e&&e.exports&&(e.exports=u),window.Gator=u}()}),it=e(nt),rt=it.addEvent,ot="undefined"==typeof window.PointerEvent&&"undefined"!=typeof window.MSPointerEvent,at={pointerdown:"MSPointerDown",pointerup:"MSPointerUp",pointercancel:"MSPointerCancel",pointermove:"MSPointerMove",pointerenter:"MSPointerEnter",pointerleave:"MSPointerLeave",pointerover:"MSPointerOver",pointerout:"MSPointerOut"},st="onmspointerenter"in document,ct="onmspointerleave"in document;it.addEvent=function(e,t,n){ot&&at[t]&&(t=at[t]),"transitionend"===t&&(rt(e,"webkitTransitionEnd",n),rt(e,"otransitionend",n)),"mouseenter"===t&&(t="mouseover"),"mouseleave"===t&&(t="mouseout"),"MSPointerEnter"!==t||st||(t="MSPointerOver"),"MSPointerLeave"!==t||ct||(t="MSPointerOut"),rt(e,t,n)},it.matchesEvent=function(e,t,n,i,r){return!("mouseenter"===e||"mouseleave"===e||!st&&"MSPointerEnter"===e||!ct&&"MSPointerLeave"===e)||b(t,n,i,r)};var ut={},dt="en",lt=t(function(e){!function(){var t={};t.templates={},t.render=function(e,n){return t.templates[e]?t.templates[e].call(t,n||{}):""},t.map={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},t.escape=function(e){return e.replace(/[&<>"'\/]/g,function(e){return t.map[e]})},t.helpers={},t.templates.stream_studder=function(e){var t="<h3> ";return t+=this.render("icon_warning")||"",t+=' <span>Having issues? <button class="player-alert-button-link button-link" aria-label="Switch to auto" data-alert-autofocus data-close data-context="suggestion">Switch to Auto</button> for smoother streaming.</span></h3>'},t.templates.threesixty_support_alert=function(e){var t="<h3> ";return t+=this.render("icon_warning")||"",t+=' <span>Looking for 360? See <a href="'+e.faqLink+'">supported browsers</a> for the full experience.<span></h3>'},t.templates.buffer_pattern=function(e){var t='<pattern id="'+e.id+'" patternUnits="userSpaceOnUse" x="0" y="0" width="10" height="10" viewBox="0 0 10 10"><line x1="5" y1="-1" x2="-5" y2="10" stroke-width="2" stroke="#666" stroke-linecap="butt" /><line x1="10" y1="-1" x2="0" y2="10" stroke-width="2" stroke="#666" stroke-linecap="butt" /><line x1="15" y1="-1" x2="5" y2="10" stroke-width="2" stroke="#666" stroke-linecap="butt" /></pattern>';return t},t.templates.compass=function(e){var t='<svg viewBox="0 0 36 36"> ';return t+=1==e.version?' <circle class="compass-background" r="18" cx="18" cy="18"></circle><path class="compass-slice" transform="rotate(-45, 18, 18)" d="M0,0 m18,18 l12,0 A12,12 0 0,0 18,6 z"/><circle fill="none" class="compass-ring" stoke-width="3" r="14.5" cx="18" cy="18"></circle><polygon class="compass-dimple" points="16,3.5 18,1 20,3.5"/> ':' <circle class="compass-background" r="18" cx="18" cy="18"></circle><path class="compass-slice" transform="rotate(-30, 18, 18)" d="M0,0 m18,18 l13,0 A13,13 0 0,0 11.500000000000004,6.741669750802297 z"/><circle class="compass-centercircle" r="3" cx="18" cy="18"></circle><path class="compass-line" stroke-linecap="round" d="M0,18 L36,18 z" /> ',t+="</svg>"},t.templates.content_rating=function(e){var t='<div class="content-rating"><h1>'+e.strings.title+'</h1><p class="subtitle">'+e.strings.subtitle+"</p><p>"+e.strings.update+"</p><button>"+e.strings.watch+'</button><div class="logo">'+e.logo+"</div></div>";return t},t.templates.controlbar=function(e){var t='<button class="play rounded-box state-'+e.playState+'" title="'+e.strings.play+'" data-title-play="'+e.strings.play+'" data-title-pause="'+e.strings.pause+'" aria-label="'+e.strings.play+'"><div class="tiny-bars"><svg width="100%" height="100%" viewBox="0 0 65 40"><defs><clipPath id="rounded-border"><rect height="100%" width="100%" x="0" y="0" rx="5"/></clipPath> ';return t+=this.render("buffer_pattern",{id:"tiny-buffer"})||"",t+=' </defs><g clip-path="url(#rounded-border)"><rect class="buffer hidden" height="3" width="110%" x="0" y="37" fill="url(#tiny-buffer)"/><rect class="loaded" height="3" width="0" x="0" y="37" fill="#666"/><rect class="played fill" height="3" width="0" x="0" y="37"/></g></svg></div><div class="play-icon">',t+=this.render("icon_play")||"",t+='</div><div class="pause-icon">',t+=this.render("icon_pause")||"",t+='</div></button><div class="play-bar rounded-box"><div class="progress"><div class="buffer hidden"><svg width="110%" tabindex="-1"><defs> ',t+=this.render("buffer_pattern",{id:"buffer"})||"",t+=' </defs><rect fill="url(#buffer)" width="100%" height="100%" /></svg></div><div class="loaded',e.rawDuration<60&&(t+=" short-video"),t+='" role="progressbar" aria-label="'+e.strings.loadedBar+'" aria-valuemin="0" aria-valuemax="'+e.rawDuration+'" aria-valuenow="0"></div><div class="played" role="progressbar" aria-label="'+e.strings.playedBar+'" aria-valuemin="0" aria-valuemax="'+e.rawDuration+'" aria-valuenow="0"></div><div class="thumb-preview invisible hidden" role="presentation" aria-hidden="true"><div class="thumb"></div></div><div class="ghost-timecode invisible hidden" role="presentation" aria-hidden="true"><div class="box">00:00</div></div><div class="timecode" role="presentation" aria-hidden="true"><div class="box">'+e.duration+"</div></div></div> ",
e.volume&&(t+=' <div class="volume" role="slider" aria-label="'+e.strings.volume+'" aria-valuemin="0" aria-valuemax="1" tabindex="0"><div></div><div></div><div></div><div></div><div></div></div> '),e.ccButton&&(t+=' <button class="toggle cc '+(e.ccOn?"on":"off")+'" title="'+e.strings.captions+'"> ',t+=this.render("icon_cc")||"",t+=" </button> "),e.hdButton&&(t+=' <button class="hd" title="'+e.strings.hd+'" aria-label="HD"> ',t+=this.render("icon_hd")||"",t+=" </button> "),t+=' <button class="hidden toggle effect off" title="'+e.strings.effect+'"><svg viewBox="0 0 210 200" version="1.1"><g fill="none" fill-rule="evenodd"><circle class="red" fill="#f00" cx="63.5" cy="136.5" r="63.5"/><circle class="blue" fill="#2653ff" cx="146.5" cy="136.5" r="63.5"/><circle class="green" fill="#0f0" cx="104.5" cy="63.5" r="63.5"/></g></svg></button> ',e.airplayButton&&(t+=' <button class="toggle airplay off hidden" title="'+e.strings.airPlay+'" data-title-off="'+e.strings.airPlay+'" data-title-on="'+e.strings.airPlayOff+'" hidden> ',t+=this.render("icon_airplay")||"",t+=" </button> "),t+=' <button class="pip hidden enter" title="'+e.strings.pipEnter+'" data-title-enter="'+e.strings.pipEnter+'" data-title-return="'+e.strings.pipReturn+'" hidden> ',t+=this.render("icon_pip")||"",t+=' </button><button class="fullscreen',e.fullscreenButton||(t+=" only-in-fullscreen"),t+='" title="'+e.strings.enterFullscreen+'" data-title-fullscreen="'+e.strings.enterFullscreen+'" data-title-unfullscreen="'+e.strings.exitFullscreen+'" aria-label="'+e.strings.fullscreen+'"><div class="fullscreen-icon">',t+=this.render("icon_fullscreen")||"",t+='</div><div class="unfullscreen-icon">',t+=this.render("icon_unfullscreen")||"",t+="</div></button> ",e.vimeoLogo.show&&(t+=' <div class="logo"> ',e.vimeoLogo.showLink&&(t+=' <a href="'+e.vimeoLogo.url+'"',e.targetBlank&&(t+=' target="_blank"'),t+=' title="'+e.strings.watchOnVimeo+'" aria-label="'+e.strings.watchOnVimeo+'" data-clip-link> '),t+=this.render("logo")||"",e.vimeoLogo.showLink&&(t+=" </a> "),t+=" </div> "),t+=' <div class="mobile-timecode" role="presentation" aria-hidden="true">'+e.duration+"</div></div> ",e.customLogo&&(t+=' <div class="custom-logo',e.customLogo.sticky&&(t+=" sticky"),t+='" style="width:'+e.customLogo.width+"px;height:"+e.customLogo.height+'px"> ',e.customLogo.showLink&&(t+='<a href="'+e.customLogo.url+'" target="_blank">'),t+=' <img src="'+e.customLogo.img+'" alt=""> ',e.customLogo.showLink&&(t+="</a>"),t+=" </div>"),t+=""},t.templates.controlbar_trailer=function(e){var t='<button class="play trailer rounded-box" title="'+e.strings.playTrailer+'" aria-label="'+e.strings.playTrailer+'"><div><span class="play-icon">';return t+=this.render("icon_play")||"",t+="</span><p>"+e.text+"</p></div></button>",e.vimeoLogo.show&&(t+=' <div class="logo"> ',e.vimeoLogo.showLink&&(t+=' <a href="'+e.vimeoLogo.url+'"',e.targetBlank&&(t+=' target="_blank"'),t+=' title="'+e.strings.watchOnVimeo+'" aria-label="'+e.strings.watchOnVimeo+'" data-clip-link> '),t+=this.render("logo")||"",e.vimeoLogo.showLink&&(t+=" </a> "),t+=" </div>"),t+="",e.customLogo&&(t+=' <div class="custom-logo',e.customLogo.sticky&&(t+=" sticky"),t+='" style="width:'+e.customLogo.width+"px;height:"+e.customLogo.height+'px"> ',e.customLogo.showLink&&(t+='<a href="'+e.customLogo.url+'" target="_blank">'),t+=' <img src="'+e.customLogo.img+'" alt=""> ',e.customLogo.showLink&&(t+="</a>"),t+=" </div>"),t+=""},t.templates.error=function(e){var t='<div class="window-wrapper error"><h1>'+e.title+"</h1> ";return e.message&&(t+=" <p>"+e.message+"</p> "),t+="</div>"},t.templates.help=function(e){var t='<div class="window-wrapper help"><h1>'+e.strings.title+'</h1><dl><div class="volume-up secondary"><dt class="arrow">↑</dt><dd>'+e.strings.volumeUp+'</dd></div><div class="volume-down secondary"><dt class="arrow">↓</dt><dd>'+e.strings.volumeDown+'</dd></div><div class="scrub-forward secondary"><dt class="arrow">→</dt><dd>'+e.strings.scrubForward+'</dd></div><div class="scrub-backwards secondary"><dt class="arrow">←</dt><dd>'+e.strings.scrubBackwards+'</dd></div><div class="like"><dt>L</dt><dd>'+e.strings.like+'</dd></div><div class="share"><dt>S</dt><dd>'+e.strings.share+'</dd></div><div class="watch-later"><dt>W</dt><dd>'+e.strings.watchLater+'</dd></div><div class="toggle-captions"><dt>C</dt><dd>'+e.strings.captions+'</dd></div><div class="toggle-hd"><dt>H</dt><dd>'+e.strings.hd+'</dd></div><div class="fullscreen"><dt>F</dt><dd>'+e.strings.fullscreen+"</dd></div> ";return e.onSite||(t+='<div class="view-on-vimeo"><dt>V</dt><dd>'+e.strings.viewOnVimeo+"</dd></div>"),t+=" </dl></div>"},t.templates.icon_airplay=function(e){var t='<svg class="airplay-icon" viewBox="0 0 44 36" tabindex="-1"><polygon class="fill" points="0,0 44,0 44,27 34.5,27 31,23 40,23 40,4 4,4 4,23 13,23 9.5,27 0,27"/><polygon class="fill" points="7,36 22,18 37,36"/></svg>';return t},t.templates.icon_back=function(e){var t='<svg class="icon-back" viewBox="0 0 64 64" preserveAspectRatio="xMidYMid" tabindex="-1"><path class="fill" d="M0 32l32 32v-20h32l0-24h-32v-20z"/></svg>';return t},t.templates.icon_broken_heart=function(e){var t='<svg class="unlike-icon" viewBox="0 0 110 81" preserveAspectRatio="xMidYMid" tabindex="-1"><path class="fill" d="M82.496 1c-14.594 0-23.198 10.043-25.948 14.48l-6.77 10.727 13.661 8.543-13.661 12.535 5.695 15.348-9.686-15.348 11.389-11.975-11.969-7.402s4.22-14.27 4.621-15.521c.782-2.438.782-2.438-.813-3.289-5.516-2.944-12.608-8.098-21.509-8.098-16.299 0-27.506 15.037-27.506 27.885 0 12.795 12.562 22.558 22.245 27.592 9.186 4.771 30.601 18.349 32.755 24.523 2.154-6.174 23.57-19.752 32.753-24.523 9.684-5.034 22.247-14.797 22.247-27.592 0-12.848-11.208-27.885-27.504-27.885z"/></svg>';return t},t.templates.icon_cc=function(e){var t='<svg viewBox="0 0 20 14" tabindex="-1"><path class="fill" fill-rule="evenodd" clip-rule="evenodd" d="M17 0h-14c-1.657 0-3 1.343-3 3v8c0 1.656 1.343 3 3 3h14c1.657 0 3-1.344 3-3v-8c0-1.657-1.343-3-3-3zm-7.271 8.282c-.145.923-.516 1.686-1.105 2.268-.597.591-1.369.89-2.294.89-1.138 0-2.049-.402-2.706-1.195-.647-.786-.975-1.866-.975-3.215 0-1.458.372-2.603 1.105-3.403.65-.708 1.487-1.067 2.487-1.067 1.33 0 2.321.482 2.947 1.435.34.53.526 1.072.553 1.611l.013.236h-1.984l-.044-.169c-.092-.355-.207-.622-.343-.793-.239-.298-.591-.443-1.076-.443-.483 0-.856.209-1.14.641-.298.455-.449 1.12-.449 1.977 0 .851.156 1.49.466 1.898.298.395.666.588 1.122.588.469 0 .814-.16 1.058-.491.138-.183.255-.472.351-.856l.042-.17h2.013l-.041.258zm7.582 0c-.145.923-.516 1.686-1.104 2.268-.598.591-1.369.89-2.294.89-1.139 0-2.049-.402-2.707-1.195-.646-.785-.975-1.865-.975-3.214 0-1.458.372-2.603 1.106-3.403.649-.708 1.485-1.067 2.486-1.067 1.33 0 2.32.482 2.946 1.435.34.53.526 1.072.554 1.611l.012.236h-1.9829999999999999l-.043-.169c-.092-.355-.208-.623-.344-.793-.238-.298-.591-.443-1.076-.443-.483 0-.856.209-1.139.641-.299.455-.45 1.12-.45 1.977 0 .851.157 1.49.467 1.898.299.395.666.588 1.121.588.469 0 .814-.16 1.058-.491.138-.183.256-.472.352-.856l.042-.17h2.012l-.041.257z"/></svg>';return t},t.templates.icon_clock=function(e){var t='<svg class="watch-later-icon" viewBox="0 0 20 20" preserveAspectRatio="xMidYMid" tabindex="-1"><polyline class="fill hour-hand" points="9.64,4.68 10.56,4.68 11.28,11.21 8.93,11.21 9.64,4.68" /><polyline class="fill minute-hand" points="14.19,13.65 13.7,14.14 8.58,10.4 10.44,8.5 14.19,13.65" /><circle class="stroke" cx="10" cy="10" r="8" stroke-width="2" /></svg>';return t},t.templates.icon_close=function(e){var t='<svg class="icon-close" viewBox="0 0 64 64" preserveAspectRatio="xMidYMid" tabindex="-1"><path class="fill" d="M60 48.796l-16.812-16.796 16.812-16.796-11.204-11.204-16.796 16.804-16.804-16.804-11.196 11.204 16.796 16.796-16.796 16.796 11.196 11.204 16.804-16.804 16.796 16.804z"/></svg>';return t},t.templates.icon_collections=function(e){var t='<svg class="collections-icon" viewBox="0 0 24 24" tabindex="-1"><path class="fill" d="M24 12c0-.3-.1-.6-.4-.8l-2.7-2.3 2.4-1c.4-.1.7-.5.7-.9 0-.3-.1-.6-.4-.8l-7-6c-.1-.1-.4-.2-.6-.2-.1 0-.3 0-.4.1l-15 6c-.3.1-.6.5-.6.9 0 .3.1.6.4.8l2.7 2.3-2.4 1c-.4.1-.7.5-.7.9 0 .3.1.6.4.8l2.7 2.3-2.4 1c-.4.1-.7.5-.7.9 0 .3.1.6.4.8l7 6c.1.1.4.2.6.2.1 0 .3 0 .4-.1l15-6c.4-.1.6-.5.6-.9 0-.3-.1-.6-.4-.8l-2.7-2.3 2.4-1c.4-.1.7-.5.7-.9zm-8.2-9.8l5.3 4.5-12.9 5.1-5.3-4.5 12.9-5.1zm5.3 14.5L8.2 21.8l-5.3-4.5 1.9-.8 2.6 2.2c.1.2.4.3.6.3.1 0 .3 0 .4-.1l10.5-4.2 2.2 2zm-12.9.1l-5.3-4.5 1.9-.8 2.6 2.2c.1.2.4.3.6.3.1 0 .3 0 .4-.1l10.5-4.2 2.3 1.9-13 5.2z"/></svg>';return t},t.templates.icon_embed=function(e){var t='<svg class="embed-icon" viewBox="0 0 55 48" preserveAspectRatio="xMidYMid" tabindex="-1"><polygon class="fill" points="16.019,16.385 11.968,13.131 0,24.543 12.082,35.955 16.132,32.703 7.439,24.543"/><polygon class="fill" points="42.92,13.131 38.868,16.384 47.561,24.542 38.981,32.701 43.033,35.955 55,24.542"/><polygon class="fill" points="24.083,39.221 28.76,39.221 36.243,8.351 31.566,8.351"/></svg>';return t},t.templates.icon_facebook=function(e){var t='<svg class="facebook-icon" viewBox="0 0 64 64" preserveAspectRatio="xMidYMid" tabindex="-1"><path class="fill" d="M35.992 64h-11.992v-32h-8v-11.028l8-0.004-0.013-6.497c0-8.997 2.44-14.471 13.037-14.471h8.824v11.030h-5.514c-4.127 0-4.325 1.541-4.325 4.418l-0.016 5.52h9.918l-1.169 11.028-8.741 0.004-0.008 32z"/></svg>';return t},t.templates.icon_fullscreen=function(e){var t='<svg viewBox="0 0 12 12" preserveAspectRatio="xMidYMid" tabindex="-1"><polyline class="fill" points="6,6 5.9,2 4.9,3 2.9,1 1,2.9 3,4.9 2,5.9" transform="translate(6,6)" /><polyline class="fill" points="6,6 5.9,2 4.9,3 2.9,1 1,2.9 3,4.9 2,5.9" transform="translate(6,6) rotate(90)" /><polyline class="fill" points="6,6 5.9,2 4.9,3 2.9,1 1,2.9 3,4.9 2,5.9" transform="translate(6,6) rotate(180)" /><polyline class="fill" points="6,6 5.9,2 4.9,3 2.9,1 1,2.9 3,4.9 2,5.9" transform="translate(6,6) rotate(270)" /></svg>';return t},t.templates.icon_hd=function(e){var t='<svg viewBox="';return t+=e.notification?"-1 -1 104.717 49.035":"0 0 102.717 47.035",t+='" preserveAspectRatio="xMidYMid" tabindex="-1"><path class="',t+=e.stroke?"stroke":"fill",t+='" d="M100.014 6.758c-1.352-2.162-3.244-3.781-5.676-5.134-2.434-1.083-5.947-1.624-10.274-1.624h-21.625l-7.297 47.035h21.895c2.434 0 5.676-.274 8.92-1.352 2.434-.542 4.596-1.627 7.03-3.785 2.161-1.621 4.324-4.055 5.675-7.028 1.621-2.701 2.973-6.757 3.786-11.623.269-3.244.269-6.487.269-9.19-.54-2.704-1.352-5.138-2.703-7.299zm-12.433 16.76c-.541 3.783-1.352 6.485-2.165 8.109-1.08 1.893-2.162 2.703-3.782 3.514-1.083.541-3.515 1.082-6.217 1.082h-3.517l3.517-25.41h3.782c3.514 0 6.217.811 7.568 2.703 1.083 1.625 1.352 5.135.814 10.002z"/><path class="',t+=e.stroke?"stroke":"fill",t+='" d="M37.572,0L35.14,16.491H19.463L21.895,0H7.027L0,47.035h14.866l2.703-18.922h15.677l-2.971,18.922h14.866L52.439,0H37.572z"/></svg>'},t.templates.icon_heart=function(e){var t='<svg class="like-icon" viewBox="0 0 110 81" preserveAspectRatio="xMidYMid" tabindex="-1"><path class="fill" d="M82.496 1c-14.698 0-25.969 11.785-27.496 13.457-1.526-1.672-12.798-13.457-27.494-13.457-16.299 0-27.506 15.037-27.506 27.885 0 12.795 12.562 22.558 22.245 27.592 9.186 4.771 30.601 18.349 32.755 24.523 2.154-6.174 23.57-19.752 32.755-24.523 9.684-5.034 22.245-14.797 22.245-27.592 0-12.848-11.206-27.885-27.504-27.885z"/></svg>';return t},t.templates.icon_lock=function(e){var t='<svg viewBox="0 0 46 76" preserveAspectRatio="xMidYMid" tabindex="-1"><path class="fill bolt" d="M5,42v-15C8,5 39,5 42,27v30h-7v-30C32,14 15,14 12,27v15z"/><rect class="fill" x="0" y="41" height="35" width="46" rx="4" ry="4"/></svg>';return t},t.templates.icon_mail=function(e){var t='<svg class="mail-icon" viewBox="0 0 72 72" preserveAspectRatio="xMidYMid" tabindex="-1"><path class="fill" d="M71.754,57.6C71.9,57.169,72,56.718,72,56.241V16.759c0-0.453-0.092-0.881-0.225-1.291l-23.487,19.86L71.754,57.6z"/><path class="fill" d="M35.999,40.118l6.187-4.971l3.131-2.516L68.9,12.693c-0.387-0.113-0.789-0.193-1.213-0.193H4.312c-0.424,0-0.827,0.08-1.215,0.194l23.599,19.949l3.132,2.517L35.999,40.118z"/><path class="fill" d="M67.688,60.5c0.405,0,0.791-0.074,1.164-0.18L45.157,37.843l-9.159,7.361l-9.145-7.351L3.15,60.322C3.522,60.426,3.907,60.5,4.312,60.5H67.688z"/><path class="fill" d="M0.226,15.468C0.092,15.878,0,16.307,0,16.759v39.482c0,0.478,0.099,0.929,0.247,1.356l23.476-22.261L0.226,15.468z"/></svg>';return t},t.templates.icon_pause=function(e){var t='<svg viewBox="0 0 20 20" preserveAspectRatio="xMidYMid" tabindex="-1"><rect class="fill" width="6" height="20" x="0" y="0" /><rect class="fill" width="6" height="20" x="12" y="0" /></svg>';return t},t.templates.icon_play=function(e){var t='<svg viewBox="0 0 20 20" preserveAspectRatio="xMidYMid" tabindex="-1"><polygon class="fill" points="1,0 20,10 1,20" /></svg>';return t},t.templates.icon_share=function(e){var t='<svg class="share-icon" viewBox="0 0 20 20" preserveAspectRatio="xMidYMid" tabindex="-1"><polygon class="fill" points="20,0 0,12 5,15 17,4 7,16 7,19 9,17 14,20"/></svg>';return t},t.templates.icon_tumblr=function(e){var t='<svg class="tumblr-icon" viewBox="0 0 12 20" tabindex="-1"><path class="fill" d="M7.865,19.958 C3.629,19.958 2.02,16.834 2.02,14.627 L2.02,8.105 L0,8.105 L0,5.527 C3.027,4.436 3.756,1.705 3.927,0.149 C3.938,0.042 4.022,0 4.07,0 L6.994,0 L6.994,5.084 L10.987,5.084 L10.987,8.105 L6.979,8.105 L6.979,14.318 C6.993,15.149 7.291,16.287 8.815,16.287 C8.843,16.287 8.872,16.287 8.9,16.286 C9.43,16.272 10.14,16.118 10.511,15.941 L11.471,18.788 C11.11,19.317 9.481,19.932 8.015,19.957 C7.964,19.958 7.915,19.958 7.865,19.958"/></svg>';return t},t.templates.icon_twitter=function(e){var t='<svg class="twitter-icon" viewBox="0 0 274 223" preserveAspectRatio="xMidYMid" tabindex="-1"><path class="fill" d="M85.98,222 C54.305,222 24.822,212.715 0,196.801 C4.388,197.319 8.853,197.584 13.38,197.584 C39.658,197.584 63.843,188.617 83.039,173.574 C58.495,173.121 37.781,156.905 30.644,134.621 C34.068,135.276 37.582,135.627 41.196,135.627 C46.312,135.627 51.267,134.942 55.974,133.66 C30.314,128.508 10.981,105.838 10.981,78.662 C10.981,78.426 10.981,78.191 10.985,77.957 C18.548,82.158 27.196,84.681 36.391,84.972 C21.341,74.914 11.438,57.746 11.438,38.287 C11.438,28.008 14.204,18.373 19.032,10.089 C46.696,44.023 88.025,66.353 134.641,68.692 C133.685,64.587 133.188,60.306 133.188,55.91 C133.188,24.935 158.302,-0.178 189.279,-0.178 C205.411,-0.178 219.988,6.634 230.22,17.535 C242.996,15.019 255,10.351 265.837,3.924 C261.649,17.021 252.756,28.013 241.175,34.955 C252.521,33.599 263.331,30.584 273.39,26.123 C265.87,37.371 256.36,47.25 245.402,55.158 C245.51,57.563 245.564,59.982 245.564,62.414 C245.564,136.533 189.148,222 85.98,222"/></svg>';return t},t.templates.icon_unfullscreen=function(e){var t='<svg viewBox="0 0 12 12" preserveAspectRatio="xMidYMid" tabindex="-1"><polyline class="fill" points="-1,-1 -1.1,-5 -2.1,-4 -4.1,-6 -6,-4.1 -4,-2.1 -5,-1.1" transform="translate(6,6) "/><polyline class="fill" points="-1,-1 -1.1,-5 -2.1,-4 -4.1,-6 -6,-4.1 -4,-2.1 -5,-1.1" transform="translate(6,6) rotate(90)" /><polyline class="fill" points="-1,-1 -1.1,-5 -2.1,-4 -4.1,-6 -6,-4.1 -4,-2.1 -5,-1.1" transform="translate(6,6) rotate(180)" /><polyline class="fill" points="-1,-1 -1.1,-5 -2.1,-4 -4.1,-6 -6,-4.1 -4,-2.1 -5,-1.1" transform="translate(6,6) rotate(270)" /></svg>';return t},t.templates.icon_vod=function(e){var t='<svg class="vod-icon" viewBox="0 0 21 23" tabindex="-1"><path class="fill" d="M19.602,4.716l-7.665-4.385C11.169-0.108,9.91-0.111,9.139,0.327L1.4,4.721C0.63,5.158,0,6.234,0,7.112v8.776c0,0.878,0.63,1.955,1.398,2.393l0.526,0.3l7.176,4.09c0.77,0.438,2.028,0.438,2.798,0l7.702-4.39c0.77-0.438,1.4-1.516,1.4-2.393V7.112C21,6.234,20.37,5.156,19.602,4.716z M7.336,15.761L7.337,7.24l8.008,4.26L7.336,15.761z"/></svg>';return t},t.templates.icon_check=function(e){var t='<svg class="check-icon" viewBox="0 0 12 12"><path class="fill" d="M10.9 2.9l-.7-.7c-.2-.2-.6-.2-.8-.1L5 6.6 2.6 4.1c-.2-.1-.6-.1-.7 0l-.8.8c-.1.1-.1.5 0 .7l3.1 3.1c.4.4 1 .4 1.4 0l5.1-5.1c.3-.2.3-.6.2-.7z"/></svg>';return t},t.templates.icon_pip=function(e){var t='<svg class="pip-icon" viewBox="0 0 16 12"><polygon class="fill" points="6 8 1 8 1 1 14 1 14 6 15 6 15 0 0 0 0 9 6 9 6 8"/><rect class="fill" x="7" y="7" width="9" height="5"/><polyline class="fill enter" transform="translate(4, 4) rotate(180) translate(-4, -4)" points="5.33 2 5.33 3 3.67 3 5.67 5 5 5.67 3 3.67 3 5.33 2 5.33 2 2"/><polyline class="fill return" points="5.33 2 5.33 3 3.67 3 5.67 5 5 5.67 3 3.67 3 5.33 2 5.33 2 2"/></svg>';return t},t.templates.icon_vod_download=function(e){var t='<svg class="vod-download-icon" viewBox="0 0 32 32" tabindex="-1"><path class="fill" d="M21.707 24.707l-5 5c-.39.39-1.024.39-1.414 0l-5-5c-.39-.39-.39-1.024 0-1.414l1.06-1.06c.392-.392 1.025-.392 1.415 0L14 23.462V15c0-.552.448-1 1-1h2c.552 0 1 .448 1 1v8.464l1.232-1.232c.39-.39 1.024-.39 1.414 0l1.06 1.06c.392.39.392 1.025 0 1.415z"/><path class="fill" d="M27.894 12.31c.063-.43.106-.864.106-1.31 0-4.97-4.03-9-9-9-3.6 0-6.7 2.12-8.138 5.175C10.175 6.75 9.368 6.5 8.5 6.5 6.015 6.5 4 8.515 4 11c0 .445.067.874.187 1.28C1.76 13.05 0 15.318 0 18c0 3.314 2.686 6 6 6h1c0-2.42 1.718-4.436 4-4.9V15c0-2.21 1.79-4 4-4h2c2.21 0 4 1.79 4 4v4.1c2.282.464 4 2.48 4 4.9h1c3.314 0 6-2.686 6-6 0-2.65-1.72-4.896-4.106-5.69z"/></svg>';return t},t.templates.icon_vod_rent=function(e){var t='<svg class="vod-rent-icon" viewBox="0 0 32 32" tabindex="-1"><path class="fill" d="M23 11H9c-.552 0-1 .448-1 1v8c0 .552.448 1 1 1h14c.552 0 1-.448 1-1v-8c0-.552-.448-1-1-1z"/><path class="fill" d="M32 22V10c-2.76 0-5-2.24-5-5H5c0 2.76-2.24 5-5 5v12c2.76 0 5 2.24 5 5h22c0-2.76 2.24-5 5-5zm-6-1c0 1.105-.895 2-2 2H8c-1.105 0-2-.895-2-2V11c0-1.105.895-2 2-2h16c1.105 0 2 .895 2 2v10z"/></svg>';return t},t.templates.icon_vod_subscribe=function(e){var t='<svg class="vod-subscribe-icon" viewBox="0 0 32 32" tabindex="-1"><path class="fill" d="M20 9v2c0 .552.448 1 1 1h10c.552 0 1-.448 1-1V1c0-.552-.448-1-1-1h-2c-.552 0-1 .448-1 1v4.445C24.98 2.01 20.523-.128 15.558.005 7.293.23.413 6.96.018 15.216-.42 24.41 6.905 32 16 32c8.47 0 15.404-6.583 15.964-14.912.04-.585-.413-1.088-1-1.088H28.96c-.514 0-.956.388-.994.9C27.506 23.107 22.326 28 16 28 9.217 28 3.748 22.37 4.01 15.53 4.246 9.284 9.47 4.147 15.72 4.003 19.38 3.92 22.674 5.483 24.926 8H21c-.552 0-1 .448-1 1z"/><path class="fill" d="M13 20v-8l8 4"/></svg>';return t},t.templates.icon_warning=function(e){var t='<svg class="warning-icon" tabindex="-1" width="36" height="32.326" viewBox="287.915 380.297 36 32.326"><path d="M309.646 382.963c-2.052-3.555-5.41-3.555-7.462 0L288.79 406.16c-2.05 3.555-.372 6.463 3.732 6.463h26.786c4.104 0 5.783-2.908 3.73-6.463l-13.392-23.197zm-2 23.224c0 .983-.804 1.788-1.788 1.788-.983 0-1.788-.805-1.788-1.788 0-.984.805-1.79 1.788-1.79s1.79.805 1.788 1.79zm-.317-7.76c-.254 2.604-.916 4.735-1.472 4.735-.557 0-1.22-2.13-1.477-4.735-.255-2.604-.464-5.72-.464-6.925 0-1.204.87-2.19 1.935-2.19 1.066 0 1.936.986 1.936 2.19s-.205 4.32-.457 6.925z"/></svg>';return t},t.templates.logo=function(e){var t='<svg viewBox="0 0 140 40" preserveAspectRatio="xMidYMid" role="img" aria-label="Vimeo" tabindex="-1"><title>Vimeo</title><g><path class="fill logo-v" d="M31.277 18.832c-.14 3.052-2.27 7.229-6.39 12.531-4.259 5.536-7.863 8.306-10.811 8.306-1.825 0-3.371-1.687-4.633-5.059l-2.529-9.275c-.938-3.372-1.943-5.06-3.019-5.06-.234 0-1.054.494-2.458 1.477l-1.474-1.901c1.546-1.358 3.071-2.717 4.572-4.078 2.062-1.783 3.609-2.72 4.642-2.814 2.438-.234 3.938 1.433 4.502 5.001.608 3.851 1.03 6.246 1.266 7.182.704 3.195 1.476 4.791 2.321 4.791.657 0 1.641-1.037 2.954-3.108 1.312-2.072 2.015-3.649 2.109-4.732.188-1.789-.516-2.686-2.109-2.686-.75 0-1.522.173-2.318.514 1.54-5.044 4.481-7.495 8.823-7.355 3.22.095 4.737 2.184 4.552 6.266z"/><path class="fill logo-i" d="M50.613 28.713c-1.313 2.484-3.119 4.733-5.417 6.748-3.143 2.718-6.285 4.076-9.425 4.076-1.456 0-2.57-.469-3.343-1.406-.773-.938-1.137-2.153-1.09-3.653.045-1.548.526-3.938 1.441-7.173.914-3.232 1.373-4.967 1.373-5.201 0-1.218-.423-1.828-1.266-1.828-.282 0-1.079.494-2.393 1.477l-1.618-1.901c1.501-1.358 3.001-2.717 4.502-4.078 2.017-1.783 3.518-2.72 4.504-2.814 1.546-.14 2.684.314 3.411 1.367.726 1.052.996 2.417.81 4.098-.61 2.852-1.268 6.472-1.972 10.864-.046 2.01.681 3.014 2.182 3.014.656 0 1.827-.693 3.518-2.083 1.406-1.156 2.555-2.243 3.447-3.262l1.336 1.755zm-6.12-25.016c-.047 1.168-.633 2.288-1.76 3.361-1.266 1.212-2.767 1.82-4.501 1.82-2.672 0-3.963-1.166-3.869-3.499.045-1.213.76-2.381 2.144-3.501 1.384-1.119 2.919-1.68 4.609-1.68.984 0 1.805.387 2.462 1.155.656.772.961 1.553.915 2.344z"/><path class="fill logo-m" d="M94.543 28.713c-1.314 2.484-3.117 4.733-5.416 6.748-3.145 2.718-6.285 4.076-9.426 4.076-3.051 0-4.527-1.687-4.432-5.06.045-1.501.338-3.306.877-5.415.539-2.108.832-3.748.879-4.921.049-1.779-.492-2.673-1.623-2.673-1.223 0-2.682 1.456-4.375 4.362-1.788 3.05-2.754 6.003-2.894 8.861-.095 2.02.103 3.568.592 4.645-3.272.096-5.565-.444-6.873-1.617-1.171-1.032-1.708-2.742-1.614-5.135.045-1.501.276-3.001.69-4.502.414-1.5.644-2.837.69-4.011.095-1.734-.54-2.604-1.9-2.604-1.177 0-2.444 1.339-3.806 4.011-1.361 2.673-2.113 5.465-2.253 8.371-.094 2.627.074 4.456.503 5.486-3.219.096-5.505-.582-6.857-2.035-1.122-1.214-1.634-3.06-1.539-5.54.044-1.214.258-2.911.645-5.084.386-2.175.603-3.87.647-5.087.093-.841-.119-1.263-.633-1.263-.281 0-1.079.475-2.393 1.424l-1.687-1.901c.234-.184 1.71-1.545 4.432-4.078 1.969-1.828 3.306-2.766 4.009-2.812 1.219-.095 2.204.409 2.954 1.511s1.126 2.38 1.126 3.834c0 .469-.047.915-.14 1.336.703-1.077 1.523-2.017 2.463-2.814 2.156-1.874 4.572-2.931 7.245-3.166 2.298-.187 3.938.352 4.925 1.617.795 1.033 1.17 2.511 1.125 4.433.329-.28.681-.586 1.056-.915 1.078-1.267 2.133-2.273 3.164-3.023 1.736-1.267 3.541-1.97 5.418-2.112 2.25-.187 3.867.35 4.852 1.611.844 1.028 1.219 2.5 1.127 4.415-.047 1.309-.363 3.213-.949 5.712-.588 2.501-.879 3.936-.879 4.31-.049.982.047 1.659.279 2.034.236.373.797.559 1.689.559.656 0 1.826-.693 3.518-2.083 1.406-1.156 2.555-2.243 3.447-3.262l1.337 1.757z"/><path class="fill logo-e" d="M120.922 28.642c-1.361 2.249-4.033 4.495-8.02 6.743-4.971 2.856-10.012 4.284-15.125 4.284-3.797 0-6.52-1.267-8.16-3.797-1.172-1.735-1.734-3.797-1.688-6.189.045-3.797 1.736-7.407 5.064-10.832 3.658-3.75 7.973-5.627 12.945-5.627 4.596 0 7.033 1.873 7.314 5.615.188 2.384-1.125 4.842-3.938 7.368-3.004 2.76-6.781 4.515-11.328 5.263.842 1.169 2.109 1.752 3.799 1.752 3.375 0 7.059-.855 11.045-2.574 2.859-1.207 5.111-2.461 6.754-3.76l1.338 1.754zm-15.969-7.345c.045-1.259-.469-1.89-1.547-1.89-1.406 0-2.83.969-4.283 2.906-1.451 1.936-2.201 3.789-2.248 5.562-.025 0-.025.305 0 .911 2.295-.839 4.287-2.122 5.971-3.849 1.357-1.491 2.06-2.707 2.107-3.64z"/><path class="fill logo-o" d="M140.018 23.926c-.189 4.31-1.781 8.031-4.783 11.169-3.002 3.137-6.73 4.706-11.186 4.706-3.705 0-6.52-1.195-8.441-3.585-1.404-1.777-2.182-4.001-2.32-6.668-.236-4.029 1.217-7.729 4.361-11.101 3.377-3.746 7.619-5.618 12.732-5.618 3.281 0 5.766 1.102 7.457 3.301 1.594 2.015 2.32 4.614 2.18 7.796zm-7.95-.264c.047-1.269-.129-2.434-.527-3.49-.4-1.057-.975-1.587-1.725-1.587-2.391 0-4.361 1.293-5.906 3.877-1.316 2.115-2.02 4.371-2.111 6.766-.049 1.176.164 2.21.633 3.104.514 1.032 1.242 1.549 2.182 1.549 2.109 0 3.914-1.244 5.416-3.735 1.267-2.068 1.945-4.23 2.038-6.484z"/></g></svg>';return t},t.templates.outer=function(e){var t='<div class="video-wrapper"><div class="video"><div class="telecine"></div></div></div><div class="target"></div><div class="captions hidden with-controls" hidden aria-live="assertive"><span></span></div><div class="outro-wrapper hidden" hidden><div class="outro" role="dialog" aria-live="assertive"></div></div><div class="controls-wrapper"><div class="title" role="contentinfo"></div><div class="controls"></div><div class="sidedock hidden" role="toolbar" hidden></div></div><div class="overlay-wrapper hidden" hidden><div class="overlay-cell"><div class="overlay" role="dialog" aria-live="assertive"></div><div class="overlay-icon-wrapper hidden"><div class="overlay-icon"></div></div><div class="overlay-logo logo"></div></div><nav><button class="back cloaked" aria-label="'+e.strings.back+'">';return t+=this.render("icon_back")||"",t+='</button><button class="close" aria-label="'+e.strings.close+'">',t+=this.render("icon_close")||"",t+='</button></nav></div><div class="notification-wrapper hidden" hidden><div class="notification-cell"><div class="notification" role="dialog" aria-live="assertive"></div></div></div><div class="stats-debug rounded-box hidden" aria-hidden="true" hidden></div>'},t.templates.outro_image=function(e){var t="<div> ";return e.url&&(t+='<a href="'+e.url+'" target="_blank">'),t+='<img src="'+e.svg_url+'" class="outro-image">',e.url&&(t+="</a>"),t+="</div>"},t.templates.outro_link=function(e){var t='<h1><a href="'+e.url+'" target="_blank">'+(e.text?e.text:e.url)+"</a></h1>";return t},t.templates.outro_text=function(e){var t='<div class="text-wrapper"><div class="text">'+e.text+"</div></div>";return t},t.templates.outro_videos=function(e){for(var t="",n=0,i=e.contexts.length;n<i;n++){t+="";var r=e.contexts[n];t+='<div class="video-section',r.promoted&&(t+=" promoted"),t+='" data-videos="'+r.videos.length+'"><div><h1>'+r.context+'</h1><ul class="videos"> ';for(var o=0,a=r.videos.length;o<a;o++)t+=' <li><a href="'+r.videos[o].url+'"',e.target&&(t+=' target="_blank"'),t+=" title=\"'",t+=this.escape(r.videos[o].title)||"",t+="'",r.videos[o].owner.id!==e.owner&&(t+=" from ",t+=this.escape(r.videos[o].owner.name)||""),t+='" data-video-id="'+r.videos[o].id+'"><div class="img-wrapper"><img src="'+r.videos[o].thumbnail+'" alt="" width="295" height="166"></div><div class="header-wrapper"><header><h1>',t+=this.escape(r.videos[o].title)||"",t+="</h1> ",r.videos[o].owner.id!==e.owner&&(t+=" <h2><span>from</span>&nbsp;",t+=this.escape(r.videos[o].owner.name)||"",t+="</h2> "),t+=" </header></div></a> ";t+=" </ul></div></div>"}return t+=""},t.templates.outro_vod=function(e){var t='<div class="vod-wrapper"><h1 class="vod-header"><a href="'+e.url+'" target="_blank">';t+=this.escape(e.title)||"",t+="</a></h1> ";var n=e.countries,i=e.country;if(this.helpers.isAvailableInCountry(n,i))if(e.purchased)t+=' <a class="vod-watch-button" role="button" href="'+e.url+'" target="_blank">'+e.strings.watch+"</a> ";else{if(!e.isComingSoon){t+=' <ul class="vod"> ';for(var r=0,o=e.buttons.length;r<o;r++){t+=' <li><a class="vod-button '+e.buttons[r].type+'" role="button" href="'+e.url+"#buy="+e.buttons[r].product_id+'" target="_blank" data-product-id="'+e.buttons[r].product_id+'" role="button"><div class="icon"> ',t+="buy"===e.buttons[r].type?this.render("icon_vod_download")||"":"rent"===e.buttons[r].type?this.render("icon_vod_rent")||"":"subscribe"===e.buttons[r].type?this.render("icon_vod_subscribe")||"":this.render("icon_vod")||"",t+=" </div> ";var a=e.currency,s=e.buttons[r];t+=" <p>"+this.helpers.formatVodLabel(e.translationMap,"outro_string",a,s)+"</p></a></li> "}t+=" </ul> "}(e.isPreorder||e.isComingSoon)&&(t+=" <p>"+e.strings.preRelease+"</p> ")}return t+="</div>"},t.templates.overlay_email_capture=function(e){var t='<div class="window-wrapper email-capture form"><div class="email-capture-form"><h1>'+e.text+'</h1><p class="subtitle">'+e.subtitle+'</p><form action="'+e.action+'" method="post" novalidate><div class="validation-bubble hidden"><div class="validation-bubble-arrow-clipper"><div class="validation-bubble-arrow"></div></div><div class="validation-bubble-message"></div></div><input type="email" name="email" placeholder="'+e.strings.email+'" aria-label="'+e.strings.email+'" required aria-required="true"><input type="text" name="name" placeholder="'+e.strings.fullName+'" aria-label="'+e.strings.fullName+'" maxlength="180"><input type="hidden" name="referrer" value="'+e.referrer+'"><input type="hidden" name="signature" value=""><input type="hidden" name="time" value=""><input type="hidden" name="expires" value=""><input type="submit" value="'+e.strings.submit+'"></form></div><div class="email-capture-confirm hidden"><div class="check-icon-wrapper">';return t+=this.render("icon_check")||"",t+="</div><h1>"+e.confirmation+"</h1></div></div>"},t.templates.password=function(e){var t='<div class="window-wrapper password form"><h1>'+e.strings.title+'</h1><p class="subtitle">'+e.strings.subtitle+'</p><form action="'+e.action+'" method="post" novalidate><div class="validation-bubble hidden"><div class="validation-bubble-arrow-clipper"><div class="validation-bubble-arrow"></div></div><div class="validation-bubble-message"></div></div><input type="password" name="password" placeholder="'+e.strings.password+'" required aria-required="true" aria-label="'+e.strings.password+'"><input type="submit" value="'+e.strings.watch+'"></form></div>';return t},t.templates.private_locked=function(e){var t='<div class="window-wrapper login"><h1>'+e.strings.title+'</h1><p class="subtitle">'+e.strings.subtitle+'</p><a href="'+e.action+'" class="popup" target="_blank" role="button" aria-label="'+e.strings.logInLabel+'">'+e.strings.logIn+"</a></div>";return t},t.templates.private_unlocked=function(e){var t='<div class="window-wrapper form unlocked"><h1>'+e.strings.title+'</h1><p class="subtitle">'+e.strings.subtitle+"</p><button>"+e.strings.watch+"</button></div>";return t},t.templates.share=function(e){var t='<div class="share-wrapper"><section class="share-screen'+(e.embedOnly?" cloaked":"")+'"><h1>'+e.strings.share+'</h1><ul class="buttons"><li><a href="'+e.playerShareUrl+'/facebook" target="_blank" class="facebook" title="'+e.strings.facebook+'" role="button" aria-label="'+e.strings.facebook+'">';return t+=this.render("icon_facebook")||"",t+='</a><li><a href="'+e.playerShareUrl+'/twitter" target="_blank" class="twitter" title="'+e.strings.twitter+'" role="button" aria-label="'+e.strings.twitter+'">',t+=this.render("icon_twitter")||"",t+='</a><li><a href="'+e.playerShareUrl+'/tumblr" target="_blank" class="tumblr" title="'+e.strings.tumblr+'" role="button" aria-label="'+e.strings.tumblr+'">',t+=this.render("icon_tumblr")||"",t+="</a> ",e.url&&(t+=' <li><a href="mailto:?subject=',t+=encodeURIComponent(e.strings.emailSubject)||"",t+="&amp;body=",t+=encodeURIComponent(e.strings.emailBody)||"",t+='" class="email" title="'+e.strings.email+'" role="button" aria-label="'+e.strings.email+'">',t+=this.render("icon_mail")||"",t+="</a> "),t+=" </ul> ",e.embed&&(t+=' <ul class="buttons"><li><a href="'+e.url+'#share" target="_blank" class="embed" title="'+e.strings.embedCode+'" role="button" aria-label="'+e.strings.embedCode+'">',t+=this.render("icon_embed")||"",t+="</a></li></ul> "),e.url&&(t+=' <p class="footnote share"><a class="clip_url" href="'+e.shareUrl+'" target="_blank">'+e.shareUrl+"</a></p> "),t+=" </section> ",e.embed&&(t+=' <section class="embed-screen'+(e.embedOnly?"":" cloaked")+'"><div class="embed-wrapper"><h1>'+e.strings.embedTitle+'</h1><p class="subtitle">'+e.strings.embedSubtitle+'</p><div class="embed-code form"><div><input type="text" name="embed_code" title="Embed code" value="'+e.embedCode+'" spellcheck="false" aria-readonly="true"',e.readOnly&&(t+=" readonly"),t+="></div> ",e.copyButton&&(t+=' <button class="embed-copy" data-clipboard-text=\''+e.embedCode+"' data-label=\""+e.strings.copy+'" data-success-label="'+e.strings.copySuccess+'">'+e.strings.copy+"</button> "),t+=" </div> ",e.customizeEmbed&&(t+=' <p class="footnote">'+e.strings.customize+"</p> "),t+=" </div></section> "),t+="</div>"},t.templates.sidedock=function(e){var t="";return e.vodButton&&(t+=' <div class="box" data-vod-expiring="'+e.vodPurchaseInfo.expiring+'" data-vod-purchased="'+e.purchased+'"><button class="vod-button rounded-box',e.purchased&&(t+=" on"),e.vodPurchaseInfo.expiring&&(t+=" expiring"),t+='" data-product-id="'+e.vodPurchaseInfo.product_id+'"><div class="vod-button-inner"><span class="vod-label">'+e.vodDisplayLabel+"</span> ",
t+=this.render("icon_vod")||"",t+=' </div></button></div><div class="sidedock-inner">'),e.likeButton&&(t+=' <div class="box"><label class="rounded-box hidden like-label" role="presentation"><span>'+(e.liked?e.strings.unlike:e.strings.like)+'</span></label><button class="like-button rounded-box',e.liked&&(t+=" on"),t+='" aria-label="',t+=e.loggedOut?""+e.strings.likeLoggedOut:""+(e.liked?e.strings.unlike:e.strings.like),t+='" data-label-add="'+e.strings.like+'" data-label-add-logged-out="'+e.strings.likeLoggedOut+'" data-label-remove="'+e.strings.unlike+'"> ',t+=this.render("icon_heart")||"",t+=" </button></div>"),e.watchLaterButton&&(t+=' <div class="box"><label class="rounded-box hidden watch-later-label" role="presentation"><span>'+(e.addedToWatchLater?e.strings.watchLaterRemove:e.strings.watchLaterAdd)+'</span></label><button class="watch-later-button rounded-box',e.addedToWatchLater&&(t+=" on"),t+='" aria-label="',t+=e.loggedOut?""+e.strings.watchLaterLoggedOut:""+(e.addedToWatchLater?e.strings.watchLaterRemove:e.strings.watchLaterAdd),t+='" data-label-add="'+e.strings.watchLaterAdd+'" data-label-add-logged-out="'+e.strings.watchLaterAddLoggedOut+'" data-label-remove="'+e.strings.watchLaterRemove+'"> ',t+=this.render("icon_clock")||"",t+=" </button></div>"),e.collectionsButton&&(t+=' <div class="box"><label class="rounded-box hidden collections-label" role="presentation"><span>'+e.strings.collections+'</span></label><button class="collections-button rounded-box" aria-label="'+e.strings.collections+'"> ',t+=this.render("icon_collections")||"",t+=" </button></div>"),e.shareButton&&(t+=' <div class="box"><label class="rounded-box hidden share-label" role="presentation"><span>'+e.strings.share+'</span></label><button class="share-button rounded-box" aria-label="'+e.strings.share+'"> ',t+=this.render("icon_share")||"",t+=" </button></div>"),e.vodButton&&(t+=" </div>"),t+=""},t.templates.stats_debug=function(e){var t='<p><span class="stats-debug-label">Clip ID:</span><span class="stats-debug-value stats-debug-clip-id">'+e.clipId+"</span></p>";return e.displayProfile&&(t+='<p><span class="stats-debug-label">Profile ID:</span><span class="stats-debug-value stats-debug-profile-id">'+e.profileId+"</span></p>"),t+='<p><span class="stats-debug-label">Delivery:</span><span class="stats-debug-value stats-debug-delivery">'+e.delivery+'</span></p><p><span class="stats-debug-label">Playing:</span><span class="stats-debug-value stats-debug-resolution">'+e.resolution+'</span></p><p><span class="stats-debug-label">Embed size:</span><span class="stats-debug-value stats-debug-dimensions">'+e.dimensions+'</span></p><p><span class="stats-debug-label">CDN:</span><span class="stats-debug-value stats-debug-cdn">'+e.cdn+"</span></p>",e.displayAudioVideoStream&&(t+='<p><span class="stats-debug-label">Separate AV:</span><span class="stats-debug-value stats-debug-test-group">'+e.separateAudioVideo+"</span></p>"),t+="",e.testGroup&&(t+='<p><span class="stats-debug-label">Tests:</span><span class="stats-debug-value stats-debug-test-group">'+e.testGroup+"</span></p>"),t+="",e.displayDroppedFrames&&(t+='<p><span class="stats-debug-label">Dropped frames:</span><span class="stats-debug-value stats-debug-dropped-frames">0 / 0</span></p>'),t+="",e.displayBandwidth&&(t+='<p><span class="stats-debug-label">Bandwidth:</span><span class="stats-debug-value stats-debug-bandwidth">0 Kbps</span><span class="stats-debug-bandwidth-minmax"> (<span class="stats-debug-value stats-debug-bandwidth-min"></span><span class="stats-debug-value stats-debug-bandwidth-max"></span>) </span></p><div class="stats-debug-time-series"></div>'),t+='<button class="stats-debug-close" aria-label="Close stats debug panel">',t+=this.render("icon_close")||"",t+='</button><input type="text" class="stats-debug-code"><a href="javascript:void(0)" class="stats-debug-copy" target="_blank">Open link</a>'},t.templates.threesixty_instruct=function(e){var t='<div class="intro-wrap'+(e.textOnly?" text-only":" big")+'"> ';return t+=e.textOnly?" <span>Click and drag to look around</span> ":' <div class="top-layer"><div class="arrow arrow--top"></div></div><div class="right-layer"><div class="arrow arrow--right"></div></div><div class="bottom-layer"><div class="arrow arrow--down"></div></div><div class="left-layer"><div class="arrow arrow--left"></div></div><div class="middle-layer"><div class="intro-phase-a"><svg class="globe-icon" viewbox="0 0 64 64"><g transform="translate(-98.642 -190.77)"><g transform="matrix(-1 0 0 -1 174.56 418.66)"></g><path d="m32 0c-17.664 3.5388e-15 -32 14.336-32 32s14.336 32 32 32 32-14.336 32-32-14.336-32-32-32zm-1.25 4.5v11.875c-4.11-0.038-8.129-0.513-12-1.344 1.091-3.281 2.512-6.3092 4.156-8.9998 2.47-0.8724 5.11-1.4047 7.844-1.5312zm2.5 0c2.734 0.1265 5.374 0.6588 7.844 1.5312 1.644 2.6906 3.065 5.7188 4.156 8.9998-3.871 0.831-7.89 1.306-12 1.344v-11.875zm-14.156 3.2188c-1.071 2.1124-2.003 4.3742-2.782 6.7502-1.46-0.379-2.897-0.828-4.312-1.313 2.039-2.181 4.446-4.0144 7.094-5.4372zm25.812 0c2.648 1.4228 5.055 3.2562 7.094 5.4372-1.415 0.485-2.852 0.934-4.312 1.313-0.779-2.376-1.711-4.6378-2.782-6.7502zm-34.656 7.4692c1.744 0.629 3.532 1.182 5.344 1.656-1.197 4.34-1.867 9.016-1.969 13.906h-9c0.2571-5.859 2.291-11.222 5.625-15.562zm43.5 0c3.334 4.34 5.368 9.703 5.625 15.562h-9c-0.102-4.89-0.772-9.566-1.969-13.906 1.812-0.474 3.6-1.027 5.344-1.656zm-35.688 2.25c4.089 0.89 8.344 1.367 12.688 1.406v11.906h-14.625c0.103-4.697 0.79-9.172 1.937-13.312zm27.876 0c1.147 4.14 1.834 8.615 1.937 13.312h-14.625v-11.906c4.344-0.039 8.599-0.516 12.688-1.406zm-41.313 15.812h9c0.102 4.89 0.772 9.566 1.969 13.906-1.812 0.474-3.6 1.027-5.344 1.656-3.334-4.34-5.3679-9.703-5.625-15.562zm11.5 0h14.625v11.906c-4.344 0.039-8.599 0.516-12.688 1.406-1.147-4.14-1.834-8.615-1.937-13.312zm17.125 0h14.625c-0.103 4.697-0.79 9.172-1.937 13.312-4.089-0.89-8.344-1.367-12.688-1.406v-11.906zm17.125 0h9c-0.257 5.859-2.291 11.222-5.625 15.562-1.744-0.629-3.532-1.182-5.344-1.656 1.197-4.34 1.867-9.016 1.969-13.906zm-19.625 14.375v11.875c-2.734-0.126-5.374-0.659-7.844-1.531-1.644-2.691-3.065-5.719-4.156-9 3.871-0.831 7.89-1.306 12-1.344zm2.5 0c4.11 0.038 8.129 0.513 12 1.344-1.091 3.281-2.512 6.309-4.156 9-2.47 0.872-5.11 1.405-7.844 1.531v-11.875zm-16.938 1.906c0.779 2.376 1.711 4.638 2.782 6.75-2.648-1.423-5.055-3.256-7.094-5.437 1.415-0.485 2.852-0.934 4.312-1.313zm31.376 0c1.46 0.379 2.897 0.828 4.312 1.313-2.039 2.181-4.446 4.014-7.094 5.437 1.071-2.112 2.003-4.374 2.782-6.75z" transform="translate(98.642 190.77)"/><g transform="translate(111.29 -12.026)"><g opacity=".60440"><g><g transform="matrix(-1 0 0 -1 198.35 442.45)"><g transform="translate(-5.9265e-7 .0000023598)"></g></g></g></g></g></g></svg><p class="instruct-copy">Look around!</p></div></div></div> ',t+="</div>"},t.templates.title=function(e){var t="<header> ";return e.badge&&(t+=' <div class="badge',e.badge.shadow&&(t+=" shadow"),t+='"> ',e.badge.link&&(t+='<a href="'+e.badge.link+'"',e.targetBlank&&(t+=' target="_blank"'),t+=">"),t+=' <img src="'+e.badge.img+'"',e.badge.offset&&(t+=' style="margin-top:'+e.badge.offset.y+"px;margin-left:"+e.badge.offset.x+'px"'),t+=' width="'+e.badge.width+'" height="'+e.badge.height+'" alt="'+e.badge.name+' Badge"> ',e.badge.link&&(t+="</a>"),t+=" </div> "),e.showPortrait&&(t+=' <div class="portrait" aria-hidden="true"> ',e.linkToOwner&&(t+='<a tabindex="-1" href="'+e.ownerLink+'"',e.targetBlank&&(t+=' target="_blank"'),t+=">"),t+=' <img src="'+e.portraitImg+'" alt="" width="60" height="60"> ',e.linkToOwner&&(t+="</a>"),t+=" </div> "),t+=' <div class="headers"> ',e.showTitle&&(t+=" <h1> ",e.showTitleLink&&(t+='<a href="'+e.titleLink+'"',e.targetBlank&&(t+=' target="_blank"'),t+=" data-clip-link>"),t+=this.escape(e.title)||"",e.showTitleLink&&(t+="</a>"),e.is360&&(t+='<div class="threesix-badge-title">360°</div>'),t+=" </h1> "),e.showByline&&(t+=' <div class="sub-title"><h2 class="byline-from">'+e.strings.byline+"</h2> ",e.is360&&!e.showTitle&&(t+=' <div class="threesix-badge-byline">360°</div> '),t+=" </div> "),!e.is360||e.showByline||e.showTitle||(t+=' <div class="threesix-badge-loner">360°</div> '),t+=" </div></header>"},t.templates.title_byline_badge=function(e){var t="&nbsp;";return e.link&&(t+='<a tabindex="-1" href="'+e.link+'"',e.targetBlank&&(t+=' target="_blank"'),t+=">"),t+=' <span class="byline-badge '+e.cssClass+'">'+e.cssClass+"</span>",e.link&&(t+="</a>"),t+=""},t.templates.title_owner_byline=function(e){var t="";return e.linkToOwner?(t+='<a href="'+e.ownerLink+'"',e.targetBlank&&(t+=' target="_blank"'),t+=">",t+=this.escape(e.owner)||"",t+="</a>"):(t+='<span class="user">',t+=this.escape(e.owner)||"",t+="</span>"),t+=""},"undefined"!=typeof e&&e.exports?e.exports=t:window.Aftershave=t}()}),ft=e(lt),ht=t(function(e){!function(t,n,i){function r(){var e=Array.prototype.slice.apply(arguments),t=e.shift();v[t].forEach(function(t){"function"==typeof t&&t.apply(t,e)})}function o(e){return function(t,n){p.indexOf(t)!==-1&&e.call(this,t,n)}}function a(e){var t=null;if("VIDEO"===e.tagName)t=e;else{var n=e.getElementsByTagName("video");n[0]&&(t=n[0])}return t}function s(e){var t=a(e);if(t&&t.webkitEnterFullscreen){try{t.readyState<t.HAVE_METADATA?(t.addEventListener("loadedmetadata",function e(){t.removeEventListener("loadedmetadata",e,!1),t.webkitEnterFullscreen(),y=!!t.getAttribute("controls")},!1),t.load()):(t.webkitEnterFullscreen(),y=!!t.getAttribute("controls")),m=t}catch(t){return E("not_supported",e)}return!0}return E(void 0===f.request?"not_supported":"not_enabled",e)}function c(){P.element||(T(),d())}function u(){i&&"webkitfullscreenchange"===f.change&&t.addEventListener("resize",c,!1)}function d(){i&&"webkitfullscreenchange"===f.change&&t.removeEventListener("resize",c,!1)}var l=/i(Pad|Phone|Pod)/.test(navigator.userAgent)&&parseInt(navigator.userAgent.replace(/^.*OS (\d+)_(\d+).*$/,"$1.$2"),10)>=7,f=function(){var e=n.createElement("video"),t={request:["requestFullscreen","webkitRequestFullscreen","webkitRequestFullScreen","mozRequestFullScreen","msRequestFullscreen"],exit:["exitFullscreen","webkitCancelFullScreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen"],enabled:["fullscreenEnabled","webkitFullscreenEnabled","mozFullScreenEnabled","msFullscreenEnabled"],element:["fullscreenElement","webkitFullscreenElement","webkitCurrentFullScreenElement","mozFullScreenElement","msFullscreenElement"],change:["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],error:["fullscreenerror","webkitfullscreenerror","mozfullscreenerror","MSFullscreenError"]},i={};for(var r in t)for(var o=0,a=t[r].length;o<a;o++)if(t[r][o]in e||t[r][o]in n||"on"+t[r][o].toLowerCase()in n){i[r]=t[r][o];break}return i}(),h={ENTER:"enter",EXIT:"exit",CHANGE:"change",ERROR:"error"},p=[],v={},g=null;Object.keys(h).forEach(function(e){p.push(h[e]),v[h[e]]=[]});var m=null,y=null,_=function(){},b=[],w=!1,k=!1,S={chrome:navigator.userAgent.indexOf("Chrome")!==-1,android:navigator.userAgent.indexOf("Android")!==-1,safari:navigator.userAgent.indexOf("Safari")!==-1,apple:navigator.userAgent.indexOf("Apple")!==-1};S.chrome&&S.android&&(w=parseInt(navigator.userAgent.replace(/^.*Chrome\/(\d+).*$/,"$1"),10)||!0),S.safari&&S.apple&&!S.chrome&&!S.android&&(k=parseFloat(navigator.userAgent.replace(/^.*Version\/(\d+)\.(\d+).*$/,"$1.$2"))||!0);var x=function(e){var t=b[b.length-1];t&&(e!==t.element&&e!==m||!t.hasEntered)&&("VIDEO"===e.tagName&&(m=e),1===b.length&&P.onenter(P.element),t.enter.call(t.element,e||t.element),t.hasEntered=!0,r(h.ENTER,P.element))},T=function(){!m||y||l||(m.setAttribute("controls","controls"),m.removeAttribute("controls")),m=null,y=null;var e=b.pop();e&&(e.exit.call(e.element),r(h.EXIT,e.element),!i&&g&&0===t.scrollY&&t.scrollTo(0,g),P.element||(b.forEach(function(e){e.exit.call(e.element),r(h.EXIT,e.element)}),b=[],P.onexit()))},E=function(e,t){if(b.length>0){var n=b.pop();t=t||n.element,n.error.call(t,e),P.onerror(t,e),r(h.ERROR,t,e)}},P={request:function(e,r,o,a){if(e=e||n.body,b.push({element:e,enter:r||_,exit:o||_,error:a||_}),void 0===f.request)return s(e);if(i&&n[f.enabled]===!1)return s(e);if(w!==!1&&w<32)return s(e);if(i&&void 0===f.enabled)return f.enabled="webkitFullscreenEnabled",e[f.request](),void setTimeout(function(){n[f.element]?n[f.enabled]=!0:(n[f.enabled]=!1,s(e))},250);try{!i&&t&&(g=t.scrollY),e[f.request](),k>=5.1&&setTimeout(function(){n[f.element]||E(i?"not_enabled":"not_allowed",e)},100)}catch(t){E("not_enabled",e)}},exit:function(){d(),!n[f.exit]&&P.element?P.element[f.exit]():n[f.exit]()},toggle:function(e,t,n,i){P.element?P.exit():P.request(e,t,n,i)},videoEnabled:function(e){if(P.enabled)return!0;e=e||n.body;var t=a(e);return!(!t||void 0===t.webkitSupportsFullscreen)&&(t.readyState<t.HAVE_METADATA?"maybe":t.webkitSupportsFullscreen)},on:o(function(e,t){v[e].push(t)}),off:o(function(e,t){var n=v[e].indexOf(t);n>-1&&v[e].splice(n,1)}),onenter:_,onexit:_,onchange:_,onerror:_};try{Object.defineProperties(P,{element:{enumerable:!0,get:function(){return m&&m.webkitDisplayingFullscreen?m:n[f.element]||null}},enabled:{enumerable:!0,get:function(){return"webkitCancelFullScreen"===f.exit&&!i||!(w!==!1&&w<32)&&(n[f.enabled]||!1)}}})}catch(e){P.element=null,P.enabled=!1}f.change&&n.addEventListener(f.change,function(e){if(P.onchange(P.element),r(h.CHANGE,P.element),P.element){var t=b[b.length-2];t&&t.element===P.element?T():(x(P.element),u())}else T()},!1),n.addEventListener("webkitbeginfullscreen",function(e){var t=!0;if(b.length>0)for(var n=0,i=b.length;n<i;n++){var o=a(b[n].element);if(o===e.srcElement){t=!1;break}}t&&b.push({element:e.srcElement,enter:_,exit:_,error:_}),P.onchange(e.srcElement),r(h.CHANGE,P.srcElement),x(e.srcElement)},!0),n.addEventListener("webkitendfullscreen",function(e){P.onchange(e.srcElement),r(h.CHANGE,e.srcElement),T(e.srcElement)},!0),f.error&&n.addEventListener(f.error,function(e){E("not_allowed")},!1),"undefined"!=typeof e&&e.exports?e.exports=P:t.BigScreen=P}(window,document,self!==top)}),pt=e(ht),vt=navigator.userAgent.toLowerCase(),gt=!!k("android")&&(parseFloat(vt.replace(/^.* android (\d+)\.(\d+).*$/,"$1.$2"))||!0),mt=window.devicePixelRatio||1,yt=!(!k("windows phone")&&!k("iemobile"))&&(parseFloat(vt.replace(/^.* windows phone (os )?(\d+)\.(\d+).*$/,"$2.$3"))||!0),_t=!!k("msie")&&parseFloat(vt.replace(/^.*msie (\d+).*$/,"$1")),bt=!!k("trident")&&parseFloat(vt.replace(/^.*trident\/(\d+)\.(\d+).*$/,"$1.$2"))+4,wt=!!(k("ipad;")||k("iphone;")||k("ipod touch;"))&&parseFloat(vt.replace(/^.* os (\d+)_(\d+).*$/,"$1.$2")),kt={airPlay:"WebKitPlaybackTargetAvailabilityEvent"in window,android:gt,iOS:wt,mobileAndroid:gt&&k("mobile"),browser:{bb10:k("bb10"),chrome:k("chrome"),firefox:k("firefox"),ie:_t||bt,edge:k("edge"),opera:k("opera"),safari:k("safari")&&k("apple")&&!k("chrome")&&!k("android")},devicePixelRatio:mt,flash:x(),iPhone:k("iphone;")||k("ipod touch;")||k("ipod;"),iPad:k("ipad;"),iPadNonRetina:k("ipad;")&&mt<2,mac:k("mac os"),pointerEvents:window.navigator.pointerEnabled||window.navigator.msPointerEnabled||!1,svg:!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,touch:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch||k("windows phone")||window.navigator.maxTouchPoints>1||window.navigator.msMaxTouchPoints||!1,transformProperty:S("transform"),windowsPhone:yt};if(kt.threeSixtyVideo=!(kt.browser.safari||kt.iOS||kt.iPad),function(){for(var e=["webkit","moz"],t=0;t<e.length&&!window.requestAnimationFrame;++t){var n=e[t];window.requestAnimationFrame=window[n+"RequestAnimationFrame"],window.cancelAnimationFrame=window[n+"CancelAnimationFrame"]||window[n+"CancelRequestAnimationFrame"]}!/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)&&window.requestAnimationFrame&&window.cancelAnimationFrame||(window.requestAnimationFrame=function(e){return setTimeout(e,0)},window.cancelAnimationFrame=clearTimeout)}(),Number.isInteger||(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),!Object.setPrototypeOf&&!{}.__proto__){var St=Object.getPrototypeOf;Object.getPrototypeOf=function(e){return e.__proto__?e.__proto__:St.call(Object,e)}}if("undefined"!=typeof DOMTokenList){var xt=function(){var e=document.createElement("div");return e.classList.toggle("test-class",!1),!e.classList.contains("test-class")}();xt||!function(){var e=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(t,n){return n===!0?void this.add(t):n===!1?void this.remove(t):void e.call(this,t)}}()}var Tt,Et=t(function(e){var t=t||{version:"5.3.03",plugins:{map:[]},adnalyzers:{},utils:{},managers:{},comm:{},data:{}};t.comm.Communication=function(e,n){try{this.host=e,this.httpSecure=n,this.pingTime=5,this.prefix="U",this.code="",this.view=-1,this.preloaders=[],this._requests={},this.addPreloader("FastData")}catch(e){t.error(e)}},t.comm.Communication.prototype.extraOperationsCallback=null,t.comm.Communication.prototype.getViewCode=function(){return this.code?this.prefix+this.code+"_"+this.view:"nocode"},t.comm.Communication.prototype.nextView=function(e){return this.view++,e===!0?this.prefix="L":e===!1?this.prefix="V":this.prefix="U",this.getViewCode()},t.comm.Communication.prototype.requestData=function(e,n){try{e=e||{},e.outputformat="jsonp",delete e.code;var i=this,r=new t.comm.AjaxRequest(this._parseServiceHost(this.host),"/data",e);r.load(function(){i.receiveData(r)}),r.load(n),r.send(),t.noticeRequest("Request: NQS /data "+e.system)}catch(e){t.error(e)}},t.comm.Communication.prototype.receiveData=function(e){try{var n=e.getXHR().response,i=JSON.parse(n.slice(n.indexOf("(")+1,n.lastIndexOf(")"))),r=i.q.h,o=i.q.c,a=i.q.pt,s=i.q.b;r.length>0&&o.length>0&&a.length>0&&s.length>0?(this.prefix=o.slice(0,1),this.code=o.slice(1),this.host=r,this.pingTime=a,this.balancerEnabled=s,t.noticeRequest("FastData '"+o+"' is ready."),this._requests.nocode&&this._requests.nocode.length>0&&(this._requests[this.getViewCode()]=this._requests.nocode,delete this._requests.nocode),this.removePreloader("FastData")):t.error("Error: FastData response is wrong.")}catch(e){t.error(e)}},t.comm.Communication.prototype.sendRequest=function(e,n,i){try{n=n||{},delete n.code;var r=new t.comm.AjaxRequest("",e,n);r.load(i),this._registerRequest(r)}catch(e){t.error(e)}},t.comm.Communication.prototype.sendService=function(e,n,i){try{var r=new t.comm.AjaxRequest(this._parseServiceHost(e),"",n);r.load(i),this._registerRequest(r)}catch(e){t.error(e)}},t.comm.Communication.prototype.addPreloader=function(e){try{this.preloaders.push(e)}catch(e){t.error(e)}},t.comm.Communication.prototype.removePreloader=function(e){try{var n=this.preloaders.indexOf(e);if(n!==-1){if(this.preloaders.splice(n,1),0===this.preloaders.length){var i;for(var r in this._requests)for(;i=this._requests[r].shift();)i.setParam("code",r),i.host||(i.host=this._parseServiceHost(this.host)),"function"==typeof this.extraOperationsCallback&&this.extraOperationsCallback(i.params),i.send()}}else t.warn("Warning: trying to remove unexisting preloader '"+e+"'.")}catch(e){t.error(e)}},t.comm.Communication.prototype._registerRequest=function(e){try{return"undefined"==typeof this._requests[this.getViewCode()]&&(this._requests[this.getViewCode()]=[]),e.setParam("timemark",(new Date).getTime()),this._requests[this.getViewCode()].push(e),this._sendRequests(),e}catch(e){t.error(e)}},t.comm.Communication.prototype._sendRequests=function(){try{if(0===this.preloaders.length){var e;for(var n in this._requests)for(;e=this._requests[n].shift();)e.setParam("code",n),e.host||(e.host=this._parseServiceHost(this.host)),e.send()}}catch(e){t.error(e)}},t.comm.Communication.prototype._parseServiceHost=function(e){try{return 0===e.indexOf("//")?e=e.slice(2):0===e.indexOf("http://")?e=e.slice(7):0===e.indexOf("https://")&&(e=e.slice(8)),e=this.httpSecure===!0?"https://"+e:0===window.location.protocol.indexOf("http")?"//"+e:"http://"+e}catch(e){return t.error(e),"http://localhost"}},t.comm.AjaxRequest=function(e,n,i,r){try{this.xhr=this.createXHR(),this.host=e,this.service=n||"",this.params=i,this.options=r||{},this.options.method=this.options.method||t.comm.AjaxRequest.options.method,this.options.maxRetries=this.options.maxRetries||t.comm.AjaxRequest.options.maxRetries,"undefined"==typeof this.options.retryAfter&&(this.options.retryAfter=t.comm.AjaxRequest.options.retryAfter),this.hasError=!1,this.retries=1}catch(e){t.error(e)}},t.comm.AjaxRequest.onEverySuccess=null,t.comm.AjaxRequest.options={method:"GET",requestHeaders:{},maxRetries:3,retryAfter:5e3},t.comm.AjaxRequest.prototype.getUrl=function(){try{return this.host+this.service+this.getParams()}catch(e){t.error(e)}},t.comm.AjaxRequest.prototype.getParams=function(){try{switch(Xe(this.params)){case"object":return"?"+this._parseParams(this.params);case"string":return this.params?"?"+this.params:"";default:return""}}catch(e){t.error(e)}},t.comm.AjaxRequest.prototype.setParam=function(e,n){try{switch(Xe(this.params)){case"string":this.params.length>0&&(this.params+="&"),this.params+=e+"="+n;break;case"object":default:this.params[e]=n}return this}catch(e){return t.error(e),this}},t.comm.AjaxRequest.prototype.on=function(e,n){try{"error"==e&&(this.hasError=!0),"function"==typeof n?this.xhr.addEventListener(e,n,!1):"undefined"!=typeof n&&t.warn("Warning: Request '"+this.getUrl()+"' has a callback that is not a function.")}catch(e){t.error(e)}finally{return this}},t.comm.AjaxRequest.prototype.load=function(e){return this.on("load",e)},t.comm.AjaxRequest.prototype.error=function(e){return this.on("error",e)},t.comm.AjaxRequest.prototype.send=function(){try{if(this.xhr.open(this.options.method,this.getUrl(),!0),this.options.requestHeaders)for(var e in this.options.requestHeaders)this.options.requestHeaders.hasOwnProperty(e)&&this.xhr.setRequestHeader(e,this.options.requestHeaders[e]);if(!this.hasError&&this.options.retryAfter>0&&this.options.maxRetries>0){var n=this;this.error(function(){if(n.retries>n.options.maxRetries)t.error("Error: Aborting failed request. Max retries reached.");else{t.warn("Error: Request "+n.service+" failed. Retry "+n.retries+" of "+n.options.maxRetries+" in "+n.options.retryAfter+"ms.");var e=n;setTimeout(function(){e.retries+=1,e.send()},n.options.retryAfter)}})}t.debugLevel>=5&&t.verbose("XHR Req: "+this.getUrl()),"function"==typeof t.comm.AjaxRequest.onEverySuccess&&this.load(t.comm.AjaxRequest.onEverySuccess),this.xhr.send()}catch(e){t.error(e)}},t.comm.AjaxRequest.prototype.createXHR=function(){try{return window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")}catch(e){return t.error(e),{}}},t.comm.AjaxRequest.prototype.getXHR=function(){return this.xhr},t.comm.AjaxRequest.prototype._parseParams=function(e){try{if("string"==typeof e)return e;if(null!==e&&"object"==("undefined"==typeof e?"undefined":Xe(e))){var n="";for(var i in e)null!==e[i]&&"object"==Xe(e[i])?n+=encodeURIComponent(i)+"="+encodeURIComponent(JSON.stringify(e[i]))+"&":null!==e[i]&&"undefined"!=typeof e[i]&&""!==e[i]&&(n+=encodeURIComponent(i)+"="+encodeURIComponent(e[i])+"&");return n.slice(0,-1)}return""}catch(e){return t.error(e),""}},t.data.Options=function(e){try{this.setOptions(e)}catch(e){t.error(e)}},t.data.Options.prototype={enableAnalytics:!0,disabledRequests:[],parseHLS:!1,parseCDNNodeHost:!1,haltOnError:!0,hashTitle:!0,httpSecure:void 0,enableNiceBuffer:!0,enableNiceSeek:!0,accountCode:"nicetest",service:"nqs.nice264.com",username:void 0,transactionCode:void 0,network:{ip:void 0,isp:void 0},device:{id:void 0},media:{isLive:void 0,resource:void 0,title:void 0,duration:void 0,cdn:void 0,isBalanced:0,isResumed:0},ads:{expected:!1,resource:void 0,campaign:void 0,title:void 0,position:void 0,duration:void 0},properties:{contentId:void 0,type:void 0,transaction_type:void 0,genre:void 0,language:void 0,year:void 0,cast:void 0,director:void 0,owner:void 0,parental:void 0,price:void 0,rating:void 0,audioType:void 0,audioChannels:void 0,device:void 0,quality:void 0},extraParams:{param1:void 0,param2:void 0,param3:void 0,param4:void 0,param5:void 0,param6:void 0,param7:void 0,param8:void 0,param9:void 0,param10:void 0},setOptions:function(e,n){try{if(n=n||this,"undefined"!=typeof e)for(var i in e)"object"==Xe(n[i])&&null!==n[i]?this.setOptions(e[i],n[i]):n[i]=e[i]}catch(e){t.error(e)}}},t.adnalyzers.Generic=function(){},t.adnalyzers.Generic.prototype={adnalyzerVersion:"5.3.0-GENERIC",ads:void 0,plugin:void 0},t.adnalyzers.Generic.prototype.startMonitoring=function(e,n){try{t.notice("Adnalyzer "+this.adnalyzerVersion+" is ready."),this.plugin=e,this.ads=n}catch(e){return t.error(e),null}},t.adnalyzers.Generic.prototype.stopMonitoring=function(){this.ads=null,this.plugin.viewManager.timer.adPlayheadMonitor.stop()},t.adnalyzers.Generic.prototype.enableAdBufferMonitor=function(){this.plugin.infoManager.options.enableNiceBuffer&&(this.plugin.viewManager.enableAdBufferMonitor=!0)},t.adnalyzers.Generic.prototype.enableAdSeekMonitor=function(){this.plugin.infoManager.options.enableNiceSeek&&(this.plugin.viewManager.enableAdSeekMonitor=!0)},t.adnalyzers.Generic.prototype.playAdHandler=function(){try{this.isAdStartSent||this.plugin.viewManager.sendAdStart()}catch(e){t.error(e)}},t.adnalyzers.Generic.prototype.startJoinAdHandler=function(){try{this.isAdStartSent||(this.plugin.viewManager.sendAdStart(),this.plugin.viewManager.isBuffering&&(this.plugin.viewManager.chrono.joinTime.startTime=this.plugin.viewManager.chrono.buffer.startTime,this.plugin.viewManager.isBuffering=!1),this.plugin.viewManager.sendAdJoin())}catch(e){t.error(e)}},t.adnalyzers.Generic.prototype.joinAdHandler=function(){try{this.plugin.viewManager.sendAdJoin()}catch(e){t.error(e)}},t.adnalyzers.Generic.prototype.pauseAdHandler=function(){try{this.plugin.viewManager.sendAdPause()}catch(e){t.error(e)}},t.adnalyzers.Generic.prototype.pauseToggleAdHandler=function(){try{this.isAdPaused?this.plugin.viewManager.sendAdResume():this.plugin.viewManager.sendAdPause()}catch(e){t.error(e)}},t.adnalyzers.Generic.prototype.resumeAdHandler=function(){try{this.plugin.viewManager.sendAdResume()}catch(e){t.error(e)}},t.adnalyzers.Generic.prototype.endedAdHandler=function(){try{this.plugin.viewManager.sendAdStop()}catch(e){t.error(e)}},t.adnalyzers.Generic.prototype.skipAdHandler=function(){try{this.plugin.viewManager.sendAdStop({skipped:!0})}catch(e){t.error(e)}},t.adnalyzers.Generic.prototype.bufferingAdHandler=function(){try{this.plugin.viewManager.sendAdBufferStart()}catch(e){t.error(e)}},t.adnalyzers.Generic.prototype.bufferedAdHandler=function(){try{this.isAdStartSent&&(this.isAdJoinSent?this.isAdBuffering&&this.plugin.viewManager.sendAdBufferEnd():this.plugin.viewManager.sendAdJoin())}catch(e){t.error(e)}},t.adnalyzers.Generic.prototype.getAdResource=function(){return"unknown"},t.adnalyzers.Generic.prototype.getMediaPlayhead=function(){return null},t.adnalyzers.Generic.prototype.getAdPlayhead=function(){return 0},t.adnalyzers.Generic.prototype.getAdPosition=function(){return"unknown"},t.adnalyzers.Generic.prototype.getAdTitle=function(){return null},t.adnalyzers.Generic.prototype.getAdDuration=function(){return 0},t.adnalyzers.Generic.prototype.getAdBitrate=function(){return-1},t.adnalyzers.Generic.prototype.getAdPlayerVersion=function(){return null},t.plugins.Generic=function(){},t.plugins.Generic.prototype={pluginName:"GENERIC",pluginVersion:"5.1.0-GENERIC",playerId:"generic",player:null,tag:null,infoManager:void 0,viewManager:void 0,adnalyzer:null},t.plugins.Generic.prototype.startMonitoring=function(e,n){try{t.notice("Plugin "+this.pluginVersion+" (with YouboraJS "+t.version+") is ready."),"string"==typeof e?(this.playerId=e,this.player=document.getElementById(e)):(this.player=e,e&&e.id&&(this.playerId=e.id)),this.tag=this.player,"undefined"==typeof this.infoManager?this.infoManager=new t.managers.Info(this,n):this.infoManager.setOptions(n),this.viewManager=new t.managers.View(this.infoManager)}catch(e){return t.error(e),null}},t.plugins.Generic.prototype.stopMonitoring=function(){this.player=null,this.tag=null,this.viewManager.stopTimers()},t.plugins.Generic.prototype.enableBufferMonitor=function(){this.infoManager.options.enableNiceBuffer&&(this.viewManager.enableBufferMonitor=!0)},t.plugins.Generic.prototype.enableSeekMonitor=function(){this.infoManager.options.enableNiceSeek&&(this.viewManager.enableSeekMonitor=!0)},t.plugins.Generic.prototype.setOptions=function(e){try{this.infoManager.options.setOptions(e)}catch(e){t.error(e)}},t.plugins.Generic.prototype.getOptions=function(){try{return this.infoManager.options||{}}catch(e){return t.error(e),{}}},t.plugins.Generic.prototype.playHandler=function(){try{this.viewManager.sendStart()}catch(e){t.error(e)}},t.plugins.Generic.prototype.joinHandler=function(){try{this.viewManager.sendJoin()}catch(e){t.error(e)}},t.plugins.Generic.prototype.playingHandler=function(){try{this.viewManager.isStartSent&&(this.viewManager.isJoinSent?this.viewManager.isSeeking&&this.viewManager.isPaused?(this.viewManager.sendSeekEnd(),this.viewManager.sendResume()):this.viewManager.isSeeking?this.viewManager.sendSeekEnd():this.viewManager.isBuffering?this.viewManager.sendBufferEnd():this.viewManager.isPaused&&this.viewManager.sendResume():this.viewManager.sendJoin())}catch(e){t.error(e)}},t.plugins.Generic.prototype.pauseHandler=function(){try{this.viewManager.sendPause()}catch(e){t.error(e)}},t.plugins.Generic.prototype.pauseToggleHandler=function(){try{this.viewManager.isPaused?this.viewManager.sendResume():this.viewManager.sendPause()}catch(e){t.error(e)}},t.plugins.Generic.prototype.resumeHandler=function(){try{this.viewManager.sendResume()}catch(e){t.error(e)}},t.plugins.Generic.prototype.endedHandler=function(){try{this.viewManager.sendStop()}catch(e){t.error(e)}},t.plugins.Generic.prototype.errorHandler=function(e,n){try{"undefined"==typeof e&&(e=0),n=n||e||"Unknown error",this.viewManager.sendError({errorCode:e,msg:n})}catch(e){t.error(e)}},t.plugins.Generic.prototype.seekingHandler=function(){try{this.viewManager.isBuffering?this.viewManager.convertBufferToSeek():this.viewManager.sendSeekStart()}catch(e){t.error(e)}},t.plugins.Generic.prototype.seekedHandler=function(){try{this.viewManager.sendSeekEnd()}catch(e){t.error(e)}},t.plugins.Generic.prototype.bufferingHandler=function(){try{this.viewManager.isSeeking||this.viewManager.sendBufferStart()}catch(e){t.error(e)}},t.plugins.Generic.prototype.bufferedHandler=function(){try{this.viewManager.isStartSent&&(this.viewManager.isJoinSent?this.viewManager.isSeeking?this.viewManager.sendSeekEnd():this.viewManager.isBuffering&&this.viewManager.sendBufferEnd():this.viewManager.sendJoin())}catch(e){t.error(e)}},t.plugins.Generic.prototype.ignoringAdHandler=function(){try{this.viewManager.sendIgnoreAdStart()}catch(e){t.error(e)}},t.plugins.Generic.prototype.ignoredAdHandler=function(){try{this.viewManager.sendIgnoreAdEnd()}catch(e){t.error(e)}},t.plugins.Generic.prototype.getResource=function(){return"unknown"},t.plugins.Generic.prototype.getPlayhead=function(){return 0},t.plugins.Generic.prototype.getMediaDuration=function(){return 0},t.plugins.Generic.prototype.getIsLive=function(){return!1},t.plugins.Generic.prototype.getRendition=function(){return null},t.plugins.Generic.prototype.getBitrate=function(){return-1},t.plugins.Generic.prototype.getThroughput=function(){return-1},t.plugins.Generic.prototype.getPlayerVersion=function(){return null},t.plugins.Generic.prototype.getTotalBytes=function(){return null},t.plugins.Generic.prototype.getTitle=function(){return null},t.managers.Info=function(e,n){this.plugin=e,this.options=new t.data.Options(n),this.lastBitrate=0,this.lastAdBitrate=0},t.managers.Info.prototype.getDataParams=function(e){try{return t.plugins.map.push(this.plugin),e=e||{},e.system=e.hasOwnProperty("system")?e.system:this.options.accountCode,e.pluginName=e.hasOwnProperty("pluginName")?e.pluginName:this.plugin.pluginName,
e.pluginVersion=e.hasOwnProperty("pluginVersion")?e.pluginVersion:this.plugin.pluginVersion,e.live=e.hasOwnProperty("live")?e.live:this.options.media.isLive,e}catch(n){return t.error(n),e}},t.managers.Info.prototype.setOptions=function(e){this.options.setOptions(e)},t.managers.Info.prototype.getOptions=function(e){return this.options},t.managers.Info.prototype.getAdPlayhead=function(){try{return t.utils.parseNumber(this.plugin.adnalyzer.getAdPlayhead(),0)}catch(e){return t.warn(e),0}},t.managers.Info.prototype.getAdBitrate=function(){try{var e=Math.round(this.plugin.adnalyzer.getAdBitrate());if(e==-1&&this.plugin.adnalyzer.tag&&"undefined"!=typeof this.plugin.adnalyzer.tag.webkitVideoDecodedByteCount){var n=this.plugin.adnalyzer.tag.webkitVideoDecodedByteCount;this.lastAdBitrate&&(n=Math.round((this.plugin.adnalyzer.tag.webkitVideoDecodedByteCount-this.lastAdBitrate)/5*8)),this.lastAdBitrate=this.plugin.adnalyzer.tag.webkitVideoDecodedByteCount,e=n}return t.utils.parseNumber(e,-1)}catch(e){return t.warn(e),-1}},t.managers.Info.prototype.getAdResource=function(){try{return"undefined"!=typeof this.options.ads.resource?this.options.ads.resource:this.plugin.adnalyzer.getAdResource()}catch(e){return t.warn(e),""}},t.managers.Info.prototype.getAdPosition=function(){try{return"undefined"!=typeof this.options.ads.position?this.options.ads.position:this.plugin.adnalyzer.getAdPosition()}catch(e){return t.warn(e),"unknown"}},t.managers.Info.prototype.getAdTitle=function(){try{return"undefined"!=typeof this.options.ads.title?this.options.ads.title:this.plugin.adnalyzer.getAdTitle()}catch(e){return t.warn(e),""}},t.managers.Info.prototype.getAdDuration=function(){try{return res=0,"undefined"!=typeof this.options.ads.duration?res=this.options.ads.duration:res=Math.round(this.plugin.adnalyzer.getAdDuration()),t.utils.parseNumber(res,0)}catch(e){return t.warn(e),0}},t.managers.Info.prototype.getAdPlayerVersion=function(){try{return this.plugin.adnalyzer.getAdPlayerVersion()}catch(e){return t.warn(e),null}},t.managers.Info.prototype.getAdStartParams=function(e,n){try{return e=e||{},e.position="undefined"!=typeof e.position?e.position:this.getAdPosition(),e.resource="undefined"!=typeof e.resource?e.resource:this.getAdResource(),e.campaign="undefined"!=typeof e.campaign?e.campaign:this.options.ads.campaign,e.title="undefined"!=typeof e.title?e.title:this.getAdTitle(),e.adDuration="undefined"!=typeof e.adDuration?e.adDuration:this.getAdDuration(),e.playhead="undefined"!=typeof e.playhead?e.playhead:this.getPlayhead(),e.adnalyzerVersion="undefined"!=typeof e.adnalyzerVersion?e.adnalyzerVersion:this.plugin.adnalyzer.adnalyzerVersion,e.adPlayerVersion="undefined"!=typeof e.adPlayerVersion?e.adPlayerVersion:this.getAdPlayerVersion(),e}catch(n){return t.error(n),e}},t.managers.Info.prototype.getAdJoinParams=function(e,n){try{return e=e||{},e.adPlayhead="undefined"!=typeof e.adPlayhead?e.adPlayhead:this.getAdPlayhead(),e}catch(n){return t.error(n),e}},t.managers.Info.prototype.getAdStopParams=function(e,n){try{return e=e||{},e.adPlayhead="undefined"!=typeof e.adPlayhead?e.adPlayhead:this.getAdPlayhead(),e.adBitrate="undefined"!=typeof e.adBitrate?e.adBitrate:this.getAdBitrate(),e}catch(n){return t.error(n),e}},t.managers.Info.prototype.getAdPauseParams=function(e,t){return e||{}},t.managers.Info.prototype.getAdResumeParams=function(e,t){return e||{}},t.managers.Info.prototype.getAdBufferEndParams=function(e,n){try{return e=e||{},e.adPlayhead="undefined"!=typeof e.adPlayhead?e.adPlayhead:this.getAdPlayhead(),e}catch(n){return t.error(n),e}},t.managers.Info.prototype.getAdPingParams=function(e,n){try{return e=e||{},e.adBitrate="undefined"!=typeof e.adBitrate?e.adBitrate:this.getAdBitrate(),e.adPlayhead="undefined"!=typeof e.adPlayhead?e.adPlayhead:this.getAdPlayhead(),e}catch(n){return t.error(n),e}},t.managers.Info.prototype.getResource=function(){try{return this.plugin.resourceParser&&this.plugin.resourceParser.realResource?this.plugin.resourceParser.realResource:"undefined"!=typeof this.options.media.resource?this.options.media.resource:this.plugin.getResource()}catch(e){return t.warn(e),"unknown"}},t.managers.Info.prototype.getMediaDuration=function(){try{var e=0;return e="undefined"!=typeof this.options.media.duration?this.options.media.duration:this.plugin.getMediaDuration(),Math.round(t.utils.parseNumber(e,0))}catch(e){return t.warn(e),0}},t.managers.Info.prototype.getIsLive=function(){try{return"undefined"!=typeof this.options.media.isLive?this.options.media.isLive:this.plugin.getIsLive()}catch(e){return t.warn(e),!1}},t.managers.Info.prototype.getPlayerVersion=function(){try{return this.plugin.getPlayerVersion()}catch(e){return t.warn(e),""}},t.managers.Info.prototype.getTitle=function(){try{return"undefined"!=typeof this.options.media.title?this.options.media.title:this.plugin.getTitle()}catch(e){return t.warn(e),""}},t.managers.Info.prototype.getRendition=function(){try{return"undefined"!=typeof this.options.media.rendition?this.options.media.rendition:this.plugin.getRendition()}catch(e){return t.warn(e),""}},t.managers.Info.prototype.getBitrate=function(){try{var e=Math.round(this.plugin.getBitrate());if(e==-1&&this.plugin.tag&&"undefined"!=typeof this.plugin.tag.webkitVideoDecodedByteCount){var n=this.plugin.tag.webkitVideoDecodedByteCount;this.lastBitrate&&(n=Math.round((this.plugin.tag.webkitVideoDecodedByteCount-this.lastBitrate)/5*8)),this.lastBitrate=this.plugin.tag.webkitVideoDecodedByteCount,e=0!=n?n:-1}return t.utils.parseNumber(e,-1)}catch(e){return t.warn(e),-1}},t.managers.Info.prototype.getThroughput=function(){try{return t.utils.parseNumber(Math.round(this.plugin.getThroughput()),-1)}catch(e){return t.warn(e),-1}},t.managers.Info.prototype.getTotalBytes=function(){try{return t.utils.parseNumber(this.plugin.getTotalBytes(),null)}catch(e){return t.warn(e),null}},t.managers.Info.prototype.getPlayhead=function(){try{var e=this.plugin.getPlayhead();return this.plugin.adnalyzer&&null!==this.plugin.adnalyzer.getMediaPlayhead()&&(e=this.plugin.adnalyzer.getMediaPlayhead()),t.utils.parseNumber(e,0)}catch(e){return t.warn(e),0}},t.managers.Info.prototype.getStartParams=function(e){try{return e=e||{},e.system=e.hasOwnProperty("system")?e.system:this.options.accountCode,e.player=e.hasOwnProperty("player")?e.player:this.plugin.pluginName,e.user=e.hasOwnProperty("user")?e.user:this.options.username,e.transcode=e.hasOwnProperty("transcode")?e.transcode:this.options.transactionCode,e.hashTitle=e.hasOwnProperty("hashTitle")?e.hashTitle:this.options.hashTitle,e.referer=e.hasOwnProperty("referer")?e.referer:"undefined"!=typeof window?window.location.href:"",e.deviceId=e.hasOwnProperty("deviceId")?e.deviceid:this.options.device.id,e.pluginVersion=e.hasOwnProperty("pluginVersion")?e.pluginVersion:this.plugin.pluginVersion,e.playerVersion=e.hasOwnProperty("playerVersion")?e.playerVersion:this.getPlayerVersion(),e.resource=e.hasOwnProperty("resource")?e.resource:this.getResource(),e.duration=e.hasOwnProperty("duration")?e.duration:this.getMediaDuration(),e.live=e.hasOwnProperty("live")?e.live:this.getIsLive(),e.rendition=e.hasOwnProperty("rendition")?e.rendition:this.getRendition(),e.title=e.hasOwnProperty("title")?e.title:this.getTitle(),e.properties=e.hasOwnProperty("properties")?e.properties:this.options.properties,e.cdn=e.hasOwnProperty("cdn")?e.cdn:this.options.media.cdn,e.isp=e.hasOwnProperty("isp")?e.isp:this.options.network.isp,e.ip=e.hasOwnProperty("ip")?e.ip:this.options.network.ip,e.param1=e.hasOwnProperty("param1")?e.param1:this.options.extraParams.param1,e.param2=e.hasOwnProperty("param2")?e.param2:this.options.extraParams.param2,e.param3=e.hasOwnProperty("param3")?e.param3:this.options.extraParams.param3,e.param4=e.hasOwnProperty("param4")?e.param4:this.options.extraParams.param4,e.param5=e.hasOwnProperty("param5")?e.param5:this.options.extraParams.param5,e.param6=e.hasOwnProperty("param6")?e.param6:this.options.extraParams.param6,e.param7=e.hasOwnProperty("param7")?e.param7:this.options.extraParams.param7,e.param8=e.hasOwnProperty("param8")?e.param8:this.options.extraParams.param8,e.param9=e.hasOwnProperty("param9")?e.param9:this.options.extraParams.param9,e.param10=e.hasOwnProperty("param10")?e.param10:this.options.extraParams.param10,e.totalBytes=e.hasOwnProperty("totalBytes")?e.totalBytes:this.getTotalBytes(),e.adsExpected=e.hasOwnProperty("adsExpected")?e.adsExpected:this.options.ads.expected,1==this.options.isResumed&&(e.isResumed=1),1==this.options.isBalanced&&(e.isBalanced=1),e}catch(n){return t.error(n),e}},t.managers.Info.prototype.getJoinParams=function(e){try{return e=e||{},e.eventTime=e.hasOwnProperty("eventTime")?e.eventTime:this.getPlayhead(),e.mediaDuration=e.hasOwnProperty("mediaDuration")?e.mediaDuration:this.getMediaDuration(),e}catch(n){return t.error(n),e}},t.managers.Info.prototype.getStopParams=function(e){return e||{}},t.managers.Info.prototype.getPauseParams=function(e){return e||{}},t.managers.Info.prototype.getResumeParams=function(e){return e||{}},t.managers.Info.prototype.getBufferEndParams=function(e){try{return e=e||{},e.time=e.hasOwnProperty("time")?e.time:this.getPlayhead(),e}catch(n){return t.error(n),e}},t.managers.Info.prototype.getErrorParams=function(e){try{return e=e||{},e.errorCode=e.hasOwnProperty("errorCode")?e.errorCode:"9000",e.msg=e.hasOwnProperty("msg")?e.msg:"Unknown Error",e=this.getStartParams(e)}catch(n){return t.error(n),e}},t.managers.Info.prototype.getSeekEndParams=function(e){return this.getBufferEndParams(e)},t.managers.Info.prototype.getPingParams=function(e,n){try{return e=e||{},e.time="undefined"!=typeof e.time?e.time:this.getPlayhead(),e.bitrate="undefined"!=typeof e.bitrate?e.bitrate:this.getBitrate(),e.throughput="undefined"!=typeof e.throughput?e.throughput:this.getThroughput(),e.totalBytes="undefined"!=typeof e.totalBytes?e.totalBytes:this.getTotalBytes(),e}catch(n){return t.error(n),e}},t.managers.View=function(e){this.infoManager=e,this.isStartSent=!1,this.isJoinSent=!1,this.isPaused=!1,this.isSeeking=!1,this.isBuffering=!1,this.isErrorSent=!1,this.isShowingAds=!1,this.isAdStartSent=!1,this.isAdJoinSent=!1,this.isAdPaused=!1,this.isAdBuffering=!1,this.chrono={joinTime:new t.utils.Chrono,seek:new t.utils.Chrono,pause:new t.utils.Chrono,buffer:new t.utils.Chrono,adIgnore:new t.utils.Chrono,adTotal:new t.utils.Chrono,adJoinTime:new t.utils.Chrono,adPause:new t.utils.Chrono,adBuffer:new t.utils.Chrono},this.adCounter={pre:0,mid:0,post:0,unknown:0};var n=this;this.timer={pinger:new t.utils.Timer(function(e){n.sendPing({diffTime:e})}),playheadMonitor:new t.utils.Timer(function(e){n.checkPlayhead()},t.managers.View.monitoringInterval),adPlayheadMonitor:new t.utils.Timer(function(e){n.checkAdPlayhead()},t.managers.View.monitoringInterval)},this.enableBufferMonitor=!1,this.enableSeekMonitor=!1,this.enableAdBufferMonitor=!1,this.enableAdSeekMonitor=!1,this.lastDuration=0,this.lastPlayhead=0,this.lastAdPosition="",this.lastRendition="",this.lastResume=0,this.changedEntities=[],this.resourceParser=new t.utils.ResourceParser(this),this.comm=new t.comm.Communication(this.infoManager.options.service,this.infoManager.options.httpSecure),this.comm.requestData(this.infoManager.getDataParams())},t.managers.View.prototype.sendRequest=function(e,n,i){try{this.isAllowed(e)&&this.comm.sendRequest(e,n,i)}catch(e){t.error(e)}},t.managers.View.prototype.isAllowed=function(e){return this.infoManager.options.enableAnalytics&&!(e in this.infoManager.options.disabledRequests)},t.managers.View.prototype.isHalted=function(){return this.infoManager.options.haltOnError&&this.isErrorSent},t.managers.View.prototype.sendAdStart=function(e,n){try{this.isHalted()||this.isAdStartSent||(this.isShowingAds=!0,this.isAdStartSent=!0,this.chrono.adTotal.start(),this.chrono.adJoinTime.start(),this.sendSeekEnd(),this.sendBufferEnd(),e=this.infoManager.getAdStartParams(e),e.number="undefined"!=typeof e.number?e.number:this.getAdNumber(e.position,!0),this.lastAdPosition=e.position,this.sendRequest("/adStart",e,n),t.noticeRequest("Request: NQS /adStart "+e.position+e.number))}catch(e){t.error(e)}},t.managers.View.prototype.sendAdJoin=function(e,n){try{this.isHalted()||this.isAdStartSent&&!this.isAdJoinSent&&(this.isAdJoinSent=!0,(this.enableAdBufferMonitor||this.enableAdSeekMonitor)&&(this.timer.adPlayheadMonitor.start(),this.lastPlayhead=0),e=this.infoManager.getAdJoinParams(e),e.duration="undefined"!=typeof e.duration?e.duration:this.chrono.adJoinTime.getDeltaTime(),e.position="undefined"!=typeof e.position?e.position:this.lastAdPosition,e.number="undefined"!=typeof e.number?e.number:this.getAdNumber(e.position),this.sendRequest("/adJoinTime",e,n),t.noticeRequest("Request: NQS /adJoinTime "+e.duration+"ms"))}catch(e){t.error(e)}},t.managers.View.prototype.sendAdStop=function(e,n){try{this.isHalted()||this.isAdStartSent&&(this.isAdStartSent=!1,this.isAdJoinSent=!1,this.isAdBuffering=!1,this.isShowingAds=!1,this.timer.adPlayheadMonitor.stop(),e=this.infoManager.getAdStopParams(e),e.totalDuration="undefined"!=typeof e.totalDuration?e.totalDuration:this.chrono.adTotal.getDeltaTime(),e.position="undefined"!=typeof e.position?e.position:this.lastAdPosition,e.number="undefined"!=typeof e.number?e.number:this.getAdNumber(e.position),e.adPlayhead||delete e.adPlayhead,this.isJoinSent||(this.chrono.joinTime.startTime+=this.chrono.adTotal.getDeltaTime(),this.chrono.joinTime.startTime=Math.min(this.chrono.joinTime.startTime,(new Date).getTime())),this.sendRequest("/adStop",e,n),t.noticeRequest("Request: NQS /adStop "+e.totalDuration+"ms"))}catch(e){t.error(e)}},t.managers.View.prototype.sendAdPause=function(e,n){try{this.isHalted()||this.isAdJoinSent&&!this.isAdPaused&&(this.isAdPaused=!0,this.chrono.adPause.start(),e=this.infoManager.getAdPauseParams(e),e.position="undefined"!=typeof e.position?e.position:this.lastAdPosition,e.number="undefined"!=typeof e.number?e.number:this.getAdNumber(e.position),this.sendRequest("/adPause",e,n),t.noticeRequest("Request: NQS /adPause"))}catch(e){t.error(e)}},t.managers.View.prototype.sendAdResume=function(e,n){try{this.isHalted()||this.isAdJoinSent&&this.isAdPaused&&(this.isAdPaused=!1,this.chrono.adPause.stop(),e=this.infoManager.getAdResumeParams(e),e.position="undefined"!=typeof e.position?e.position:this.lastAdPosition,e.number="undefined"!=typeof e.number?e.number:this.getAdNumber(e.position),this.sendRequest("/adResume",e,n),t.noticeRequest("Request: NQS /adResume"))}catch(e){t.error(e)}},t.managers.View.prototype.sendAdBufferStart=function(){try{this.isHalted()||this.isAdJoinSent&&!this.isAdBuffering&&(this.isAdBuffering=!0,this.chrono.adBuffer.start(),t.noticeRequest("Method: /adBufferStart"))}catch(e){t.error(e)}},t.managers.View.prototype.sendAdBufferEnd=function(e,n){try{this.isHalted()||this.isAdJoinSent&&this.isAdBuffering&&(this.isAdBuffering=!1,e=this.infoManager.getAdBufferEndParams(e),e.duration="undefined"!=typeof e.duration?e.duration:this.chrono.adBuffer.getDeltaTime(),e.position="undefined"!=typeof e.position?e.position:this.lastAdPosition,e.number="undefined"!=typeof e.number?e.number:this.getAdNumber(e.position),this.sendRequest("/adBufferUnderrun",e,n),t.noticeRequest("Request: NQS /adBufferUnderrun "+e.duration+"ms"))}catch(e){t.error(e)}},t.managers.View.prototype.getAdNumber=function(e,t){switch(e){case"pre":return t?++this.adCounter.pre:this.adCounter.pre;case"mid":return t?++this.adCounter.mid:this.adCounter.mid;case"post":return t?++this.adCounter.post:this.adCounter.post;default:return t?++this.adCounter.unknown:this.adCounter.unknown}},t.managers.View.prototype.resetAdNumbers=function(){this.adCounter={pre:0,mid:0,post:0,unknown:0}},t.managers.View.prototype.sendIgnoreAdStart=function(){try{this.isHalted()||this.isStartSent&&!this.isShowingAds&&(this.isShowingAds=!0,this.chrono.adIgnore.start(),this.sendBufferEnd(),this.sendSeekEnd(),t.noticeRequest("Method: /genericAdStart"))}catch(e){t.error(e)}},t.managers.View.prototype.sendIgnoreAdEnd=function(){try{this.isHalted()||this.isStartSent&&this.isShowingAds&&(this.isShowingAds=!1,this.chrono.adIgnore.stop(),this.isJoinSent||(this.chrono.joinTime.startTime+=this.chrono.adIgnore.getDeltaTime(),this.chrono.joinTime.startTime=Math.min(this.chrono.joinTime.startTime,(new Date).getTime())),t.noticeRequest("Method: /genericAdEnd "+this.chrono.adIgnore.getDeltaTime()+"ms"))}catch(e){t.error(e)}},t.managers.View.prototype.sendStart=function(e,n){try{this.isHalted()||this.isStartSent||((this.infoManager.options.parseCDNNodeHost||this.infoManager.options.parseHLS)&&this.resourceParser.init(),this.isStartSent=!0,this.chrono.joinTime.start(),t.noticeRequest("Sending pings every "+this.comm.pingTime+"s."),this.timer.pinger.interval=Math.max(1e3,1e3*this.comm.pingTime),this.timer.pinger.start(),e=this.infoManager.getStartParams(e),e.pingTime="undefined"!=typeof e.pingTime?e.pingTime:this.comm.pingTime,this.infoManager.options.parseCDNNodeHost&&(e.nodeHost="undefined"!=typeof e.nodeHost?e.nodeHost:"undefined"!=typeof this.resourceParser.nodeHost?this.resourceParser.nodeHost:"",e.nodeType="undefined"!=typeof e.nodeType?e.nodeType:"undefined"!=typeof this.resourceParser.nodeType?this.resourceParser.nodeType:""),this.comm.nextView(e.live),this.sendRequest("/start",e,n),t.noticeRequest("Request: NQS /start "+e.resource),this.lastDuration=e.duration,this.lastRendition=e.rendition)}catch(e){t.error(e)}},t.managers.View.prototype.sendJoin=function(e,n){try{this.isHalted()||!this.isStartSent||this.isJoinSent||this.isShowingAds||(this.isJoinSent=!0,(this.enableBufferMonitor||this.enableSeekMonitor)&&(this.timer.playheadMonitor.start(),this.lastPlayhead=0),e=this.infoManager.getJoinParams(e),e.time="undefined"!=typeof e.time?e.time:this.chrono.joinTime.getDeltaTime(),e.mediaDuration===this.lastDuration&&delete e.mediaDuration,this.sendRequest("/joinTime",e,n),t.noticeRequest("Request: NQS /joinTime "+e.time+"ms"))}catch(e){t.error(e)}},t.managers.View.prototype.sendStop=function(e,n){try{this.isHalted()||this.isStartSent&&(this.isStartSent=!1,this.isPaused=!1,this.isJoinSent=!1,this.isSeeking=!1,this.isBuffering=!1,this.resourceParser.clear(),this.resetAdNumbers(),this.stopTimers(),e=this.infoManager.getStopParams(e),e.diffTime="undefined"!=typeof e.diffTime?e.diffTime:this.timer.pinger.chrono.getDeltaTime(),this.sendRequest("/stop",e,n),t.noticeRequest("Request: NQS /stop"))}catch(e){t.error(e)}},t.managers.View.prototype.sendPause=function(e,n){try{this.isHalted()||this.isJoinSent&&!this.isPaused&&(this.isPaused=!0,this.chrono.pause.start(),e=this.infoManager.getPauseParams(e),this.sendRequest("/pause",e,n),t.noticeRequest("Request: NQS /pause"))}catch(e){t.error(e)}},t.managers.View.prototype.sendResume=function(e,n){try{this.isHalted()||this.isJoinSent&&this.isPaused&&(this.isPaused=!1,this.chrono.pause.stop(),this.lastResume=(new Date).getTime(),e=this.infoManager.getResumeParams(e),this.sendRequest("/resume",e,n),t.noticeRequest("Request: NQS /resume"))}catch(e){t.error(e)}},t.managers.View.prototype.sendBufferStart=function(){try{this.isHalted()||this.isJoinSent&&!this.isBuffering&&(this.isBuffering=!0,this.chrono.buffer.start(),t.noticeRequest("Method: /bufferStart"))}catch(e){t.error(e)}},t.managers.View.prototype.sendBufferEnd=function(e,n){try{this.isHalted()||this.isJoinSent&&this.isBuffering&&(this.isBuffering=!1,e=this.infoManager.getBufferEndParams(e),e.duration="undefined"!=typeof e.duration?e.duration:this.chrono.buffer.getDeltaTime(),this.sendRequest("/bufferUnderrun",e,n),t.noticeRequest("Request: NQS /bufferUnderrun "+e.duration+"ms"))}catch(e){t.error(e)}},t.managers.View.prototype.sendSeekStart=function(){try{this.isHalted()||this.isJoinSent&&!this.isSeeking&&(this.isSeeking=!0,this.chrono.seek.start(),t.noticeRequest("Method: /seekStart"))}catch(e){t.error(e)}},t.managers.View.prototype.sendSeekEnd=function(e,n){try{this.isHalted()||this.isJoinSent&&this.isSeeking&&(this.isSeeking=!1,e=this.infoManager.getSeekEndParams(e),e.duration="undefined"!=typeof e.duration?e.duration:this.chrono.seek.getDeltaTime(),this.sendRequest("/seek",e,n),t.noticeRequest("Request: NQS /seek "+e.duration+"ms"))}catch(e){t.error(e)}},t.managers.View.prototype.sendError=function(e,n){try{this.isErrorSent=!0,this.infoManager.options.haltOnError&&this.stopTimers(),e=this.infoManager.getErrorParams(e),e.pingTime="undefined"!=typeof e.pingTime?e.pingTime:this.comm.pingTime,this.infoManager.options.parseCDNNodeHost&&(e.nodeHost="undefined"!=typeof e.nodeHost?e.nodeHost:"undefined"!=typeof this.resourceParser.nodeHost?this.resourceParser.nodeHost:"",e.nodeType="undefined"!=typeof e.nodeType?e.nodeType:"undefined"!=typeof this.resourceParser.nodeType?this.resourceParser.nodeType:""),this.sendRequest("/error",e,n),t.noticeRequest("Request: NQS /error "+e.msg)}catch(e){t.error(e)}},t.managers.View.prototype.convertBufferToSeek=function(){try{t.noticeRequest("Converting buffer to seek"),this.chrono.seek.startTime=this.chrono.buffer.startTime,this.chrono.seek.lastTime=0,this.chrono.buffer.stop(),this.isBuffering=!1,this.isSeeking=!0}catch(e){t.error(e)}},t.managers.View.monitoringInterval=800,t.managers.View.prototype.jumpNextTick=!1,t.managers.View.prototype.checkPlayhead=function(){if(this.isJoinSent&&!this.isShowingAds){var e=2*t.managers.View.monitoringInterval,n=t.managers.View.monitoringInterval/2,i=1.1*t.managers.View.monitoringInterval,r=this.infoManager.getPlayhead(),o=1e3*Math.abs(this.lastPlayhead-r);if(o<n){var a=this.lastResume?Math.abs((new Date).getTime()-this.lastResume):0;this.enableBufferMonitor&&(0==a||a>t.managers.View.monitoringInterval)&&this.lastPlayhead>0&&!this.isBuffering&&!this.isPaused&&!this.isSeeking&&this.sendBufferStart()}else o>e?this.enableSeekMonitor&&this.lastPlayhead>0&&!this.IsSeeking&&(this.isBuffering?this.convertBufferToSeek():this.sendSeekStart()):this.isSeeking&&this.enableSeekMonitor?this.sendSeekEnd():this.isBuffering&&this.enableBufferMonitor&&this.chrono.buffer.getDeltaTime(!1)>i&&this.sendBufferEnd();this.lastPlayhead=r}},t.managers.View.prototype.checkAdPlayhead=function(){if(this.isAdJoinSent){var e=t.managers.View.monitoringInterval/2,n=1.1*t.managers.View.monitoringInterval,i=this.infoManager.getAdPlayhead(),r=1e3*Math.abs(this.lastPlayhead-i);r<e?this.enableAdBufferMonitor&&this.lastPlayhead>0&&!this.isAdBuffering&&!this.isAdPaused&&this.sendAdBufferStart():this.isAdBuffering&&this.chrono.adBuffer.getDeltaTime(!1)>n&&this.sendAdBufferEnd(),this.lastPlayhead=i}},t.managers.View.prototype.stopTimers=function(){this.timer.pinger.stop(),this.timer.playheadMonitor.stop(),this.timer.adPlayheadMonitor.stop()},t.managers.View.prototype.sendPing=function(e,n){try{e=this.infoManager.getPingParams(e),this.isShowingAds&&(e=this.infoManager.getAdPingParams(e)),e.pingTime="undefined"!=typeof e.pingTime?e.pingTime:this.comm.pingTime,this.isSeeking&&(e.seekDuration="undefined"!=typeof e.seekDuration?e.seekDuration:this.chrono.seek.getDeltaTime(!1)),this.isBuffering&&(e.bufferDuration="undefined"!=typeof e.bufferDuration?e.bufferDuration:this.chrono.buffer.getDeltaTime(!1)),this.isAdBuffering&&(e.adBufferDuration="undefined"!=typeof e.adBufferDuration?e.adBufferDuration:this.chrono.adBuffer.getDeltaTime(!1));var i=this.infoManager.getRendition();if(i&&this.lastRendition!=i&&(this.sendChangedEntity("rendition",i),this.lastRendition=i),1==this.changedEntities.length){var r=this.changedEntities.shift();e.entityType=r.key,e.entityValue=r.value}else this.changedEntities.length>1&&(e.entityType=null,e.entityValue=JSON.stringify(this.changedEntities),this.changedEntities={});this.sendRequest("/ping",e,n)}catch(e){t.error(e)}},t.managers.View.prototype.sendChangedEntity=function(e,n){try{this.changedEntities.push({key:e,value:n})}catch(e){t.error(e)}},t.utils.Chrono=function(){try{this.startTime=0,this.lastTime=0}catch(e){t.error(e)}},t.utils.Chrono.prototype.getDeltaTime=function(e){try{return this.startTime?0===this.lastTime?e!==!1?this.stop():(new Date).getTime()-this.startTime:this.lastTime-this.startTime:-1}catch(e){t.error(e)}},t.utils.Chrono.prototype.start=function(){try{this.startTime=(new Date).getTime(),this.lastTime=0}catch(e){t.error(e)}},t.utils.Chrono.prototype.stop=function(){try{return this.lastTime=(new Date).getTime(),this.getDeltaTime()}catch(e){t.error(e)}},t.utils.parseNumber=function(e,t){return!isNaN(e)&&e>=0&&e!=1/0&&null!==e&&"undefined"!=typeof e?e:t},t.utils.listenAllEvents=function(e,n,i){try{if(t.debugLevel>=4){i=i||function(e){var n="";"undefined"!=typeof e.target&&"undefined"!=typeof e.target.id&&(n=e.target.id),t.debug("Event: "+n+" > "+e.type)};var r=["canplay","buffering","waiting","ended","play","playing","pause","resume","error","abort","seek","seeking","seeked","stalled","dispose","loadeddata","loadstart"];n&&(null===n[0]?(n.shift(),r=n):r=r.concat(n));for(var o=0;o<r.length;o++)"function"==typeof e?e.call(window,r[o],i):e.on?e.on(r[o],i):e.addEventListener&&e.addEventListener(r[o],i)}}catch(e){t.error(e)}},t.utils.buildRenditionString=function(e,t,n){1==arguments.length&&(n=e,e=null,t=null);var i="";return e&&t&&(i=e+"x"+t,n>0&&(i+="@")),n<1?i:(n<1e3?i+=Math.round(n)+"bps":n<1e6?(n=Math.round(n/1e3),i+=n+"Kbps"):(n=Math.round(n/1e4)/100,i+=n+"Mbps"),i)},t.debugLevel=2,t.messageLevels={1:"e",2:"w",3:"n",4:"d",5:"v"},t.plainConsole=!1,t.report=function(e,n,i){if(console&&console.log){n=n||4,i=i||"darkcyan";var r=t.messageLevels[n],o=t.getCurrentTime()+"[Youbora] "+r+":";if("undefined"!=typeof t.remoteLog&&t.remoteLog.enabled===!0&&t.remoteLog(o+e),t.debugLevel>=n)if(t.plainConsole||document.documentMode)t.plainReport(e,o);else{var a=console.log;1==n&&console.error?a=console.error:2==n&&console.warn?a=console.warn:n>=4&&console.debug&&(a=console.debug),o="%c"+o,e instanceof Array?(e.splice(0,0,o,"color: "+i),a.apply(console,e)):a.call(console,o,"color: "+i,e)}}},t.getCurrentTime=function(e){var t=new Date;return"["+("0"+t.getDate()).slice(-2)+":"+("0"+t.getMinutes()).slice(-2)+":"+("0"+t.getSeconds()).slice(-2)+"."+("00"+t.getMilliseconds()).slice(-3)+"]"},t.plainReport=function(e,n){if(e instanceof Array)for(var i in e)t.plainReport(e[i],n)},t.error=function(){t.report([].slice.call(arguments),1,"darkred")},t.warn=function(){t.report([].slice.call(arguments),2,"darkorange")},t.notice=function(){t.report([].slice.call(arguments),3,"darkcyan")},t.noticeRequest=function(){t.report([].slice.call(arguments),3,"darkgreen")},t.debug=function(){t.report([].slice.call(arguments),4,"indigo")},t.verbose=function(){t.report([].slice.call(arguments),5,"navy")},function(){try{if("undefined"!=typeof window){var e=function(e){switch(e){case"plain":t.plainConsole=!0;break;case"remote":t.remoteLog.forced=!0;break;case"plain+remote":case"remote+plain":t.remoteLog.forced=!0,t.plainConsole=!0}},n=document.getElementsByTagName("script");for(var i in n)if(n[i].getAttribute){var r=n[i].getAttribute("youbora-debug");r&&(t.debugLevel=r),r=n[i].getAttribute("youbora-console"),r&&e(r)}var o=/\?.*\&*youbora-debug=(.+)/i.exec(window.location.search);null!==o&&(t.debugLevel=o[1]),o=/\?.*\&*youbora-console=(.+)/i.exec(window.location.search),null!==o&&e(o[1])}}catch(e){t.error(e)}}(),t.utils.ResourceParser=function(e){try{this.viewManager=e,this.parseTimeout=null,this.realResource="",this.nodeHost=void 0,this.nodeType=void 0,this.cdnRequests={},this.cdns=t.utils.ResourceParser.cdnsEnabled.slice()}catch(e){t.error(e)}},t.utils.ResourceParser.prototype.init=function(){try{this.realResource&&this.clear(),this.viewManager.comm.addPreloader("ResourceParser");var e=this;this.viewManager.comm.extraOperationsCallback=function(t){"undefined"!=typeof t.resource&&e.realResource&&(t.resource=e.realResource),"undefined"!=typeof t.nodeHost&&e.nodeHost&&(t.nodeHost=e.nodeHost,t.nodeType=e.nodeType)},this.parseTimeout=setTimeout(function(){"ResourceParser"in e.viewManager.comm.preloaders&&(e.realResource=e.viewManager.infoManager.getResource(),e.viewManager.comm.removePreloader("ResourceParser"),t.warn("ResourceParser has exceded the maximum execution time (3s) and will be aborted."))},3e3),this.realResource=this.viewManager.infoManager.getResource(),this.viewManager.infoManager.options.parseHLS?this._parseRealResourceAsync(this.realResource):this._parseCDNAsync()}catch(e){t.error(e)}},t.utils.ResourceParser.prototype.clear=function(){this.realResource="",this.nodeHost=void 0,this.nodeType=void 0,this.cdnRequests={},this.cdns=t.utils.ResourceParser.cdnsEnabled.slice()},t.utils.ResourceParser.prototype._parseRealResourceAsync=function(e,n){try{var i=/(\S*?(\.m3u8|\.m3u|\.ts|\.mp4)(\?\S*|\n|\r|$))/i.exec(e);if(null!==i){var r=i[1].trim();if(0!==r.indexOf("http")&&(r=n.slice(0,n.lastIndexOf("/"))+"/"+r),".m3u8"==i[2]||".m3u"==i[2]){var o=this;new t.comm.AjaxRequest(r).load(function(){o._parseRealResourceAsync(this.responseText,r)}).error(function(){o._parseCDNAsync()}).send()}else this.realResource=r,this._parseCDNAsync()}else this._parseCDNAsync()}catch(e){t.error(e),this._parseCDNAsync()}},t.utils.ResourceParser.cdnsEnabled=["Level3","Akamai","Highwinds","Fastly"],t.utils.ResourceParser.cdnsAvailable={Level3:{parsers:[{type:"host+type",name:"X-WR-DIAG",regex:/Host:(.+)\sType:(.+)/}],headers:{"X-WR-DIAG":"host"}},Akamai:{parsers:[{type:"host+type",name:"X-Cache",regex:/(.+)\sfrom\s.+\(.+\/(.+)\).+/}]},Highwinds:{parsers:[{type:"host+type",name:"X-HW",regex:/.+,[0-9]+\.(.+)\.(.+)/}]},Fastly:{parsers:[{type:"host",name:"X-Served-By",regex:/([^,\s]+)$/},{type:"type",name:"X-Cache",regex:/([^,\s]+)$/}]}},t.utils.ResourceParser.prototype._parseCDNAsync=function(){try{if(this.viewManager.infoManager.options.parseCDNNodeHost)if(this.cdns.length>0&&!this.nodeHost){var e=this.cdns.shift();if("undefined"!=typeof t.utils.ResourceParser.cdnsAvailable[e]){var n=t.utils.ResourceParser.cdnsAvailable[e],i=JSON.stringify(n.headers);if(this.cdnRequests.hasOwnProperty(i))this._parseNode(n.parsers,this.cdnRequests[i]);else{var r=this,o=new t.comm.AjaxRequest(this.realResource,"","",{method:"HEAD",maxRetries:0,requestHeaders:n.headers});o.load(function(){r.cdnRequests[i]=o.getXHR(),r._parseNode(n.parsers,o.getXHR())}),o.error(function(){r._parseCDNAsync()}),o.send()}}else this._parseCDNAsync()}else this.viewManager.comm.removePreloader("ResourceParser");else this.viewManager.comm.removePreloader("ResourceParser")}catch(e){t.error(e)}},t.utils.ResourceParser.prototype._parseNode=function(e,n){try{for(var i in e){var r=n.getResponseHeader(e[i].name);if(null===r)return void this._parseCDNAsync();var o=e[i].regex.exec(r);if(null===o)return void this._parseCDNAsync();switch(e[i].type){case"host":this.nodeHost=o[1];break;case"type":this.nodeType=this._parseNodeType(o[1]);break;case"host+type":this.nodeHost=o[1],this.nodeType=this._parseNodeType(o[2]);break;case"type+host":this.nodeType=this._parseNodeType(o[1]),this.nodeHost=o[2]}}this._parseCDNAsync()}catch(e){t.error(e),this._parseCDNAsync()}},t.utils.ResourceParser.prototype._parseNodeType=function(e){try{switch(e){case"TCP_HIT":case"HIT":case"c":return 1;case"TCP_MISS":case"MISS":case"p":return 2;case"TCP_MEM_HIT":return 3;case"TCP_IMS_HIT":return 4;default:return 0}}catch(e){return t.error(e),0}},t.utils.Timer=function(e,n){try{this.callback=e,this.interval=n||5e3,this.isRunning=!1,this.timer=null,this.chrono=new t.utils.Chrono}catch(e){t.error(e)}},t.utils.Timer.prototype.start=function(){try{this.isRunning=!0,this._setPing()}catch(e){t.error(e)}},t.utils.Timer.prototype.stop=function(){try{this.isRunning=!1,clearTimeout(this.timer)}catch(e){t.error(e)}},t.utils.Timer.prototype._setPing=function(){try{if(this.isRunning){this.chrono.start();var e=this;this.timer=setTimeout(function(){e.callback(e.chrono.stop()),e._setPing()},this.interval)}}catch(e){t.error(e)}},"undefined"!=typeof e&&e.exports?e.exports=t:window.$YB=t}),Pt=e(Et),At={false:!1,LIB_VERSION:"2.9.16"};Tt="undefined"==typeof window?{navigator:{}}:window;var Mt=Array.prototype,Lt=Function.prototype,Ot=Object.prototype,Ct=Mt.slice,It=Ot.toString,qt=Ot.hasOwnProperty,Rt=Tt.console,Ft=Tt.navigator,Bt=Tt.document,Dt=Ft.userAgent,Nt=Lt.bind,Ht=Mt.forEach,Vt=Mt.indexOf,jt=Array.isArray,zt={},Ut={
trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},Wt={log:function(){if(At.false&&!Ut.isUndefined(Rt)&&Rt)try{Rt.log.apply(Rt,arguments)}catch(e){Ut.each(arguments,function(e){Rt.log(e)})}},error:function(){if(At.false&&!Ut.isUndefined(Rt)&&Rt){var e=["Mixpanel error:"].concat(Ut.toArray(arguments));try{Rt.error.apply(Rt,e)}catch(t){Ut.each(e,function(e){Rt.error(e)})}}},critical:function(){if(!Ut.isUndefined(Rt)&&Rt){var e=["Mixpanel error:"].concat(Ut.toArray(arguments));try{Rt.error.apply(Rt,e)}catch(t){Ut.each(e,function(e){Rt.error(e)})}}}};Ut.bind=function(e,t){var n,i;if(Nt&&e.bind===Nt)return Nt.apply(e,Ct.call(arguments,1));if(!Ut.isFunction(e))throw new TypeError;return n=Ct.call(arguments,2),i=function(){if(!(this instanceof i))return e.apply(t,n.concat(Ct.call(arguments)));var r={};r.prototype=e.prototype;var o=new r;r.prototype=null;var a=e.apply(o,n.concat(Ct.call(arguments)));return Object(a)===a?a:o}},Ut.bind_instance_methods=function(e){for(var t in e)"function"==typeof e[t]&&(e[t]=Ut.bind(e[t],e))},Ut.each=function(e,t,n){if(null!==e&&void 0!==e)if(Ht&&e.forEach===Ht)e.forEach(t,n);else if(e.length===+e.length){for(var i=0,r=e.length;i<r;i++)if(i in e&&t.call(n,e[i],i,e)===zt)return}else for(var o in e)if(qt.call(e,o)&&t.call(n,e[o],o,e)===zt)return},Ut.escapeHTML=function(e){var t=e;return t&&Ut.isString(t)&&(t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")),t},Ut.extend=function(e){return Ut.each(Ct.call(arguments,1),function(t){for(var n in t)void 0!==t[n]&&(e[n]=t[n])}),e},Ut.isArray=jt||function(e){return"[object Array]"===It.call(e)},Ut.isFunction=function(e){try{return/^\s*\bfunction\b/.test(e)}catch(e){return!1}},Ut.isArguments=function(e){return!(!e||!qt.call(e,"callee"))},Ut.toArray=function(e){return e?e.toArray?e.toArray():Ut.isArray(e)?Ct.call(e):Ut.isArguments(e)?Ct.call(e):Ut.values(e):[]},Ut.values=function(e){var t=[];return null===e?t:(Ut.each(e,function(e){t[t.length]=e}),t)},Ut.identity=function(e){return e},Ut.include=function(e,t){var n=!1;return null===e?n:Vt&&e.indexOf===Vt?e.indexOf(t)!=-1:(Ut.each(e,function(e){if(n||(n=e===t))return zt}),n)},Ut.includes=function(e,t){return e.indexOf(t)!==-1},Ut.inherit=function(e,t){return e.prototype=new t,e.prototype.constructor=e,e.superclass=t.prototype,e},Ut.isObject=function(e){return e===Object(e)&&!Ut.isArray(e)},Ut.isEmptyObject=function(e){if(Ut.isObject(e)){for(var t in e)if(qt.call(e,t))return!1;return!0}return!1},Ut.isUndefined=function(e){return void 0===e},Ut.isString=function(e){return"[object String]"==It.call(e)},Ut.isDate=function(e){return"[object Date]"==It.call(e)},Ut.isNumber=function(e){return"[object Number]"==It.call(e)},Ut.isElement=function(e){return!(!e||1!==e.nodeType)},Ut.encodeDates=function(e){return Ut.each(e,function(t,n){Ut.isDate(t)?e[n]=Ut.formatDate(t):Ut.isObject(t)&&(e[n]=Ut.encodeDates(t))}),e},Ut.timestamp=function(){return Date.now=Date.now||function(){return+new Date},Date.now()},Ut.formatDate=function(e){function t(e){return e<10?"0"+e:e}return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())},Ut.safewrap=function(e){return function(){try{return e.apply(this,arguments)}catch(e){Wt.critical("Implementation error. Please contact support@mixpanel.com.")}}},Ut.safewrap_class=function(e,t){for(var n=0;n<t.length;n++)e.prototype[t[n]]=Ut.safewrap(e.prototype[t[n]])},Ut.safewrap_instance_methods=function(e){for(var t in e)"function"==typeof e[t]&&(e[t]=Ut.safewrap(e[t]))},Ut.strip_empty_properties=function(e){var t={};return Ut.each(e,function(e,n){Ut.isString(e)&&e.length>0&&(t[n]=e)}),t},Ut.truncate=function(e,t){var n;return"string"==typeof e?n=e.slice(0,t):Ut.isArray(e)?(n=[],Ut.each(e,function(e){n.push(Ut.truncate(e,t))})):Ut.isObject(e)?(n={},Ut.each(e,function(e,i){n[i]=Ut.truncate(e,t)})):n=e,n},Ut.JSONEncode=function(){return function(e){var t=e,n=function(e){var t=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,n={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return t.lastIndex=0,t.test(e)?'"'+e.replace(t,function(e){var t=n[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'},i=function(e,t){var r="",o="    ",a=0,s="",c="",u=0,d=r,l=[],f=t[e];switch(f&&"object"==typeof f&&"function"==typeof f.toJSON&&(f=f.toJSON(e)),typeof f){case"string":return n(f);case"number":return isFinite(f)?String(f):"null";case"boolean":case"null":return String(f);case"object":if(!f)return"null";if(r+=o,l=[],"[object Array]"===It.apply(f)){for(u=f.length,a=0;a<u;a+=1)l[a]=i(a,f)||"null";return c=0===l.length?"[]":r?"[\n"+r+l.join(",\n"+r)+"\n"+d+"]":"["+l.join(",")+"]",r=d,c}for(s in f)qt.call(f,s)&&(c=i(s,f),c&&l.push(n(s)+(r?": ":":")+c));return c=0===l.length?"{}":r?"{"+l.join(",")+d+"}":"{"+l.join(",")+"}",r=d,c}};return i("",{"":t})}}(),Ut.JSONDecode=function(){var e,t,n,i,r={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},o=function(t){throw{name:"SyntaxError",message:t,at:e,text:n}},a=function(i){return i&&i!==t&&o("Expected '"+i+"' instead of '"+t+"'"),t=n.charAt(e),e+=1,t},s=function(){var e,n="";for("-"===t&&(n="-",a("-"));t>="0"&&t<="9";)n+=t,a();if("."===t)for(n+=".";a()&&t>="0"&&t<="9";)n+=t;if("e"===t||"E"===t)for(n+=t,a(),"-"!==t&&"+"!==t||(n+=t,a());t>="0"&&t<="9";)n+=t,a();return e=+n,isFinite(e)?e:void o("Bad number")},c=function(){var e,n,i,s="";if('"'===t)for(;a();){if('"'===t)return a(),s;if("\\"===t)if(a(),"u"===t){for(i=0,n=0;n<4&&(e=parseInt(a(),16),isFinite(e));n+=1)i=16*i+e;s+=String.fromCharCode(i)}else{if("string"!=typeof r[t])break;s+=r[t]}else s+=t}o("Bad string")},u=function(){for(;t&&t<=" ";)a()},d=function(){switch(t){case"t":return a("t"),a("r"),a("u"),a("e"),!0;case"f":return a("f"),a("a"),a("l"),a("s"),a("e"),!1;case"n":return a("n"),a("u"),a("l"),a("l"),null}o('Unexpected "'+t+'"')},l=function(){var e=[];if("["===t){if(a("["),u(),"]"===t)return a("]"),e;for(;t;){if(e.push(i()),u(),"]"===t)return a("]"),e;a(","),u()}}o("Bad array")},f=function(){var e,n={};if("{"===t){if(a("{"),u(),"}"===t)return a("}"),n;for(;t;){if(e=c(),u(),a(":"),Object.hasOwnProperty.call(n,e)&&o('Duplicate key "'+e+'"'),n[e]=i(),u(),"}"===t)return a("}"),n;a(","),u()}}o("Bad object")};return i=function(){switch(u(),t){case"{":return f();case"[":return l();case'"':return c();case"-":return s();default:return t>="0"&&t<="9"?s():d()}},function(r){var a;return n=r,e=0,t=" ",a=i(),u(),t&&o("Syntax error"),a}}(),Ut.base64Encode=function(e){var t,n,i,r,o,a,s,c,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",d=0,l=0,f="",h=[];if(!e)return e;e=Ut.utf8Encode(e);do t=e.charCodeAt(d++),n=e.charCodeAt(d++),i=e.charCodeAt(d++),c=t<<16|n<<8|i,r=c>>18&63,o=c>>12&63,a=c>>6&63,s=63&c,h[l++]=u.charAt(r)+u.charAt(o)+u.charAt(a)+u.charAt(s);while(d<e.length);switch(f=h.join(""),e.length%3){case 1:f=f.slice(0,-2)+"==";break;case 2:f=f.slice(0,-1)+"="}return f},Ut.utf8Encode=function(e){e=(e+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n");var t,n,i,r="",o=0;for(t=n=0,o=e.length,i=0;i<o;i++){var a=e.charCodeAt(i),s=null;a<128?n++:s=a>127&&a<2048?String.fromCharCode(a>>6|192,63&a|128):String.fromCharCode(a>>12|224,a>>6&63|128,63&a|128),null!==s&&(n>t&&(r+=e.substring(t,n)),r+=s,t=n=i+1)}return n>t&&(r+=e.substring(t,e.length)),r},Ut.UUID=function(){var e=function(){for(var e=1*new Date,t=0;e==1*new Date;)t++;return e.toString(16)+t.toString(16)},t=function(){return Math.random().toString(16).replace(".","")},n=function(){function e(e,t){var n,i=0;for(n=0;n<t.length;n++)i|=r[n]<<8*n;return e^i}var t,n,i=Dt,r=[],o=0;for(t=0;t<i.length;t++)n=i.charCodeAt(t),r.unshift(255&n),r.length>=4&&(o=e(o,r),r=[]);return r.length>0&&(o=e(o,r)),o.toString(16)};return function(){var i=(screen.height*screen.width).toString(16);return e()+"-"+t()+"-"+n()+"-"+i+"-"+e()}}(),Ut.isBlockedUA=function(e){return!!/(google web preview|baiduspider|yandexbot|bingbot|googlebot|yahoo! slurp)/i.test(e)},Ut.HTTPBuildQuery=function(e,t){var n,i,r=[];return Ut.isUndefined(t)&&(t="&"),Ut.each(e,function(e,t){n=encodeURIComponent(e.toString()),i=encodeURIComponent(t),r[r.length]=i+"="+n}),r.join(t)},Ut.getQueryParam=function(e,t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n="[\\?&]"+t+"=([^&#]*)",i=new RegExp(n),r=i.exec(e);return null===r||r&&"string"!=typeof r[1]&&r[1].length?"":decodeURIComponent(r[1]).replace(/\+/g," ")},Ut.getHashParam=function(e,t){var n=e.match(new RegExp(t+"=([^&]*)"));return n?n[1]:null},Ut.cookie={get:function(e){for(var t=e+"=",n=Bt.cookie.split(";"),i=0;i<n.length;i++){for(var r=n[i];" "==r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(t))return decodeURIComponent(r.substring(t.length,r.length))}return null},parse:function(e){var t;try{t=Ut.JSONDecode(Ut.cookie.get(e))||{}}catch(e){}return t},set_seconds:function(e,t,n,i,r){var o="",a="",s="";if(i){var c=Bt.location.hostname.match(/[a-z0-9][a-z0-9\-]+\.[a-z\.]{2,6}$/i),u=c?c[0]:"";o=u?"; domain=."+u:""}if(n){var d=new Date;d.setTime(d.getTime()+1e3*n),a="; expires="+d.toGMTString()}r&&(s="; secure"),Bt.cookie=e+"="+encodeURIComponent(t)+a+"; path=/"+o+s},set:function(e,t,n,i,r){var o="",a="",s="";if(i){var c=Bt.location.hostname.match(/[a-z0-9][a-z0-9\-]+\.[a-z\.]{2,6}$/i),u=c?c[0]:"";o=u?"; domain=."+u:""}if(n){var d=new Date;d.setTime(d.getTime()+24*n*60*60*1e3),a="; expires="+d.toGMTString()}r&&(s="; secure");var l=e+"="+encodeURIComponent(t)+a+"; path=/"+o+s;return Bt.cookie=l,l},remove:function(e,t){Ut.cookie.set(e,"",-1,t)}},Ut.localStorage={error:function(e){Wt.error("localStorage error: "+e)},get:function(e){try{return window.localStorage.getItem(e)}catch(e){Ut.localStorage.error(e)}return null},parse:function(e){try{return Ut.JSONDecode(Ut.localStorage.get(e))||{}}catch(e){}return null},set:function(e,t){try{window.localStorage.setItem(e,t)}catch(e){Ut.localStorage.error(e)}},remove:function(e){try{window.localStorage.removeItem(e)}catch(e){Ut.localStorage.error(e)}}},Ut.register_event=function(){function e(e,n,i){var r=function(r){if(r=r||t(window.event)){var o,a,s=!0;return Ut.isFunction(i)&&(o=i(r)),a=n.call(e,r),!1!==o&&!1!==a||(s=!1),s}};return r}function t(e){return e&&(e.preventDefault=t.preventDefault,e.stopPropagation=t.stopPropagation),e}var n=function(t,n,i,r,o){if(!t)return void Wt.error("No valid element provided to register_event");if(t.addEventListener&&!r)t.addEventListener(n,i,!!o);else{var a="on"+n,s=t[a];t[a]=e(t,i,s)}};return t.preventDefault=function(){this.returnValue=!1},t.stopPropagation=function(){this.cancelBubble=!0},n}(),Ut.dom_query=function(){function e(e){return e.all?e.all:e.getElementsByTagName("*")}function t(e,t){var n=" "+t+" ";return(" "+e.className+" ").replace(i," ").indexOf(n)>=0}function n(n){if(!Bt.getElementsByTagName)return[];var i,r,o,a,s,c,u,d,l,f,h=n.split(" "),p=[Bt];for(c=0;c<h.length;c++)if(i=h[c].replace(/^\s+/,"").replace(/\s+$/,""),i.indexOf("#")>-1){r=i.split("#"),o=r[0];var v=r[1],g=Bt.getElementById(v);if(!g||o&&g.nodeName.toLowerCase()!=o)return[];p=[g]}else if(i.indexOf(".")>-1){r=i.split("."),o=r[0];var m=r[1];for(o||(o="*"),a=[],s=0,u=0;u<p.length;u++)for(l="*"==o?e(p[u]):p[u].getElementsByTagName(o),d=0;d<l.length;d++)a[s++]=l[d];for(p=[],f=0,u=0;u<a.length;u++)a[u].className&&Ut.isString(a[u].className)&&t(a[u],m)&&(p[f++]=a[u])}else{var y=i.match(/^(\w*)\[(\w+)([=~\|\^\$\*]?)=?"?([^\]"]*)"?\]$/);if(y){o=y[1];var _=y[2],b=y[3],w=y[4];for(o||(o="*"),a=[],s=0,u=0;u<p.length;u++)for(l="*"==o?e(p[u]):p[u].getElementsByTagName(o),d=0;d<l.length;d++)a[s++]=l[d];p=[],f=0;var k;switch(b){case"=":k=function(e){return e.getAttribute(_)==w};break;case"~":k=function(e){return e.getAttribute(_).match(new RegExp("\\b"+w+"\\b"))};break;case"|":k=function(e){return e.getAttribute(_).match(new RegExp("^"+w+"-?"))};break;case"^":k=function(e){return 0===e.getAttribute(_).indexOf(w)};break;case"$":k=function(e){return e.getAttribute(_).lastIndexOf(w)==e.getAttribute(_).length-w.length};break;case"*":k=function(e){return e.getAttribute(_).indexOf(w)>-1};break;default:k=function(e){return e.getAttribute(_)}}for(p=[],f=0,u=0;u<a.length;u++)k(a[u])&&(p[f++]=a[u])}else{for(o=i,a=[],s=0,u=0;u<p.length;u++)for(l=p[u].getElementsByTagName(o),d=0;d<l.length;d++)a[s++]=l[d];p=a}}return p}var i=/[\t\r\n]/g;return function(e){return Ut.isElement(e)?[e]:Ut.isObject(e)&&!Ut.isUndefined(e.length)?e:n.call(this,e)}}(),Ut.info={campaignParams:function(){var e="utm_source utm_medium utm_campaign utm_content utm_term".split(" "),t="",n={};return Ut.each(e,function(e){t=Ut.getQueryParam(Bt.URL,e),t.length&&(n[e]=t)}),n},searchEngine:function(e){return 0===e.search("https?://(.*)google.([^/?]*)")?"google":0===e.search("https?://(.*)bing.com")?"bing":0===e.search("https?://(.*)yahoo.com")?"yahoo":0===e.search("https?://(.*)duckduckgo.com")?"duckduckgo":null},searchInfo:function(e){var t=Ut.info.searchEngine(e),n="yahoo"!=t?"q":"p",i={};if(null!==t){i.$search_engine=t;var r=Ut.getQueryParam(e,n);r.length&&(i.mp_keyword=r)}return i},browser:function(e,t,n){return t=t||"",n||Ut.includes(e," OPR/")?Ut.includes(e,"Mini")?"Opera Mini":"Opera":/(BlackBerry|PlayBook|BB10)/i.test(e)?"BlackBerry":Ut.includes(e,"IEMobile")||Ut.includes(e,"WPDesktop")?"Internet Explorer Mobile":Ut.includes(e,"Edge")?"Microsoft Edge":Ut.includes(e,"FBIOS")?"Facebook Mobile":Ut.includes(e,"Chrome")?"Chrome":Ut.includes(e,"CriOS")?"Chrome iOS":Ut.includes(e,"FxiOS")?"Firefox iOS":Ut.includes(t,"Apple")?Ut.includes(e,"Mobile")?"Mobile Safari":"Safari":Ut.includes(e,"Android")?"Android Mobile":Ut.includes(e,"Konqueror")?"Konqueror":Ut.includes(e,"Firefox")?"Firefox":Ut.includes(e,"MSIE")||Ut.includes(e,"Trident/")?"Internet Explorer":Ut.includes(e,"Gecko")?"Mozilla":""},browserVersion:function(e,t,n){var i=Ut.info.browser(e,t,n),r={"Internet Explorer Mobile":/rv:(\d+(\.\d+)?)/,"Microsoft Edge":/Edge\/(\d+(\.\d+)?)/,Chrome:/Chrome\/(\d+(\.\d+)?)/,"Chrome iOS":/CriOS\/(\d+(\.\d+)?)/,Safari:/Version\/(\d+(\.\d+)?)/,"Mobile Safari":/Version\/(\d+(\.\d+)?)/,Opera:/(Opera|OPR)\/(\d+(\.\d+)?)/,Firefox:/Firefox\/(\d+(\.\d+)?)/,"Firefox iOS":/FxiOS\/(\d+(\.\d+)?)/,Konqueror:/Konqueror:(\d+(\.\d+)?)/,BlackBerry:/BlackBerry (\d+(\.\d+)?)/,"Android Mobile":/android\s(\d+(\.\d+)?)/,"Internet Explorer":/(rv:|MSIE )(\d+(\.\d+)?)/,Mozilla:/rv:(\d+(\.\d+)?)/},o=r[i];if(void 0===o)return null;var a=e.match(o);return a?parseFloat(a[a.length-2]):null},os:function(){var e=Dt;return/Windows/i.test(e)?/Phone/.test(e)||/WPDesktop/.test(e)?"Windows Phone":"Windows":/(iPhone|iPad|iPod)/.test(e)?"iOS":/Android/.test(e)?"Android":/(BlackBerry|PlayBook|BB10)/i.test(e)?"BlackBerry":/Mac/i.test(e)?"Mac OS X":/Linux/.test(e)?"Linux":""},device:function(e){return/Windows Phone/i.test(e)||/WPDesktop/.test(e)?"Windows Phone":/iPad/.test(e)?"iPad":/iPod/.test(e)?"iPod Touch":/iPhone/.test(e)?"iPhone":/(BlackBerry|PlayBook|BB10)/i.test(e)?"BlackBerry":/Android/.test(e)?"Android":""},referringDomain:function(e){var t=e.split("/");return t.length>=3?t[2]:""},properties:function(){return Ut.extend(Ut.strip_empty_properties({$os:Ut.info.os(),$browser:Ut.info.browser(Dt,Ft.vendor,window.opera),$referrer:Bt.referrer,$referring_domain:Ut.info.referringDomain(Bt.referrer),$device:Ut.info.device(Dt)}),{$current_url:window.location.href,$browser_version:Ut.info.browserVersion(Dt,Ft.vendor,window.opera),$screen_height:screen.height,$screen_width:screen.width,mp_lib:"web",$lib_version:At.LIB_VERSION})},people_properties:function(){return Ut.extend(Ut.strip_empty_properties({$os:Ut.info.os(),$browser:Ut.info.browser(Dt,Ft.vendor,window.opera)}),{$browser_version:Ut.info.browserVersion(Dt,Ft.vendor,window.opera)})},pageviewInfo:function(e){return Ut.strip_empty_properties({mp_page:e,mp_referrer:Bt.referrer,mp_browser:Ut.info.browser(Dt,Ft.vendor,window.opera),mp_platform:Ut.info.os()})}},Ut.toArray=Ut.toArray,Ut.isObject=Ut.isObject,Ut.JSONEncode=Ut.JSONEncode,Ut.JSONDecode=Ut.JSONDecode,Ut.isBlockedUA=Ut.isBlockedUA,Ut.isEmptyObject=Ut.isEmptyObject,Ut.info=Ut.info,Ut.info.device=Ut.info.device,Ut.info.browser=Ut.info.browser,Ut.info.properties=Ut.info.properties;var Gt="__mpced",$t=1,Xt=3,Jt={_initializedTokens:[],_previousElementSibling:function(e){if(e.previousElementSibling)return e.previousElementSibling;do e=e.previousSibling;while(e&&e.nodeType!==$t);return e},_loadScript:function(e,t){var n=document.createElement("script");n.type="text/javascript",n.src=e,n.onload=t;var i=document.getElementsByTagName("script");i.length>0?i[0].parentNode.insertBefore(n,i[0]):document.body.appendChild(n)},_getClassName:function(e){switch(typeof e.className){case"string":return e.className;case"object":return e.className.baseVal||e.getAttribute("class")||"";default:return""}},_getPropertiesFromElement:function(e){var t={classes:this._getClassName(e).split(" "),tag_name:e.tagName.toLowerCase()};if(Ut.includes(["input","select","textarea"],e.tagName.toLowerCase())){var n=this._getFormFieldValue(e);this._includeProperty(e,n)&&(t.value=n)}Ut.each(e.attributes,function(e){t["attr__"+e.name]=e.value});for(var i=1,r=1,o=e;o=this._previousElementSibling(o);)i++,o.tagName===e.tagName&&r++;return t.nth_child=i,t.nth_of_type=r,t},_isTag:function(e,t){return e&&e.tagName&&e.tagName.toLowerCase()===t.toLowerCase()},_shouldTrackDomEvent:function(e,t){if(!e||this._isTag(e,"html")||e.nodeType!==$t)return!1;var n=e.tagName.toLowerCase();switch(n){case"html":return!1;case"form":return"submit"===t.type;case"input":return["button","submit"].indexOf(e.getAttribute("type"))===-1?"change"===t.type:"click"===t.type;case"select":case"textarea":return"change"===t.type;default:return"click"===t.type}},_getDefaultProperties:function(e){return{$event_type:e,$ce_version:1,$host:window.location.host,$pathname:window.location.pathname}},_getInputValue:function(e){var t=null,n=e.type.toLowerCase();switch(n){case"checkbox":e.checked&&(t=[e.value]);break;case"radio":e.checked&&(t=e.value);break;default:t=e.value}return t},_getSelectValue:function(e){var t;if(e.multiple){var n=[];Ut.each(e.querySelectorAll("[selected]"),function(e){n.push(e.value)}),t=n}else t=e.value;return t},_includeProperty:function(e,t){for(var n=e;n.parentNode&&!this._isTag(n,"body");n=n.parentNode){var i=this._getClassName(n).split(" ");if(Ut.includes(i,"mp-sensitive")||Ut.includes(i,"mp-no-track"))return!1}if(Ut.includes(this._getClassName(e).split(" "),"mp-include"))return!0;if(null===t)return!1;var r=e.type||"";switch(r.toLowerCase()){case"hidden":return!1;case"password":return!1}var o=e.name||e.id||"",a=/^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|seccode|securitycode|securitynum|socialsec|socsec|ssn/i;if(a.test(o.replace(/[^a-zA-Z0-9]/g,"")))return!1;if("string"==typeof t){var s=/^(?:(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11}))$/;if(s.test((t||"").replace(/[\- ]/g,"")))return!1;var c=/(^\d{3}-?\d{2}-?\d{4}$)/;if(c.test(t))return!1}return!0},_getFormFieldValue:function(e){var t;switch(e.tagName.toLowerCase()){case"input":t=this._getInputValue(e);break;case"select":t=this._getSelectValue(e);break;default:t=e.value||e.textContent}return this._includeProperty(e,t)?t:null},_getFormFieldProperties:function(e){var t={};return Ut.each(e.elements,function(e){var n=e.getAttribute("name")||e.getAttribute("id");if(null!==n){n="$form_field__"+n;var i=this._getFormFieldValue(e);if(this._includeProperty(e,i)){var r=t[n];void 0!==r?t[n]=[].concat(r,i):t[n]=i}}},this),t},_extractCustomPropertyValue:function(e){var t=[];return Ut.each(document.querySelectorAll(e.css_selector),function(e){["input","select"].indexOf(e.tagName.toLowerCase())>-1?t.push(e.value):e.textContent&&t.push(e.textContent)}),t.join(", ")},_getCustomProperties:function(e){var t={};return Ut.each(this._customProperties,function(n){Ut.each(n.event_selectors,function(i){var r=document.querySelectorAll(i);Ut.each(r,function(i){Ut.includes(e,i)&&(t[n.name]=this._extractCustomPropertyValue(n))},this)},this)},this),t},checkForBackoff:function(e){var t=parseInt(e.getResponseHeader("X-MP-CE-Backoff"));if(!isNaN(t)&&t>0){Ut.timestamp()+1e3*t;Ut.cookie.set_seconds(Gt,!0,t,!0)}},_getEventTarget:function(e){return"undefined"==typeof e.target?e.srcElement:e.target},_trackEvent:function(e,t){var n=this._getEventTarget(e);if(n.nodeType===Xt&&(n=n.parentNode),this._shouldTrackDomEvent(n,e)){for(var i=[n],r=n;r.parentNode&&!this._isTag(r,"body");)i.push(r.parentNode),r=r.parentNode;var o,a,s,c=[],u=!1;if(Ut.each(i,function(e,t){if("a"===e.tagName.toLowerCase()?o=e.getAttribute("href"):"form"===e.tagName.toLowerCase()&&(s=e),!a&&t<5&&e.textContent){var n=Ut.trim(e.textContent);n&&(a=n.replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255))}var i=this._getClassName(e).split(" ");Ut.includes(i,"mp-no-track")&&(u=!0),c.push(this._getPropertiesFromElement(e))},this),u)return!1;var d=Ut.extend(this._getDefaultProperties(e.type),{$elements:c,$el_attr__href:o,$el_text:a},this._getCustomProperties(i));return!s||"submit"!==e.type&&"click"!==e.type||Ut.extend(d,this._getFormFieldProperties(s)),t.track("$web_event",d),!0}},_navigate:function(e){window.location.href=e},_addDomEventHandlers:function(e){var t=Ut.bind(function(t){Ut.cookie.parse(Gt)!==!0&&(t=t||window.event,this._trackEvent(t,e))},this);Ut.register_event(document,"submit",t,!1,!0),Ut.register_event(document,"change",t,!1,!0),Ut.register_event(document,"click",t,!1,!0)},_customProperties:{},init:function(e){if(!document||!document.body){var t=this;return void setTimeout(function(){t.init(e)},500)}var n=e.get_config("token");if(!(this._initializedTokens.indexOf(n)>-1||(this._initializedTokens.push(n),this._maybeLoadEditor(e)))){var i=Ut.bind(function(t){t&&t.config&&t.config.enable_collect_everything===!0?(t.custom_properties&&(this._customProperties=t.custom_properties),e.track("$web_event",Ut.extend({$title:document.title},this._getDefaultProperties("pageview"))),this._addDomEventHandlers(e)):e.__autotrack_enabled=!1},this);e._send_request(e.get_config("decide_host")+"/decide/",{verbose:!0,version:"1",lib:"web",token:n},e._prepare_callback(i))}},_editorParamsFromHash:function(e,t){var n;try{var i=Ut.getHashParam(t,"state");i=JSON.parse(decodeURIComponent(i));var r=Ut.getHashParam(t,"expires_in");n={accessToken:Ut.getHashParam(t,"access_token"),accessTokenExpiresAt:(new Date).getTime()+1e3*Number(r),bookmarkletMode:!!i.bookmarkletMode,projectId:i.projectId,projectOwnerId:i.projectOwnerId,projectToken:i.token,readOnly:i.readOnly,userFlags:i.userFlags,userId:i.userId},window.sessionStorage.setItem("editorParams",JSON.stringify(n)),i.desiredHash?window.location.hash=i.desiredHash:window.history?history.replaceState("",document.title,window.location.pathname+window.location.search):window.location.hash=""}catch(e){}return n},_maybeLoadEditor:function(e){var t=!1;if(Ut.getHashParam(window.location.hash,"state")){var n=Ut.getHashParam(window.location.hash,"state");n=JSON.parse(decodeURIComponent(n)),t="mpeditor"===n.action}var i,r=!!window.sessionStorage.getItem("_mpcehash");return t?i=this._editorParamsFromHash(e,window.location.hash):r?(i=this._editorParamsFromHash(e,window.sessionStorage.getItem("_mpcehash")),window.sessionStorage.removeItem("_mpcehash")):i=JSON.parse(window.sessionStorage.getItem("editorParams")||"{}"),!(!i.projectToken||e.get_config("token")!==i.projectToken)&&(this._loadEditor(e,i),!0)},_editorLoaded:!1,_loadEditor:function(e,t){if(!this._editorLoaded){this._editorLoaded=!0;var n,i="?_ts="+(new Date).getTime(),r=e.get_config("app_host")+"/site_media";return n=At.false?r+"/compiled/reports/collect-everything/editor.js"+i:r+"/bundle-webpack/reports/collect-everything/editor.min.js"+i,this._loadScript(n,function(){window.mp_load_editor(t)}),!0}return!1},enabledForProject:function(e,t,n){t=Ut.isUndefined(t)?10:t,n=Ut.isUndefined(n)?10:n;for(var i=0,r=0;r<e.length;r++)i+=e.charCodeAt(r);return i%t<n},isBrowserSupported:function(){return Ut.isFunction(document.querySelectorAll)}};Ut.bind_instance_methods(Jt),Ut.safewrap_instance_methods(Jt);var Yt,Kt,Qt=0,Zt=1,en="mixpanel",tn="__mps",nn="__mpso",rn="__mpa",on="__mpap",an="__mpu",sn="$set",cn="$set_once",un="$add",dn="$append",ln="$union",fn="$people_distinct_id",hn="__alias",pn="__cmpns",vn="__timers",gn=[tn,nn,rn,on,an,fn,hn,pn,vn],mn="https:"===document.location.protocol?"https://":"http://",yn=window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,_n=!yn&&Dt.indexOf("MSIE")===-1&&Dt.indexOf("Mozilla")===-1,bn={api_host:mn+"api.mixpanel.com",app_host:mn+"mixpanel.com",autotrack:!0,cdn:mn+"cdn.mxpnl.com",cross_subdomain_cookie:!0,persistence:"cookie",persistence_name:"",cookie_name:"",loaded:function(){},store_google:!0,save_referrer:!0,test:!1,verbose:!1,img:!1,track_pageview:!0,debug:!1,track_links_timeout:300,cookie_expiration:365,upgrade:!1,disable_persistence:!1,disable_cookie:!1,secure_cookie:!1,ip:!0,property_blacklist:[]};bn.decide_host=bn.api_host;var wn=!1,kn=function(){};kn.prototype.create_properties=function(){},kn.prototype.event_handler=function(){},kn.prototype.after_track_handler=function(){},kn.prototype.init=function(e){return this.mp=e,this},kn.prototype.track=function(e,t,n,i){var r=this,o=Ut.dom_query(e);return 0===o.length?void Wt.error("The DOM query ("+e+") returned 0 elements"):(Ut.each(o,function(e){Ut.register_event(e,this.override_event,function(e){var o={},a=r.create_properties(n,this),s=r.mp.get_config("track_links_timeout");r.event_handler(e,this,o),window.setTimeout(r.track_callback(i,a,o,!0),s),r.mp.track(t,a,r.track_callback(i,a,o))})},this),!0)},kn.prototype.track_callback=function(e,t,n,i){i=i||!1;var r=this;return function(){n.callback_fired||(n.callback_fired=!0,e&&e(i,t)===!1||r.after_track_handler(t,n,i))}},kn.prototype.create_properties=function(e,t){var n;return n="function"==typeof e?e(t):Ut.extend({},e)};var Sn=function(){this.override_event="click"};Ut.inherit(Sn,kn),Sn.prototype.create_properties=function(e,t){var n=Sn.superclass.create_properties.apply(this,arguments);return t.href&&(n.url=t.href),n},Sn.prototype.event_handler=function(e,t,n){n.new_tab=2===e.which||e.metaKey||e.ctrlKey||"_blank"===t.target,n.href=t.href,n.new_tab||e.preventDefault()},Sn.prototype.after_track_handler=function(e,t){t.new_tab||setTimeout(function(){window.location=t.href},0)};var xn=function(){this.override_event="submit"};Ut.inherit(xn,kn),xn.prototype.event_handler=function(e,t,n){n.element=t,e.preventDefault()},xn.prototype.after_track_handler=function(e,t){setTimeout(function(){t.element.submit()},0)};var Tn=function(e){this.props={},this.campaign_params_saved=!1,e.persistence_name?this.name="mp_"+e.persistence_name:this.name="mp_"+e.token+"_mixpanel";var t=e.persistence;"cookie"!==t&&"localStorage"!==t&&(Wt.critical("Unknown persistence type "+t+"; falling back to cookie"),t=e.persistence="cookie");var n=function(){var e=!0;try{var t="__mplssupport__",n="xyz";Ut.localStorage.set(t,n),Ut.localStorage.get(t)!==n&&(e=!1),Ut.localStorage.remove(t)}catch(t){e=!1}return e||Wt.error("localStorage unsupported; falling back to cookie store"),e};"localStorage"===t&&n()?this.storage=Ut.localStorage:this.storage=Ut.cookie,this.load(),this.update_config(e),this.upgrade(e),this.save()};Tn.prototype.properties=function(){var e={};return Ut.each(this.props,function(t,n){Ut.include(gn,n)||(e[n]=t)}),e},Tn.prototype.load=function(){if(!this.disabled){var e=this.storage.parse(this.name);e&&(this.props=Ut.extend({},e))}},Tn.prototype.upgrade=function(e){var t,n,i=e.upgrade;i&&(t="mp_super_properties","string"==typeof i&&(t=i),n=this.storage.parse(t),this.storage.remove(t),this.storage.remove(t,!0),n&&(this.props=Ut.extend(this.props,n.all,n.events))),e.cookie_name||"mixpanel"===e.name||(t="mp_"+e.token+"_"+e.name,n=this.storage.parse(t),n&&(this.storage.remove(t),this.storage.remove(t,!0),this.register_once(n))),this.storage===Ut.localStorage&&(n=Ut.cookie.parse(this.name),Ut.cookie.remove(this.name),Ut.cookie.remove(this.name,!0),n&&this.register_once(n))},Tn.prototype.save=function(){this.disabled||(this._expire_notification_campaigns(),this.storage.set(this.name,Ut.JSONEncode(this.props),this.expire_days,this.cross_subdomain,this.secure))},Tn.prototype.remove=function(){this.storage.remove(this.name,!1),this.storage.remove(this.name,!0)},Tn.prototype.clear=function(){this.remove(),this.props={}},Tn.prototype.register_once=function(e,t,n){return!!Ut.isObject(e)&&("undefined"==typeof t&&(t="None"),this.expire_days="undefined"==typeof n?this.default_expiry:n,Ut.each(e,function(e,n){this.props[n]&&this.props[n]!==t||(this.props[n]=e)},this),this.save(),!0)},Tn.prototype.register=function(e,t){return!!Ut.isObject(e)&&(this.expire_days="undefined"==typeof t?this.default_expiry:t,Ut.extend(this.props,e),this.save(),!0)},Tn.prototype.unregister=function(e){e in this.props&&(delete this.props[e],this.save())},Tn.prototype._expire_notification_campaigns=Ut.safewrap(function(){var e=this.props[pn],t=At.false?6e4:36e5;if(e){for(var n in e)1*new Date-e[n]>t&&delete e[n];Ut.isEmptyObject(e)&&delete this.props[pn]}}),Tn.prototype.update_campaign_params=function(){this.campaign_params_saved||(this.register_once(Ut.info.campaignParams()),this.campaign_params_saved=!0)},Tn.prototype.update_search_keyword=function(e){this.register(Ut.info.searchInfo(e))},Tn.prototype.update_referrer_info=function(e){this.register_once({$initial_referrer:e||"$direct",$initial_referring_domain:Ut.info.referringDomain(e)||"$direct"},"")},Tn.prototype.get_referrer_info=function(){return Ut.strip_empty_properties({$initial_referrer:this.props.$initial_referrer,$initial_referring_domain:this.props.$initial_referring_domain})},Tn.prototype.safe_merge=function(e){return Ut.each(this.props,function(t,n){n in e||(e[n]=t)}),e},Tn.prototype.update_config=function(e){this.default_expiry=this.expire_days=e.cookie_expiration,this.set_disabled(e.disable_persistence),this.set_cross_subdomain(e.cross_subdomain_cookie),this.set_secure(e.secure_cookie)},Tn.prototype.set_disabled=function(e){this.disabled=e,this.disabled&&this.remove()},Tn.prototype.set_cross_subdomain=function(e){e!==this.cross_subdomain&&(this.cross_subdomain=e,this.remove(),this.save())},Tn.prototype.get_cross_subdomain=function(){return this.cross_subdomain},Tn.prototype.set_secure=function(e){e!==this.secure&&(this.secure=!!e,this.remove(),this.save())},Tn.prototype._add_to_people_queue=function(e,t){var n=this._get_queue_key(e),i=t[e],r=this._get_or_create_queue(sn),o=this._get_or_create_queue(cn),a=this._get_or_create_queue(un),s=this._get_or_create_queue(ln),c=this._get_or_create_queue(dn,[]);n===tn?(Ut.extend(r,i),this._pop_from_people_queue(un,i),this._pop_from_people_queue(ln,i)):n===nn?Ut.each(i,function(e,t){t in o||(o[t]=e)}):n===rn?Ut.each(i,function(e,t){t in r?r[t]+=e:(t in a||(a[t]=0),a[t]+=e)},this):n===an?Ut.each(i,function(e,t){Ut.isArray(e)&&(t in s||(s[t]=[]),s[t]=s[t].concat(e))}):n===on&&c.push(i),Wt.log("MIXPANEL PEOPLE REQUEST (QUEUED, PENDING IDENTIFY):"),Wt.log(t),this.save()},Tn.prototype._pop_from_people_queue=function(e,t){var n=this._get_queue(e);Ut.isUndefined(n)||(Ut.each(t,function(e,t){delete n[t]},this),this.save())},Tn.prototype._get_queue_key=function(e){return e===sn?tn:e===cn?nn:e===un?rn:e===dn?on:e===ln?an:void Wt.error("Invalid queue:",e)},Tn.prototype._get_queue=function(e){return this.props[this._get_queue_key(e)]},Tn.prototype._get_or_create_queue=function(e,t){var n=this._get_queue_key(e);return t=Ut.isUndefined(t)?{}:t,this.props[n]||(this.props[n]=t)},Tn.prototype.set_event_timer=function(e,t){var n=this.props[vn]||{};n[e]=t,this.props[vn]=n,this.save()},Tn.prototype.remove_event_timer=function(e){var t=this.props[vn]||{},n=t[e];return Ut.isUndefined(n)||(delete this.props[vn][e],
this.save()),n};var En,Pn=function(){},An=function(){},Mn=function(e,t,n){var i,r=n===en?Kt:Kt[n];if(r&&Yt===Qt)i=r;else{if(r&&!Ut.isArray(r))return void Wt.error("You have already initialized "+n);i=new Pn}if(i._init(e,t,n),i.people=new An,i.people._init(i),At.false=At.false||i.get_config("debug"),i.__autotrack_enabled=i.get_config("autotrack"),i.get_config("autotrack")){var o=100,a=100;Jt.enabledForProject(i.get_config("token"),o,a)?Jt.isBrowserSupported()?Jt.init(i):(i.__autotrack_enabled=!1,Wt.log("Disabling Automatic Event Collection because this browser is not supported")):(i.__autotrack_enabled=!1,Wt.log("Not in active bucket: disabling Automatic Event Collection."));try{qn(i)}catch(e){Wt.error(e)}}return!Ut.isUndefined(r)&&Ut.isArray(r)&&(i._execute_array.call(i.people,r.people),i._execute_array(r)),i};Pn.prototype.init=function(e,t,n){if(Ut.isUndefined(n))return void Wt.error("You must name your new library: init(token, config, name)");if(n===en)return void Wt.error("You must initialize the main mixpanel object right after you include the Mixpanel js snippet");var i=Mn(e,t,n);return Kt[n]=i,i._loaded(),i},Pn.prototype._init=function(e,t,n){this.__loaded=!0,this.config={},this.set_config(Ut.extend({},bn,t,{name:n,token:e,callback_fn:(n===en?n:"mixpanel."+n)+"._jsc"})),this._jsc=function(){},this.__dom_loaded_queue=[],this.__request_queue=[],this.__disabled_events=[],this._flags={disable_all_events:!1,identify_called:!1},this.persistence=this.cookie=new Tn(this.config),this.register_once({distinct_id:Ut.UUID()},"")},Pn.prototype._loaded=function(){this.get_config("loaded")(this),this.get_config("track_pageview")&&this.track_pageview()},Pn.prototype._dom_loaded=function(){Ut.each(this.__dom_loaded_queue,function(e){this._track_dom.apply(this,e)},this),Ut.each(this.__request_queue,function(e){this._send_request.apply(this,e)},this),delete this.__dom_loaded_queue,delete this.__request_queue},Pn.prototype._track_dom=function(e,t){if(this.get_config("img"))return Wt.error("You can't use DOM tracking functions with img = true."),!1;if(!wn)return this.__dom_loaded_queue.push([e,t]),!1;var n=(new e).init(this);return n.track.apply(n,t)},Pn.prototype._prepare_callback=function(e,t){if(Ut.isUndefined(e))return null;if(yn){var n=function(n){e(n,t)};return n}var i=this._jsc,r=""+Math.floor(1e8*Math.random()),o=this.get_config("callback_fn")+"["+r+"]";return i[r]=function(n){delete i[r],e(n,t)},o},Pn.prototype._send_request=function(e,t,n){if(_n)return void this.__request_queue.push(arguments);var i=this.get_config("verbose");if(t.verbose&&(i=!0),this.get_config("test")&&(t.test=1),i&&(t.verbose=1),this.get_config("img")&&(t.img=1),yn||(n?t.callback=n:(i||this.get_config("test"))&&(t.callback="(function(){})")),t.ip=this.get_config("ip")?1:0,t._=(new Date).getTime().toString(),e+="?"+Ut.HTTPBuildQuery(t),"img"in t){var r=document.createElement("img");r.src=e,document.body.appendChild(r)}else if(yn)try{var o=new XMLHttpRequest;o.open("GET",e,!0),o.withCredentials=!0,o.onreadystatechange=function(){if(4===o.readyState)if(e.indexOf("api.mixpanel.com/track")!==-1&&Jt.checkForBackoff(o),200===o.status)n&&n(i?Ut.JSONDecode(o.responseText):Number(o.responseText));else{var t="Bad HTTP status: "+o.status+" "+o.statusText;Wt.error(t),n&&n(i?{status:0,error:t}:0)}},o.send(null)}catch(e){Wt.error(e)}else{var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.defer=!0,a.src=e;var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(a,s)}},Pn.prototype._execute_array=function(e){var t,n=[],i=[],r=[];Ut.each(e,function(e){e&&(t=e[0],"function"==typeof e?e.call(this):Ut.isArray(e)&&"alias"===t?n.push(e):Ut.isArray(e)&&t.indexOf("track")!==-1&&"function"==typeof this[t]?r.push(e):i.push(e))},this);var o=function(e,t){Ut.each(e,function(e){this[e[0]].apply(this,e.slice(1))},t)};o(n,this),o(i,this),o(r,this)},Pn.prototype.push=function(e){this._execute_array([e])},Pn.prototype.disable=function(e){"undefined"==typeof e?this._flags.disable_all_events=!0:this.__disabled_events=this.__disabled_events.concat(e)},Pn.prototype.track=function(e,t,n){if("function"!=typeof n&&(n=function(){}),Ut.isUndefined(e))return void Wt.error("No event name provided to mixpanel.track");if(this._event_is_disabled(e))return void n(0);t=t||{},t.token=this.get_config("token");var i=this.persistence.remove_event_timer(e);if(!Ut.isUndefined(i)){var r=(new Date).getTime()-i;t.$duration=parseFloat((r/1e3).toFixed(3))}this.persistence.update_search_keyword(document.referrer),this.get_config("store_google")&&this.persistence.update_campaign_params(),this.get_config("save_referrer")&&this.persistence.update_referrer_info(document.referrer),t=Ut.extend({},Ut.info.properties(),this.persistence.properties(),t);try{this.get_config("autotrack")&&"mp_page_view"!==e&&"$create_alias"!==e&&(t=Ut.extend({},t,this.mp_counts),this.mp_counts={$__c:0},Ut.cookie.set("mp_"+this.get_config("name")+"__c",0,1,!0))}catch(e){Wt.error(e)}var o=this.get_config("property_blacklist");Ut.isArray(o)?Ut.each(o,function(e){delete t[e]}):Wt.error("Invalid value for property_blacklist config: "+o);var a={event:e,properties:t},s=Ut.truncate(a,255),c=Ut.JSONEncode(s),u=Ut.base64Encode(c);return Wt.log("MIXPANEL REQUEST:"),Wt.log(s),this._send_request(this.get_config("api_host")+"/track/",{data:u},this._prepare_callback(n,s)),s},Pn.prototype.track_pageview=function(e){Ut.isUndefined(e)&&(e=document.location.href),this.track("mp_page_view",Ut.info.pageviewInfo(e))},Pn.prototype.track_links=function(){return this._track_dom.call(this,Sn,arguments)},Pn.prototype.track_forms=function(){return this._track_dom.call(this,xn,arguments)},Pn.prototype.time_event=function(e){return Ut.isUndefined(e)?void Wt.error("No event name provided to mixpanel.time_event"):void(this._event_is_disabled(e)||this.persistence.set_event_timer(e,(new Date).getTime()))},Pn.prototype.register=function(e,t){this.persistence.register(e,t)},Pn.prototype.register_once=function(e,t,n){this.persistence.register_once(e,t,n)},Pn.prototype.unregister=function(e){this.persistence.unregister(e)},Pn.prototype._register_single=function(e,t){var n={};n[e]=t,this.register(n)},Pn.prototype.identify=function(e,t,n,i,r,o){e!==this.get_distinct_id()&&e!==this.get_property(hn)&&(this.unregister(hn),this._register_single("distinct_id",e)),this._check_and_handle_notifications(this.get_distinct_id()),this._flags.identify_called=!0,this.people._flush(t,n,i,r,o)},Pn.prototype.reset=function(){this.persistence.clear(),this._flags.identify_called=!1,this.register_once({distinct_id:Ut.UUID()},"")},Pn.prototype.get_distinct_id=function(){return this.get_property("distinct_id")},Pn.prototype.alias=function(e,t){if(e===this.get_property(fn))return Wt.critical("Attempting to create alias for existing People user - aborting."),-2;var n=this;return Ut.isUndefined(t)&&(t=this.get_distinct_id()),e!==t?(this._register_single(hn,e),this.track("$create_alias",{alias:e,distinct_id:t},function(){n.identify(e)})):(Wt.error("alias matches current distinct_id - skipping api call."),this.identify(e),-1)},Pn.prototype.name_tag=function(e){this._register_single("mp_name_tag",e)},Pn.prototype.set_config=function(e){Ut.isObject(e)&&(Ut.extend(this.config,e),this.get_config("persistence_name")||(this.config.persistence_name=this.config.cookie_name),this.get_config("disable_persistence")||(this.config.disable_persistence=this.config.disable_cookie),this.persistence&&this.persistence.update_config(this.config),At.false=At.false||this.get_config("debug"))},Pn.prototype.get_config=function(e){return this.config[e]},Pn.prototype.get_property=function(e){return this.persistence.props[e]},Pn.prototype.toString=function(){var e=this.get_config("name");return e!==en&&(e="mixpanel."+e),e},Pn.prototype._event_is_disabled=function(e){return Ut.isBlockedUA(Dt)||this._flags.disable_all_events||Ut.include(this.__disabled_events,e)},Pn.prototype._check_and_handle_notifications=function(e){if(e&&!this._flags.identify_called&&!this.get_config("disable_notifications")){Wt.log("MIXPANEL NOTIFICATION CHECK");var t={verbose:!0,version:"1",lib:"web",token:this.get_config("token"),distinct_id:e},n=this;this._send_request(this.get_config("decide_host")+"/decide/",t,this._prepare_callback(function(e){e.notifications&&e.notifications.length>0&&n._show_notification.call(n,e.notifications[0])}))}},Pn.prototype._show_notification=function(e){var t=new En(e,this);t.show()},An.prototype._init=function(e){this._mixpanel=e},An.prototype.set=function(e,t,n){var i={},r={};return Ut.isObject(e)?(Ut.each(e,function(e,t){this._is_reserved_property(t)||(r[t]=e)},this),n=t):r[e]=t,this._get_config("save_referrer")&&this._mixpanel.persistence.update_referrer_info(document.referrer),r=Ut.extend({},Ut.info.people_properties(),this._mixpanel.persistence.get_referrer_info(),r),i[sn]=r,this._send_request(i,n)},An.prototype.set_once=function(e,t,n){var i={},r={};return Ut.isObject(e)?(Ut.each(e,function(e,t){this._is_reserved_property(t)||(r[t]=e)},this),n=t):r[e]=t,i[cn]=r,this._send_request(i,n)},An.prototype.increment=function(e,t,n){var i={},r={};return Ut.isObject(e)?(Ut.each(e,function(e,t){if(!this._is_reserved_property(t)){if(isNaN(parseFloat(e)))return void Wt.error("Invalid increment value passed to mixpanel.people.increment - must be a number");r[t]=e}},this),n=t):(Ut.isUndefined(t)&&(t=1),r[e]=t),i[un]=r,this._send_request(i,n)},An.prototype.append=function(e,t,n){var i={},r={};return Ut.isObject(e)?(Ut.each(e,function(e,t){this._is_reserved_property(t)||(r[t]=e)},this),n=t):r[e]=t,i[dn]=r,this._send_request(i,n)},An.prototype.union=function(e,t,n){var i={},r={};return Ut.isObject(e)?(Ut.each(e,function(e,t){this._is_reserved_property(t)||(r[t]=Ut.isArray(e)?e:[e])},this),n=t):r[e]=Ut.isArray(t)?t:[t],i[ln]=r,this._send_request(i,n)},An.prototype.track_charge=function(e,t,n){return!Ut.isNumber(e)&&(e=parseFloat(e),isNaN(e))?void Wt.error("Invalid value passed to mixpanel.people.track_charge - must be a number"):this.append("$transactions",Ut.extend({$amount:e},t),n)},An.prototype.clear_charges=function(e){return this.set("$transactions",[],e)},An.prototype.delete_user=function(){if(!this._identify_called())return void Wt.error("mixpanel.people.delete_user() requires you to call identify() first");var e={$delete:this._mixpanel.get_distinct_id()};return this._send_request(e)},An.prototype.toString=function(){return this._mixpanel.toString()+".people"},An.prototype._send_request=function(e,t){e.$token=this._get_config("token"),e.$distinct_id=this._mixpanel.get_distinct_id();var n=Ut.encodeDates(e),i=Ut.truncate(n,255),r=Ut.JSONEncode(n),o=Ut.base64Encode(r);return this._identify_called()?(Wt.log("MIXPANEL PEOPLE REQUEST:"),Wt.log(i),this._mixpanel._send_request(this._get_config("api_host")+"/engage/",{data:o},this._mixpanel._prepare_callback(t,i)),i):(this._enqueue(e),Ut.isUndefined(t)||t(this._get_config("verbose")?{status:-1,error:null}:-1),i)},An.prototype._get_config=function(e){return this._mixpanel.get_config(e)},An.prototype._identify_called=function(){return this._mixpanel._flags.identify_called===!0},An.prototype._enqueue=function(e){sn in e?this._mixpanel.persistence._add_to_people_queue(sn,e):cn in e?this._mixpanel.persistence._add_to_people_queue(cn,e):un in e?this._mixpanel.persistence._add_to_people_queue(un,e):dn in e?this._mixpanel.persistence._add_to_people_queue(dn,e):ln in e?this._mixpanel.persistence._add_to_people_queue(ln,e):Wt.error("Invalid call to _enqueue():",e)},An.prototype._flush=function(e,t,n,i,r){var o=this,a=Ut.extend({},this._mixpanel.persistence._get_queue(sn)),s=Ut.extend({},this._mixpanel.persistence._get_queue(cn)),c=Ut.extend({},this._mixpanel.persistence._get_queue(un)),u=this._mixpanel.persistence._get_queue(dn),d=Ut.extend({},this._mixpanel.persistence._get_queue(ln));if(Ut.isUndefined(a)||!Ut.isObject(a)||Ut.isEmptyObject(a)||(o._mixpanel.persistence._pop_from_people_queue(sn,a),this.set(a,function(t,n){0===t&&o._mixpanel.persistence._add_to_people_queue(sn,a),Ut.isUndefined(e)||e(t,n)})),Ut.isUndefined(s)||!Ut.isObject(s)||Ut.isEmptyObject(s)||(o._mixpanel.persistence._pop_from_people_queue(cn,s),this.set_once(s,function(e,t){0===e&&o._mixpanel.persistence._add_to_people_queue(cn,s),Ut.isUndefined(i)||i(e,t)})),Ut.isUndefined(c)||!Ut.isObject(c)||Ut.isEmptyObject(c)||(o._mixpanel.persistence._pop_from_people_queue(un,c),this.increment(c,function(e,n){0===e&&o._mixpanel.persistence._add_to_people_queue(un,c),Ut.isUndefined(t)||t(e,n)})),Ut.isUndefined(d)||!Ut.isObject(d)||Ut.isEmptyObject(d)||(o._mixpanel.persistence._pop_from_people_queue(ln,d),this.union(d,function(e,t){0===e&&o._mixpanel.persistence._add_to_people_queue(ln,d),Ut.isUndefined(r)||r(e,t)})),!Ut.isUndefined(u)&&Ut.isArray(u)&&u.length){for(var l,f=function(e,t){0===e&&o._mixpanel.persistence._add_to_people_queue(dn,l),Ut.isUndefined(n)||n(e,t)},h=u.length-1;h>=0;h--)l=u.pop(),o.append(l,f);o._mixpanel.persistence.save()}},An.prototype._is_reserved_property=function(e){return"$distinct_id"===e||"$token"===e},Pn._Notification=function(e,t){Ut.bind_instance_methods(this),this.mixpanel=t,this.persistence=this.mixpanel.persistence,this.campaign_id=Ut.escapeHTML(e.id),this.message_id=Ut.escapeHTML(e.message_id),this.body=(Ut.escapeHTML(e.body)||"").replace(/\n/g,"<br/>"),this.cta=Ut.escapeHTML(e.cta)||"Close",this.dest_url=Ut.escapeHTML(e.cta_url)||null,this.image_url=Ut.escapeHTML(e.image_url)||null,this.notif_type=Ut.escapeHTML(e.type)||"takeover",this.style=Ut.escapeHTML(e.style)||"light",this.thumb_image_url=Ut.escapeHTML(e.thumb_image_url)||null,this.title=Ut.escapeHTML(e.title)||"",this.video_url=Ut.escapeHTML(e.video_url)||null,this.video_width=En.VIDEO_WIDTH,this.video_height=En.VIDEO_HEIGHT,this.clickthrough=!0,this.dest_url||(this.dest_url="#dismiss",this.clickthrough=!1),this.mini="mini"===this.notif_type,this.mini||(this.notif_type="takeover"),this.notif_width=this.mini?En.NOTIF_WIDTH_MINI:En.NOTIF_WIDTH,this._set_client_config(),this.imgs_to_preload=this._init_image_html(),this._init_video()},En=Pn._Notification,En.ANIM_TIME=200,En.MARKUP_PREFIX="mixpanel-notification",En.BG_OPACITY=.6,En.NOTIF_TOP=25,En.NOTIF_START_TOP=200,En.NOTIF_WIDTH=388,En.NOTIF_WIDTH_MINI=420,En.NOTIF_HEIGHT_MINI=85,En.THUMB_BORDER_SIZE=5,En.THUMB_IMG_SIZE=60,En.THUMB_OFFSET=Math.round(En.THUMB_IMG_SIZE/2),En.VIDEO_WIDTH=595,En.VIDEO_HEIGHT=334,En.prototype.show=function(){var e=this;return this._set_client_config(),this.body_el?(this._init_styles(),this._init_notification_el(),void this._preload_images(this._attach_and_animate)):void setTimeout(function(){e.show()},300)},En.prototype.dismiss=Ut.safewrap(function(){this.marked_as_shown||this._mark_delivery({invisible:!0});var e=this.showing_video?this._get_el("video"):this._get_notification_display_el();if(this.use_transitions)this._remove_class("bg","visible"),this._add_class(e,"exiting"),setTimeout(this._remove_notification_el,En.ANIM_TIME);else{var t,n,i;this.mini?(t="right",n=20,i=-100):(t="top",n=En.NOTIF_TOP,i=En.NOTIF_START_TOP+En.NOTIF_TOP),this._animate_els([{el:this._get_el("bg"),attr:"opacity",start:En.BG_OPACITY,goal:0},{el:e,attr:"opacity",start:1,goal:0},{el:e,attr:t,start:n,goal:i}],En.ANIM_TIME,this._remove_notification_el)}}),En.prototype._add_class=Ut.safewrap(function(e,t){t=En.MARKUP_PREFIX+"-"+t,"string"==typeof e&&(e=this._get_el(e)),e.className?~(" "+e.className+" ").indexOf(" "+t+" ")||(e.className+=" "+t):e.className=t}),En.prototype._remove_class=Ut.safewrap(function(e,t){t=En.MARKUP_PREFIX+"-"+t,"string"==typeof e&&(e=this._get_el(e)),e.className&&(e.className=(" "+e.className+" ").replace(" "+t+" ","").replace(/^[\s\xA0]+/,"").replace(/[\s\xA0]+$/,""))}),En.prototype._animate_els=Ut.safewrap(function(e,t,n,i){var r,o,a,s=this,c=!1,u=1*new Date;for(i=i||u,a=u-i,r=0;r<e.length;r++)if(o=e[r],"undefined"==typeof o.val&&(o.val=o.start),o.val!==o.goal){c=!0;var d=o.goal-o.start,l=o.goal>=o.start?1:-1;o.val=o.start+d*a/t,"opacity"!==o.attr&&(o.val=Math.round(o.val)),(l>0&&o.val>=o.goal||l<0&&o.val<=o.goal)&&(o.val=o.goal)}if(!c)return void(n&&n());for(r=0;r<e.length;r++)if(o=e[r],o.el){var f="opacity"===o.attr?"":"px";o.el.style[o.attr]=String(o.val)+f}setTimeout(function(){s._animate_els(e,t,n,i)},10)}),En.prototype._attach_and_animate=Ut.safewrap(function(){var e=this;if(!this.shown&&!this._get_shown_campaigns()[this.campaign_id]){this.shown=!0,this.body_el.appendChild(this.notification_el),setTimeout(function(){var t=e._get_notification_display_el();if(e.use_transitions)e.mini||e._add_class("bg","visible"),e._add_class(t,"visible"),e._mark_as_shown();else{var n,i,r;e.mini?(n="right",i=-100,r=20):(n="top",i=En.NOTIF_START_TOP+En.NOTIF_TOP,r=En.NOTIF_TOP),e._animate_els([{el:e._get_el("bg"),attr:"opacity",start:0,goal:En.BG_OPACITY},{el:t,attr:"opacity",start:0,goal:1},{el:t,attr:n,start:i,goal:r}],En.ANIM_TIME,e._mark_as_shown)}},100),Ut.register_event(e._get_el("cancel"),"click",function(t){t.preventDefault(),e.dismiss()});var t=e._get_el("button")||e._get_el("mini-content");Ut.register_event(t,"click",function(t){t.preventDefault(),e.show_video?(e._track_event("$campaign_open",{$resource_type:"video"}),e._switch_to_video()):(e.dismiss(),e.clickthrough&&e._track_event("$campaign_open",{$resource_type:"link"},function(){window.location.href=e.dest_url}))})}}),En.prototype._get_el=function(e){return document.getElementById(En.MARKUP_PREFIX+"-"+e)},En.prototype._get_notification_display_el=function(){return this._get_el(this.notif_type)},En.prototype._get_shown_campaigns=function(){return this.persistence.props[pn]||(this.persistence.props[pn]={})},En.prototype._browser_lte=function(e,t){return this.browser_versions[e]&&this.browser_versions[e]<=t},En.prototype._init_image_html=function(){var e=[];return this.mini?(this.thumb_image_url=this.thumb_image_url||"//cdn.mxpnl.com/site_media/images/icons/notifications/mini-news-dark.png",e.push(this.thumb_image_url)):(this.image_url?(e.push(this.image_url),this.img_html='<img id="img" src="'+this.image_url+'"/>'):this.img_html="",this.thumb_image_url?(e.push(this.thumb_image_url),this.thumb_img_html='<div id="thumbborder-wrapper"><div id="thumbborder"></div></div><img id="thumbnail" src="'+this.thumb_image_url+'" width="'+En.THUMB_IMG_SIZE+'" height="'+En.THUMB_IMG_SIZE+'"/><div id="thumbspacer"></div>'):this.thumb_img_html=""),e},En.prototype._init_notification_el=function(){var e="",t="",n="",i='<div id="cancel"><div id="cancel-icon"></div></div>';if(this.notification_el=document.createElement("div"),this.notification_el.id=En.MARKUP_PREFIX+"-wrapper",this.mini)e='<div id="mini"><div id="mainbox">'+i+'<div id="mini-content"><div id="mini-icon"><div id="mini-icon-img"></div></div><div id="body"><div id="body-text"><div>'+this.body+'</div></div></div></div></div><div id="mini-border"></div></div>';else{var r=this.clickthrough||this.show_video?"":'<div id="button-close"></div>',o=this.show_video?'<div id="button-play"></div>':"";this._browser_lte("ie",7)&&(r="",o=""),e='<div id="takeover">'+this.thumb_img_html+'<div id="mainbox">'+i+'<div id="content">'+this.img_html+'<div id="title">'+this.title+'</div><div id="body">'+this.body+'</div><div id="tagline"><a href="http://mixpanel.com?from=inapp" target="_blank">POWERED BY MIXPANEL</a></div></div><div id="button">'+r+'<a id="button-link" href="'+this.dest_url+'">'+this.cta+"</a>"+o+"</div></div></div>"}this.youtube_video?(t="//www.youtube.com/embed/"+this.youtube_video+"?wmode=transparent&showinfo=0&modestbranding=0&rel=0&autoplay=1&loop=0&vq=hd1080",this.yt_custom&&(t+="&enablejsapi=1&html5=1&controls=0",n='<div id="video-controls"><div id="video-progress" class="video-progress-el"><div id="video-progress-total" class="video-progress-el"></div><div id="video-elapsed" class="video-progress-el"></div></div><div id="video-time" class="video-progress-el"></div></div>')):this.vimeo_video&&(t="//player.vimeo.com/video/"+this.vimeo_video+"?autoplay=1&title=0&byline=0&portrait=0"),this.show_video&&(this.video_iframe='<iframe id="'+En.MARKUP_PREFIX+'-video-frame" width="'+this.video_width+'" height="'+this.video_height+'"  src="'+t+'" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen="1" scrolling="no"></iframe>',n='<div id="video-'+(this.flip_animate?"":"no")+'flip"><div id="video"><div id="video-holder"></div>'+n+"</div></div>");var a=n+e;this.flip_animate&&(a=(this.mini?e:"")+'<div id="flipcontainer"><div id="flipper">'+(this.mini?n:a)+"</div></div>"),this.notification_el.innerHTML=('<div id="overlay" class="'+this.notif_type+'"><div id="campaignid-'+this.campaign_id+'"><div id="bgwrapper"><div id="bg"></div>'+a+"</div></div></div>").replace(/class=\"/g,'class="'+En.MARKUP_PREFIX+"-").replace(/id=\"/g,'id="'+En.MARKUP_PREFIX+"-")},En.prototype._init_styles=function(){"dark"===this.style?this.style_vals={bg:"#1d1f25",bg_actions:"#282b32",bg_hover:"#3a4147",bg_light:"#4a5157",border_gray:"#32353c",cancel_opacity:"0.4",mini_hover:"#2a3137",text_title:"#fff",text_main:"#9498a3",text_tagline:"#464851",text_hover:"#ddd"}:this.style_vals={bg:"#fff",bg_actions:"#e7eaee",bg_hover:"#eceff3",bg_light:"#f5f5f5",border_gray:"#e4ecf2",cancel_opacity:"1.0",mini_hover:"#fafafa",text_title:"#5c6578",text_main:"#8b949b",text_tagline:"#ced9e6",text_hover:"#7c8598"};var e="0px 0px 35px 0px rgba(45, 49, 56, 0.7)",t=e,n=e,i=En.THUMB_IMG_SIZE+2*En.THUMB_BORDER_SIZE,r=En.ANIM_TIME/1e3+"s";this.mini&&(e="none");var o={},a=En.NOTIF_WIDTH_MINI+20;o["@media only screen and (max-width: "+(a-1)+"px)"]={"#overlay":{display:"none"}};var s={".flipped":{transform:"rotateY(180deg)"},"#overlay":{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",overflow:"auto","text-align":"center","z-index":"10000","font-family":'"Helvetica", "Arial", sans-serif',"-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale"},"#overlay.mini":{height:"0",overflow:"visible"},"#overlay a":{width:"initial",padding:"0","text-decoration":"none","text-transform":"none",color:"inherit"},"#bgwrapper":{position:"relative",width:"100%",height:"100%"},"#bg":{position:"fixed",top:"0",left:"0",width:"100%",height:"100%","min-width":4*this.doc_width+"px","min-height":4*this.doc_height+"px","background-color":"black",opacity:"0.0","-ms-filter":"progid:DXImageTransform.Microsoft.Alpha(Opacity=60)",filter:"alpha(opacity=60)",transition:"opacity "+r},"#bg.visible":{opacity:En.BG_OPACITY},".mini #bg":{width:"0",height:"0","min-width":"0"},"#flipcontainer":{perspective:"1000px",position:"absolute",width:"100%"},"#flipper":{position:"relative","transform-style":"preserve-3d",transition:"0.3s"},"#takeover":{position:"absolute",left:"50%",width:En.NOTIF_WIDTH+"px","margin-left":Math.round(-En.NOTIF_WIDTH/2)+"px","backface-visibility":"hidden",transform:"rotateY(0deg)",opacity:"0.0",top:En.NOTIF_START_TOP+"px",transition:"opacity "+r+", top "+r},"#takeover.visible":{opacity:"1.0",top:En.NOTIF_TOP+"px"},"#takeover.exiting":{opacity:"0.0",top:En.NOTIF_START_TOP+"px"},"#thumbspacer":{height:En.THUMB_OFFSET+"px"},"#thumbborder-wrapper":{position:"absolute",top:-En.THUMB_BORDER_SIZE+"px",left:En.NOTIF_WIDTH/2-En.THUMB_OFFSET-En.THUMB_BORDER_SIZE+"px",width:i+"px",height:i/2+"px",overflow:"hidden"},"#thumbborder":{position:"absolute",width:i+"px",height:i+"px","border-radius":i+"px","background-color":this.style_vals.bg_actions,opacity:"0.5"},"#thumbnail":{position:"absolute",top:"0px",left:En.NOTIF_WIDTH/2-En.THUMB_OFFSET+"px",width:En.THUMB_IMG_SIZE+"px",height:En.THUMB_IMG_SIZE+"px",overflow:"hidden","z-index":"100","border-radius":En.THUMB_IMG_SIZE+"px"},"#mini":{position:"absolute",right:"20px",top:En.NOTIF_TOP+"px",width:this.notif_width+"px",height:2*En.NOTIF_HEIGHT_MINI+"px","margin-top":20-En.NOTIF_HEIGHT_MINI+"px","backface-visibility":"hidden",opacity:"0.0",transform:"rotateX(90deg)",transition:"opacity 0.3s, transform 0.3s, right 0.3s"},"#mini.visible":{opacity:"1.0",transform:"rotateX(0deg)"},"#mini.exiting":{opacity:"0.0",right:"-150px"},"#mainbox":{"border-radius":"4px","box-shadow":e,"text-align":"center","background-color":this.style_vals.bg,"font-size":"14px",color:this.style_vals.text_main},"#mini #mainbox":{height:En.NOTIF_HEIGHT_MINI+"px","margin-top":En.NOTIF_HEIGHT_MINI+"px","border-radius":"3px",transition:"background-color "+r},"#mini-border":{height:En.NOTIF_HEIGHT_MINI+6+"px",width:En.NOTIF_WIDTH_MINI+6+"px",position:"absolute",top:"-3px",left:"-3px","margin-top":En.NOTIF_HEIGHT_MINI+"px","border-radius":"6px",opacity:"0.25","background-color":"#fff","z-index":"-1","box-shadow":n},"#mini-icon":{position:"relative",display:"inline-block",width:"75px",height:En.NOTIF_HEIGHT_MINI+"px","border-radius":"3px 0 0 3px","background-color":this.style_vals.bg_actions,background:"linear-gradient(135deg, "+this.style_vals.bg_light+" 0%, "+this.style_vals.bg_actions+" 100%)",transition:"background-color "+r},"#mini:hover #mini-icon":{"background-color":this.style_vals.mini_hover},"#mini:hover #mainbox":{"background-color":this.style_vals.mini_hover},"#mini-icon-img":{position:"absolute","background-image":"url("+this.thumb_image_url+")",width:"48px",height:"48px",top:"20px",left:"12px"},"#content":{padding:"30px 20px 0px 20px"},"#mini-content":{"text-align":"left",height:En.NOTIF_HEIGHT_MINI+"px",cursor:"pointer"},"#img":{width:"328px","margin-top":"30px","border-radius":"5px"},"#title":{"max-height":"600px",overflow:"hidden","word-wrap":"break-word",padding:"25px 0px 20px 0px","font-size":"19px","font-weight":"bold",color:this.style_vals.text_title},"#body":{"max-height":"600px","margin-bottom":"25px",overflow:"hidden","word-wrap":"break-word","line-height":"21px","font-size":"15px","font-weight":"normal","text-align":"left"},"#mini #body":{display:"inline-block","max-width":"250px",margin:"0 0 0 30px",height:En.NOTIF_HEIGHT_MINI+"px","font-size":"16px","letter-spacing":"0.8px",color:this.style_vals.text_title},"#mini #body-text":{display:"table",height:En.NOTIF_HEIGHT_MINI+"px"},"#mini #body-text div":{display:"table-cell","vertical-align":"middle"},"#tagline":{"margin-bottom":"15px","font-size":"10px","font-weight":"600","letter-spacing":"0.8px",color:"#ccd7e0","text-align":"left"},"#tagline a":{color:this.style_vals.text_tagline,transition:"color "+r},"#tagline a:hover":{color:this.style_vals.text_hover},"#cancel":{position:"absolute",right:"0",width:"8px",height:"8px",padding:"10px","border-radius":"20px",margin:"12px 12px 0 0","box-sizing":"content-box",cursor:"pointer",transition:"background-color "+r},"#mini #cancel":{margin:"7px 7px 0 0"},"#cancel-icon":{width:"8px",height:"8px",overflow:"hidden","background-image":"url(//cdn.mxpnl.com/site_media/images/icons/notifications/cancel-x.png)",opacity:this.style_vals.cancel_opacity},"#cancel:hover":{"background-color":this.style_vals.bg_hover},"#button":{display:"block",height:"60px","line-height":"60px","text-align":"center","background-color":this.style_vals.bg_actions,"border-radius":"0 0 4px 4px",overflow:"hidden",cursor:"pointer",transition:"background-color "+r},"#button-close":{display:"inline-block",width:"9px",height:"60px","margin-right":"8px","vertical-align":"top","background-image":"url(//cdn.mxpnl.com/site_media/images/icons/notifications/close-x-"+this.style+".png)","background-repeat":"no-repeat","background-position":"0px 25px"},"#button-play":{display:"inline-block",width:"30px",height:"60px","margin-left":"15px","background-image":"url(//cdn.mxpnl.com/site_media/images/icons/notifications/play-"+this.style+"-small.png)","background-repeat":"no-repeat","background-position":"0px 15px"},"a#button-link":{display:"inline-block","vertical-align":"top","text-align":"center","font-size":"17px","font-weight":"bold",overflow:"hidden","word-wrap":"break-word",color:this.style_vals.text_title,transition:"color "+r},"#button:hover":{"background-color":this.style_vals.bg_hover,color:this.style_vals.text_hover},"#button:hover a":{color:this.style_vals.text_hover},"#video-noflip":{position:"relative",top:2*-this.video_height+"px"},"#video-flip":{"backface-visibility":"hidden",transform:"rotateY(180deg)"},"#video":{position:"absolute",width:this.video_width-1+"px",height:this.video_height+"px",top:En.NOTIF_TOP+"px","margin-top":"100px",left:"50%","margin-left":Math.round(-this.video_width/2)+"px",overflow:"hidden","border-radius":"5px","box-shadow":t,transform:"translateZ(1px)",transition:"opacity "+r+", top "+r},"#video.exiting":{opacity:"0.0",top:this.video_height+"px"},"#video-holder":{position:"absolute",width:this.video_width-1+"px",height:this.video_height+"px",overflow:"hidden","border-radius":"5px"},"#video-frame":{"margin-left":"-1px",width:this.video_width+"px"},"#video-controls":{opacity:"0",transition:"opacity 0.5s"},"#video:hover #video-controls":{opacity:"1.0"},"#video .video-progress-el":{position:"absolute",bottom:"0",height:"25px","border-radius":"0 0 0 5px"},"#video-progress":{width:"90%"},"#video-progress-total":{width:"100%","background-color":this.style_vals.bg,opacity:"0.7"},"#video-elapsed":{width:"0","background-color":"#6cb6f5",opacity:"0.9"},"#video #video-time":{width:"10%",right:"0","font-size":"11px","line-height":"25px",color:this.style_vals.text_main,"background-color":"#666","border-radius":"0 0 5px 0"}};this._browser_lte("ie",8)&&Ut.extend(s,{"* html #overlay":{position:"absolute"},"* html #bg":{position:"absolute"},"html, body":{height:"100%"}}),this._browser_lte("ie",7)&&Ut.extend(s,{"#mini #body":{display:"inline",zoom:"1",border:"1px solid "+this.style_vals.bg_hover},"#mini #body-text":{padding:"20px"},"#mini #mini-icon":{display:"none"}});var c=["backface-visibility","border-radius","box-shadow","opacity","perspective","transform","transform-style","transition"],u=["khtml","moz","ms","o","webkit"];for(var d in s)for(var l=0;l<c.length;l++){var f=c[l];if(f in s[d])for(var h=s[d][f],p=0;p<u.length;p++)s[d]["-"+u[p]+"-"+f]=h}var v=function(e,t){var n=function(e){var t="";for(var n in e){var i=n.replace(/#/g,"#"+En.MARKUP_PREFIX+"-").replace(/\./g,"."+En.MARKUP_PREFIX+"-");t+="\n"+i+" {";var r=e[n];for(var o in r)t+=o+":"+r[o]+";";t+="}"}return t},i=function(e){var t="";for(var i in e)t+="\n"+i+" {"+n(e[i])+"\n}";return t},r=n(e)+i(t),o=document.head||document.getElementsByTagName("head")[0]||document.documentElement,a=document.createElement("style");o.appendChild(a),a.setAttribute("type","text/css"),a.styleSheet?a.styleSheet.cssText=r:a.textContent=r};v(s,o)},En.prototype._init_video=Ut.safewrap(function(){if(this.video_url){var e=this;e.yt_custom="postMessage"in window,e.dest_url=e.video_url;var t=e.video_url.match(/(?:youtube(?:-nocookie)?\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/ ]{11})/i),n=e.video_url.match(/vimeo\.com\/.*?(\d+)/i);if(t){if(e.show_video=!0,e.youtube_video=t[1],e.yt_custom){window.onYouTubeIframeAPIReady=function(){e._get_el("video-frame")&&e._yt_video_ready()};var i=document.createElement("script");i.src="//www.youtube.com/iframe_api";var r=document.getElementsByTagName("script")[0];r.parentNode.insertBefore(i,r)}}else n&&(e.show_video=!0,e.vimeo_video=n[1]);(e._browser_lte("ie",7)||e._browser_lte("firefox",3))&&(e.show_video=!1,e.clickthrough=!0)}}),En.prototype._mark_as_shown=Ut.safewrap(function(){var e=this;Ut.register_event(e._get_el("bg"),"click",function(){e.dismiss()});var t=function(e,t){var n={};return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,null):e.currentStyle&&(n=e.currentStyle),n[t]};if(this.campaign_id){var n=this._get_el("overlay");n&&"hidden"!==t(n,"visibility")&&"none"!==t(n,"display")&&this._mark_delivery()}}),En.prototype._mark_delivery=Ut.safewrap(function(e){this.marked_as_shown||(this.marked_as_shown=!0,this.campaign_id&&(this._get_shown_campaigns()[this.campaign_id]=1*new Date,this.persistence.save()),this._track_event("$campaign_delivery",e),this.mixpanel.people.append({$campaigns:this.campaign_id,
$notifications:{campaign_id:this.campaign_id,message_id:this.message_id,type:"web",time:new Date}}))}),En.prototype._preload_images=function(e){var t=this;if(0===this.imgs_to_preload.length)return void e();for(var n=0,i=[],r=function(){n++,n===t.imgs_to_preload.length&&e&&(e(),e=null)},o=0;o<this.imgs_to_preload.length;o++){var a=new Image;a.onload=r,a.src=this.imgs_to_preload[o],a.complete&&r(),i.push(a)}this._browser_lte("ie",7)&&setTimeout(function(){var t=!0;for(o=0;o<i.length;o++)i[o].complete||(t=!1);t&&e&&(e(),e=null)},500)},En.prototype._remove_notification_el=Ut.safewrap(function(){window.clearInterval(this._video_progress_checker),this.notification_el.style.visibility="hidden",this.body_el.removeChild(this.notification_el)}),En.prototype._set_client_config=function(){var e=function(e){var t=navigator.userAgent.match(e);return t&&t[1]};this.browser_versions={},this.browser_versions.chrome=e(/Chrome\/(\d+)/),this.browser_versions.firefox=e(/Firefox\/(\d+)/),this.browser_versions.ie=e(/MSIE (\d+).+/),!this.browser_versions.ie&&!window.ActiveXObject&&"ActiveXObject"in window&&(this.browser_versions.ie=11),this.body_el=document.body||document.getElementsByTagName("body")[0],this.body_el&&(this.doc_width=Math.max(this.body_el.scrollWidth,document.documentElement.scrollWidth,this.body_el.offsetWidth,document.documentElement.offsetWidth,this.body_el.clientWidth,document.documentElement.clientWidth),this.doc_height=Math.max(this.body_el.scrollHeight,document.documentElement.scrollHeight,this.body_el.offsetHeight,document.documentElement.offsetHeight,this.body_el.clientHeight,document.documentElement.clientHeight));var t=this.browser_versions.ie,n=document.createElement("div").style,i=function(e){if(e in n)return!0;if(!t){e=e[0].toUpperCase()+e.slice(1);for(var i=["O"+e,"Webkit"+e,"Moz"+e],r=0;r<i.length;r++)if(i[r]in n)return!0}return!1};this.use_transitions=this.body_el&&i("transition")&&i("transform"),this.flip_animate=(this.browser_versions.chrome>=33||this.browser_versions.firefox>=15)&&this.body_el&&i("backfaceVisibility")&&i("perspective")&&i("transform")},En.prototype._switch_to_video=Ut.safewrap(function(){var e=this,t=[{el:e._get_notification_display_el(),attr:"opacity",start:1,goal:0},{el:e._get_notification_display_el(),attr:"top",start:En.NOTIF_TOP,goal:-500},{el:e._get_el("video-noflip"),attr:"opacity",start:0,goal:1},{el:e._get_el("video-noflip"),attr:"top",start:2*-e.video_height,goal:0}];if(e.mini){var n=e._get_el("bg"),i=e._get_el("overlay");n.style.width="100%",n.style.height="100%",i.style.width="100%",e._add_class(e._get_notification_display_el(),"exiting"),e._add_class(n,"visible"),t.push({el:e._get_el("bg"),attr:"opacity",start:0,goal:En.BG_OPACITY})}var r=e._get_el("video-holder");r.innerHTML=e.video_iframe;var o=function(){window.YT&&window.YT.loaded&&e._yt_video_ready(),e.showing_video=!0,e._get_notification_display_el().style.visibility="hidden"};e.flip_animate?(e._add_class("flipper","flipped"),setTimeout(o,En.ANIM_TIME)):e._animate_els(t,En.ANIM_TIME,o)}),En.prototype._track_event=function(e,t,n){this.campaign_id?(t=t||{},t=Ut.extend(t,{campaign_id:this.campaign_id,message_id:this.message_id,message_type:"web_inapp",message_subtype:this.notif_type}),this.mixpanel.track(e,t,n)):n&&n.call()},En.prototype._yt_video_ready=Ut.safewrap(function(){var e=this;if(!e.video_inited){e.video_inited=!0;var t=e._get_el("video-elapsed"),n=e._get_el("video-time"),i=e._get_el("video-progress");new window.YT.Player(En.MARKUP_PREFIX+"-video-frame",{events:{onReady:function(r){var o=r.target,a=o.getDuration(),s=function(e){return("00"+e).slice(-2)},c=function(e){var t=Math.round(a-e),i=Math.floor(t/60),r=Math.floor(i/60);t-=60*i,i-=60*r,n.innerHTML="-"+(r?r+":":"")+s(i)+":"+s(t)};c(0),e._video_progress_checker=window.setInterval(function(){var e=o.getCurrentTime();t.style.width=e/a*100+"%",c(e)},250),Ut.register_event(i,"click",function(e){var t=Math.max(0,e.pageX-i.getBoundingClientRect().left);o.seekTo(a*t/i.clientWidth,!0)})}}})}}),Pn.prototype.init=Pn.prototype.init,Pn.prototype.reset=Pn.prototype.reset,Pn.prototype.disable=Pn.prototype.disable,Pn.prototype.time_event=Pn.prototype.time_event,Pn.prototype.track=Pn.prototype.track,Pn.prototype.track_links=Pn.prototype.track_links,Pn.prototype.track_forms=Pn.prototype.track_forms,Pn.prototype.track_pageview=Pn.prototype.track_pageview,Pn.prototype.register=Pn.prototype.register,Pn.prototype.register_once=Pn.prototype.register_once,Pn.prototype.unregister=Pn.prototype.unregister,Pn.prototype.identify=Pn.prototype.identify,Pn.prototype.alias=Pn.prototype.alias,Pn.prototype.name_tag=Pn.prototype.name_tag,Pn.prototype.set_config=Pn.prototype.set_config,Pn.prototype.get_config=Pn.prototype.get_config,Pn.prototype.get_property=Pn.prototype.get_property,Pn.prototype.get_distinct_id=Pn.prototype.get_distinct_id,Pn.prototype.toString=Pn.prototype.toString,Pn.prototype._check_and_handle_notifications=Pn.prototype._check_and_handle_notifications,Pn.prototype._show_notification=Pn.prototype._show_notification,Tn.prototype.properties=Tn.prototype.properties,Tn.prototype.update_search_keyword=Tn.prototype.update_search_keyword,Tn.prototype.update_referrer_info=Tn.prototype.update_referrer_info,Tn.prototype.get_cross_subdomain=Tn.prototype.get_cross_subdomain,Tn.prototype.clear=Tn.prototype.clear,An.prototype.set=An.prototype.set,An.prototype.set_once=An.prototype.set_once,An.prototype.increment=An.prototype.increment,An.prototype.append=An.prototype.append,An.prototype.union=An.prototype.union,An.prototype.track_charge=An.prototype.track_charge,An.prototype.clear_charges=An.prototype.clear_charges,An.prototype.delete_user=An.prototype.delete_user,An.prototype.toString=An.prototype.toString,Ut.safewrap_class(Pn,["identify","_check_and_handle_notifications","_show_notification"]);var Ln={},On=function(){Ut.each(Ln,function(e,t){t!==en&&(Kt[t]=e)}),Kt._=Ut},Cn=function(){Kt.init=function(e,t,n){if(n)return Kt[n]||(Kt[n]=Ln[n]=Mn(e,t,n),Kt[n]._loaded()),Kt[n];var i=Kt;Ln[en]?i=Ln[en]:e&&(i=Mn(e,t,en),i._loaded(),Ln[en]=i),Kt=i,Yt===Zt&&(window[en]=Kt),On()}},In=function(){function e(){e.done||(e.done=!0,wn=!0,_n=!1,Ut.each(Ln,function(e){e._dom_loaded()}))}function t(){try{document.documentElement.doScroll("left")}catch(e){return void setTimeout(t,1)}e()}if(document.addEventListener)"complete"===document.readyState?e():document.addEventListener("DOMContentLoaded",e,!1);else if(document.attachEvent){document.attachEvent("onreadystatechange",e);var n=!1;try{n=null===window.frameElement}catch(e){}document.documentElement.doScroll&&n&&t()}Ut.register_event(window,"load",e,!0)},qn=function(e){var t=e.get_config("name");e.mp_counts=e.mp_counts||{},e.mp_counts.$__c=parseInt(Ut.cookie.get("mp_"+t+"__c"))||0;var n=function(){e.mp_counts.$__c=(e.mp_counts.$__c||0)+1,Ut.cookie.set("mp_"+t+"__c",e.mp_counts.$__c,1,!0)},i=function(){try{e.mp_counts=e.mp_counts||{},n()}catch(e){Wt.error(e)}};Ut.register_event(document,"submit",i),Ut.register_event(document,"change",i);var r=null;Ut.register_event(document,"mousedown",function(e){r=e.target}),Ut.register_event(document,"mouseup",function(e){e.target===r&&i(e)})},Rn=L(),Fn={VIDEO_BUFFER_END:"video-buffer-end",VIDEO_BUFFER_START:"video-buffer-start",VIDEO_CHANGE_QUALITY:"video-change-quality",VIDEO_CONFIG_CHANGE:"video-config-change",VIDEO_ENDED:"video-ended",VIDEO_ERROR:"video-error",VIDEO_LEAVE:"video-leave",VIDEO_MINUTE_WATCHED:"video-minute-watched",VIDEO_PAUSE:"video-pause",VIDEO_PLAY:"video-play",VIDEO_PLAYING:"video-playing",VIDEO_READY:"video-ready",VIDEO_SEEK:"video-seek",VIDEO_SEEKED:"video-seeked",VIDEO_STALLED:"video-stalled",VIDEO_STREAM_CHANGE:"video-stream-change",VIDEO_STREAM_SELECT:"video-stream-select"},Bn=function(){function e(t){Je(this,e),this.player=t,this.minuteWatchedTimerActive=!1,this.videoStarted=!1,this.videoSeeking=!1,this.videoPaused=!1,this.initialMinuteWatched=!0,this.currentMinuteWatchedTime=0,this.seekStartVideoTime=0,this.totalMinutesWatched=0,this.streamInfo=null,this.initMinuteWatchedTimer(),this.initMixPanel(),this.initEventListeners()}return Ye(e,[{key:"initMixPanel",value:function(){Rn.init(this.player.config.request.mixpanel_token),this.trackEvent(Fn.VIDEO_READY,this.eventGlobalProperties()),Rn.time_event(Fn.VIDEO_LEAVE),Rn.time_event(Fn.VIDEO_STREAM_SELECT)}},{key:"initEventListeners",value:function(){var e=this;this.player.events.on($e.playButtonPressed,function(){Rn.time_event(Fn.VIDEO_PLAYING),e.trackEvent(Fn.VIDEO_PLAY,e.eventGlobalProperties())}),this.player.telecine.on("playing",function(){e.minuteWatchedTimerActive||(e.minuteWatchedTimerActive=!0,e.videoStarted=!0,e.videoPaused=!1,e.trackEvent(Fn.VIDEO_PLAYING,e.eventGlobalProperties()))}),this.player.events.on($e.pauseButtonPressed,function(){e.minuteWatchedTimerActive=!1,e.videoPaused||(e.videoPaused=!0,e.trackEvent(Fn.VIDEO_PAUSE,e.eventGlobalProperties()))}),this.player.telecine.on("ended",function(){e.minuteWatchedTimerActive=!1,e.videoStarted=!1,e.trackEvent(Fn.VIDEO_ENDED,e.eventGlobalProperties())}),this.player.events.on($e.scrubbingStarted,function(){e.videoSeeking=!0,e.seekStartVideoTime=e.player.telecine.currentTime,Rn.time_event(Fn.VIDEO_SEEKED),e.trackEvent(Fn.VIDEO_SEEK,e.eventGlobalProperties())}),this.player.telecine.on("seeked",function(){if(e.videoSeeking){e.videoSeeking=!1;var t=e.eventGlobalProperties();t.SeekStartTime=e.seekStartVideoTime,t.SeekEndTime=e.player.telecine.currentTime,e.trackEvent(Fn.VIDEO_SEEKED,t)}}),this.player.telecine.on("error",function(t){e.minuteWatchedTimerActive=!1;var n=e.eventGlobalProperties();n.ErrorMessage=t.message,e.trackEvent(Fn.VIDEO_ERROR,n)}),this.player.telecine.on([$e.bufferStarted,"streambufferstart"],function(){e.videoStarted&&(Rn.time_event(Fn.VIDEO_BUFFER_END),e.trackEvent(Fn.VIDEO_BUFFER_START,e.eventGlobalProperties()))}),this.player.telecine.on([$e.bufferEnded,"streambufferend"],function(){e.videoStarted&&e.trackEvent(Fn.VIDEO_BUFFER_END,e.eventGlobalProperties())}),this.player.events.on(Ge.changeQuality,function(t){var n=e.eventGlobalProperties();n.RequestQuality=t,e.trackEvent(Fn.VIDEO_CHANGE_QUALITY,n)}),this.player.telecine.on("streamchange",function(t){var n=t.index,i=(t.streams,e.streamInfo);e.streamInfo=e.player.config.request.files.dash.streams[n];var r=e.eventGlobalProperties();e.videoStarted?(r.PreviousProfile=i.profile,r.PreviousStreamId=i.id,r.PreviousQuality=i.quality,e.trackEvent(Fn.VIDEO_STREAM_CHANGE,r)):e.trackEvent(Fn.VIDEO_STREAM_SELECT,r)}),this.player.events.on($e.configChanged,function(){e.minuteWatchedTimerActive=!1,e.videoSeeking=!1,e.videoPaused=!1,e.videoStarted=!1,e.minuteWatchedTimerActive=!1,Rn.time_event(Fn.VIDEO_STREAM_SELECT),e.trackEvent(Fn.VIDEO_CONFIG_CHANGE,e.eventGlobalProperties())}),this.player.telecine.on("bandwidth",function(t){e.streamInfo.bitrate=t.bitrate}),this.player.telecine.on("stalled",function(){e.trackEvent(Fn.VIDEO_STALLED,e.eventGlobalProperties())}),O(function(){e.trackEvent(Fn.VIDEO_LEAVE,e.eventGlobalProperties())})}},{key:"trackEvent",value:function(e,t){Rn.track(e,t)}},{key:"eventGlobalProperties",value:function(){var e={Autoplay:this.player.config.embed.autoplay,Bitrate:this.streamInfo?this.streamInfo.bitrate:null,CDN:this.player.telecine.currentFile.metadata.cdn||"akamai",Context:this.player.config.embed.context,Delivery:ze[this.player.telecine.currentFile.mime],Embed:!this.player.config.embed.on_site,FileQuality:this.player.telecine.currentFile.metadata.quality,Fullscreen:!!pt.element,FPS:this.streamInfo?this.streamInfo.fps:null,ID:this.player.config.video.id,Loop:!!this.player.config.embed.loop,Mime:this.player.telecine.currentFile.mime,MinutesWatched:this.totalMinutesWatched,Origin:this.player.telecine.currentFile.metadata.origin,OwnerAccountType:this.player.config.video.owner.account_type,OwnerID:this.player.config.video.owner?this.player.config.video.owner.id:0,PlayerBuild:this.player.config.request.build.player,PlayerHeight:this.player.element.querySelector(".video").getBoundingClientRect().height,PlayerURL:this.player.config.player_url,PlayerWidth:this.player.element.querySelector(".video").getBoundingClientRect().width,Privacy:this.player.config.video.privacy,Profile:this.streamInfo?this.streamInfo.profile:null,Rating:this.player.config.video.rating?this.player.config.video.rating.id:null,Referrer:this.player.config.request.referrer,SeparateAV:!!this.player.config.request.files.dash&&this.player.config.request.files.dash.separate_av,Session:this.player.config.request.session,StreamID:this.streamInfo?this.streamInfo.id:null,StreamQuality:this.streamInfo?this.streamInfo.quality:null,Type:We[this.player.telecine.currentScanner],UserAccountType:this.player.config.user.account_type,UserIsMod:this.player.config.user.mod,VODID:this.player.config.video.vod&&this.player.config.video.vod.id?this.player.config.video.vod.id:null,VODSaleID:this.player.config.video.vod&&this.player.config.video.vod.sale_id?this.player.config.video.vod.sale_id:null,VideoDuration:this.player.config.video.duration,VideoTime:this.player.telecine.currentTime,ViewMode:window.getComputedStyle(this.player.element,":after").getPropertyValue("content").replace(/["'\s]*/g,""),Volume:Math.round(100*this.player.telecine.volume),Source:this.player.telecine.currentFile.src};for(var t in this.player.config.request.ab_tests)e["Test_"+t]=this.player.config.request.ab_tests[t];return e}},{key:"logMinuteWatched",value:function(){this.trackEvent(Fn.VIDEO_MINUTE_WATCHED,this.eventGlobalProperties())}},{key:"initMinuteWatchedTimer",value:function(){var e=this,t=Math.floor(60*Math.random());setInterval(function(){if(e.minuteWatchedTimerActive)return e.currentMinuteWatchedTime++,e.initialMinuteWatched?void(e.currentMinuteWatchedTime===t&&(e.initialMinuteWatched=!1,e.currentMinuteWatchedTime=0,e.totalMinutesWatched++,e.logMinuteWatched())):void(e.currentMinuteWatchedTime>=60&&(e.currentMinuteWatchedTime=0,e.totalMinutesWatched++,e.logMinuteWatched()))},1e3)}}]),e}();R.prototype={get complement(){var e=this.clone();return e.rgb={red:255-this.red,green:255-this.green,blue:255-this.blue},e},get hex(){return R.rgbToHex(this.red,this.green,this.blue)},set hex(e){return this.rgba=R.hexToRgb(e),this},get hsl(){return"hsl("+this.hue+","+this.saturation+"%,"+Math.round(this.lightness)+"%)"},set hsl(e){this.hue=e.hue,this.saturation=e.saturation,this.lightness=e.lightness;var t=R.hslToRgb(e.hue,e.saturation,e.lightness);return this.red=t.red,this.green=t.green,this.blue=t.blue,this.alpha=t.alpha,this},get luminance(){function e(e){return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}var t=e(this.red/255),n=e(this.green/255),i=e(this.blue/255),r=.2126*t+.7152*n+.0722*i;return r},get rgb(){return"rgb("+this.red+","+this.green+","+this.blue+")"},set rgb(e){return this.rgba=e,this},get rgba(){return"rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")"},set rgba(e){this.red=e.red,this.green=e.green,this.blue=e.blue,this.alpha=e.alpha||1;var t=R.rgbToHsl(e.red,e.green,e.blue);return this.hue=t.hue,this.saturation=t.saturation,this.lightness=t.lightness,this},get yiq(){return(299*this.red+587*this.green+114*this.blue)/1e3},clone:function(){return new R(this)},lighten:function(e,t,n){if(this.hsl={hue:this.hue,saturation:this.saturation,lightness:this.lightness+e},t&&n)for(var i=n.contrast(this).ratio;i<t&&(this.lighten(5),i=n.contrast(this).ratio,!(this.lightness>=100)););return this},darken:function(e,t,n){if(this.hsl={hue:this.hue,saturation:this.saturation,lightness:this.lightness-e},t&&n)for(var i=n.contrast(this).ratio;i<t&&(this.darken(5),i=n.contrast(this).ratio,!(this.lightness<=0)););return this},overlayOn:function(e){if(this.alpha>=1)return this;var t=this.clone();return t.rgba={red:t.red*this.alpha+e.red*e.alpha*(1-this.alpha),green:t.green*this.alpha+e.green*e.alpha*(1-this.alpha),blue:t.blue*this.alpha+e.blue*e.alpha*(1-this.alpha),alpha:t.alpha+e.alpha*(1-this.alpha)},t},contrast:function(e){var t=this.alpha;if(t>=1){e.alpha<1&&(e=e.overlayOn(this));var n=this.luminance+.05,i=e.luminance+.05,r=n/i;return i>n&&(r=1/r),r=Math.round(10*r)/10,{ratio:r,error:0,min:r,max:r}}var o=this.overlayOn(R.white).contrast(e).ratio,a=this.overlayOn(R.black).contrast(e).ratio,s=Math.max(o,a),c={red:Math.min(Math.max(0,(e.red-this.red*t)/(1-t)),255),green:Math.min(Math.max(0,(e.green-this.green*t)/(1-t)),255),blue:Math.min(Math.max(0,(e.blue-this.blue*t)/(1-t)),255)},u=this.clone();u.rgb=c;var d=this.overlayOn(u).contrast(e).ratio;return{ratio:Math.round((d+s)/2*10)/10,error:Math.round((s-d)/2*10)/10,min:d,max:s,closest:u,farthest:a===s?R.white:R.black}},wcagAACompliant:function(e){return this.contrast(e).ratio>=4.5},wcagAAACompliant:function(e){return this.contrast(e).ratio>=7},yiqContrastColor:function(){return this.yiq>=120?new R(0,0,0):new R(255,255,255)}},R.hexToRgb=function(e){var t;return e=String(e),3===e.length||4===e.length?(t=/^#?([A-Fa-f0-9])([A-Fa-f0-9])([A-Fa-f0-9])$/i.exec(e),t&&(t[1]+=t[1],t[2]+=t[2],t[3]+=t[3])):t=/^#?([A-Fa-f0-9]{2})([A-Fa-f0-9]{2})([A-Fa-f0-9]{2})$/i.exec(e),t?{red:parseInt(t[1],16),green:parseInt(t[2],16),blue:parseInt(t[3],16),alpha:1}:null},R.rgbToHex=function(e,t,n){return"#"+((1<<24)+(Math.round(e)<<16)+(Math.round(t)<<8)+Math.round(n)).toString(16).slice(1)},R.rgbToHsl=function(e,t,n){e/=255,t/=255,n/=255;var i=Math.max(e,t,n),r=Math.min(e,t,n),o=(i+r)/2,a=o,s=o;if(i===r)return{hue:0,saturation:0,lightness:100*s};var c=i-r;return a=s>.5?c/(2-i-r):c/(i+r),i===e?o=(t-n)/c+(t<n?6:0):i===t?o=(n-e)/c+2:i===n&&(o=(e-t)/c+4),o/=6,{hue:Math.round(360*o),saturation:Math.round(100*a),lightness:Math.round(100*s)}},R.hslToRgb=function(e,t,n){function i(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),6*n<1?e+6*(t-e)*n:2*n<1?t:3*n<2?e+(t-e)*(6*(2/3-n)):e}if(e/=360,t/=100,n/=100,0===t)return{red:Math.floor(255*n),green:Math.floor(255*n),blue:Math.floor(255*n)};var r=n<.5?n*(1+t):n+t-t*n,o=2*n-r;return{red:Math.floor(255*i(o,r,e+1/3)),green:Math.floor(255*i(o,r,e)),blue:Math.floor(255*i(o,r,e-1/3))}},R.hslToHex=function(e,t,n){var i=R.hslToRgb(e,t,n);return R.rgbToHex(i.red,i.green,i.blue)},R.white=new R("fff"),R.black=new R("000");var Dn=6e4,Nn=window.Array.from,Hn=[1];"function"==typeof Nn&&Nn(Hn)===Hn&&(Nn=!1);var Vn=Nn||function(e){return[].slice.call(e,0)},jn=["quality","volume","captions"],zn=null,Un=function(){function e(t){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=n.displayTimeout,r=void 0===i?0:i,o=n.label,a=void 0===o?"Alert":o;Je(this,e),A(this),this._container=t,this._visible=!1,this._message=null,this._alert=null,this._alertLabel=a;var s=Math.round(r/1e3);0!==s&&(this._alertLabel=a+" Will be dismissed in "+s+" seconds"),this._displayTimer=null,this._displayTimeout=r,this._renderTemplate(),this._attachEvents()}return Ye(e,[{key:"show",value:function(e){var t=this;if(this._visible!==!0){clearTimeout(this._displayTimer),this._alert.classList.remove("hidden"),this._alert.removeAttribute("hidden"),window.requestAnimationFrame(function(){t._alert.classList.add("in")});var n=this._alert.querySelector("[data-alert-autofocus]")||this._alert;n.focus(),this._visible=!0,this.fire("show",e),0!==this._displayTimeout&&(this._displayTimer=setTimeout(function(){t.hide("timeout")},this._displayTimeout))}}},{key:"hide",value:function(e){var t=this;this._visible!==!1&&(clearTimeout(this._displayTimer),this._alert.classList.add("leaving"),window.requestAnimationFrame(function(){var e=t;t._setHideAttributes(),it(t._alert).on("transitionend",function t(n){"opacity"===n.propertyName&&(e._alert.classList.remove("leaving"),e._alert.classList.add("hidden"),e._alert.setAttribute("hidden",""),it(e._alert).off("transitionend",t))})}),this._visible=!1,this.fire("hide",e))}},{key:"_setHideAttributes",value:function(){this._alert.classList.remove("in")}},{key:"_renderTemplate",value:function(){this._alert||(this._alert=document.createElement("div"),this._alert.setAttribute("role","alertdialog"),this._alert.setAttribute("aria-label",this._alertLabel),this._alert.setAttribute("aria-atomic","true"),this._alert.classList.add("player-alert"),this._alert.classList.add("hidden"),this._alert.setAttribute("hidden",""),this._container.appendChild(this._alert),this._setHideAttributes()),this._message instanceof HTMLElement?(this._alert.innerHTML="",this._alert.appendChild(this._message)):(this._alert.textContent=this._message,this._alert.innerHTML=this._message);var e=document.createElement("button");e.setAttribute("data-close",""),e.setAttribute("aria-label","Close alert"),e.classList.add("close"),e.innerHTML=ft.render("icon_close"),this._alert.appendChild(e)}},{key:"_attachEvents",value:function(){var e=this;it(this._alert).on("click","[data-close]",function(t){e.hide(t)})}},{key:"visible",get:function(){return this._visible}},{key:"message",get:function(){return this._message},set:function(e){e instanceof HTMLElement&&this._message&&e.textContent===this._message.textContent||e!==this._message&&(this._message=e,this._renderTemplate())}}]),e}(),Wn=function(){function e(t,n,i){var r=this;Je(this,e),A(this),this.version=i,this.visible=!1;var o=this._wrap=document.createElement("div");o.classList.add("compass-wrapper"),o.innerHTML=ft.render("compass",{version:i}),o.classList.add("cloaked"),t.appendChild(o),n&&o.addEventListener("click",n),this._layerSlice=o.querySelector(".compass-slice"),this._lineSlice=o.querySelector(".compass-line");var a=function(){r._mouseIn=!0},s=function(e){return function(){setTimeout(function(){r._mouseIn||(r.fade(),r._mouseIn=!1)},e)}};it(this._wrap).on("mousein",a).on("pointerin",a).on("mouseout",s(1e3)).on("pointerout",s(1e3)),s(2e3)()}return Ye(e,[{key:"setAngle",value:function(e,t){var n=this;this._animationFrame&&window.cancelAnimationFrame(this._animationFrame);var i=0;1===this.version?i=-45:2===this.version&&(i=-30);var r=""+(i+t),o=(e+85)/170,a=18;this._animationFrame=window.requestAnimationFrame(function(){n._layerSlice.setAttribute("transform","rotate("+r+", "+a+", "+a+")"),n._lineSlice&&n._lineSlice.setAttribute("d",n._getLinePath(o,a))})}},{key:"_getLinePath",value:function(e,t){var n=5,i=2*t-Math.round(2*t*e),r=2*Math.sqrt(2*i*t-Math.pow(i,2)),o=(2*t-r)/2,a=o+n,s=2*t-o-n;return"M"+a+","+i+" L"+s+","+i+" z"}},{key:"reveal",value:function(){var e=this;this._wrap.classList.remove("cloaked"),window.requestAnimationFrame(function(){e._wrap.classList.add("in")}),this.visible=!0}},{key:"fade",value:function(){this._wrap.classList.add("fade"),this.visible=!0}},{key:"hide",value:function(){var e=this;this._wrap.classList.remove("in"),this._wrap.classList.remove("fade"),this._wrap.classList.add("leaving");var t=function t(){"opacity"===event.propertyName&&(e._wrap.classList.remove("leaving"),e._wrap.classList.add("cloaked"),e.visible=!1),it(e._wrap).off("transitionend",t)};it(this._wrap).on("transitionend",t)}}]),e}(),Gn=t(function(e){e.exports=function(){var e;if("function"!=typeof Symbol)return!1;e=Symbol("test symbol");try{String(e)}catch(e){return!1}return"symbol"==typeof Symbol.iterator||"object"==typeof Symbol.isConcatSpreadable&&("object"==typeof Symbol.iterator&&("object"==typeof Symbol.toPrimitive&&("object"==typeof Symbol.toStringTag&&"object"==typeof Symbol.unscopables)))}}),$n=e(Gn),Xn=Object.freeze({default:$n}),Jn=t(function(e){e.exports=function(){var e,t=Object.assign;return"function"==typeof t&&(e={foo:"raz"},t(e,{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}}),Yn=e(Jn),Kn=Object.freeze({default:Yn}),Qn=t(function(e){e.exports=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}}}),Zn=e(Qn),ei=Object.freeze({default:Zn}),ti=t(function(e){var t=Object.keys;e.exports=function(e){return t(null==e?e:Object(e))}}),ni=e(ti),ii=Object.freeze({default:ni}),ri=t(function(t){t.exports=e(ei)()?Object.keys:e(ii)}),oi=e(ri),ai=Object.freeze({default:oi}),si=t(function(e){e.exports=function(e){if(null==e)throw new TypeError("Cannot use null or undefined");return e}}),ci=e(si),ui=Object.freeze({default:ci}),di=t(function(t){var n=e(ai),i=e(ui),r=Math.max;t.exports=function(e,t){var o,a,s,c=r(arguments.length,2);for(e=Object(i(e)),s=function(n){try{e[n]=t[n]}catch(e){o||(o=e)}},a=1;a<c;++a)t=arguments[a],n(t).forEach(s);if(void 0!==o)throw o;return e}}),li=e(di),fi=Object.freeze({default:li}),hi=t(function(t){t.exports=e(Kn)()?Object.assign:e(fi)}),pi=e(hi),vi=Object.freeze({default:pi}),gi=t(function(e){var t=Array.prototype.forEach,n=Object.create,i=function(e,t){var n;for(n in e)t[n]=e[n]};e.exports=function(e){var r=n(null);return t.call(arguments,function(e){null!=e&&i(Object(e),r)}),r}}),mi=e(gi),yi=Object.freeze({default:mi}),_i=t(function(e){e.exports=function(e){return"function"==typeof e}}),bi=e(_i),wi=Object.freeze({default:bi}),ki=t(function(e){var t="razdwatrzy";e.exports=function(){return"function"==typeof t.contains&&(t.contains("dwa")===!0&&t.contains("foo")===!1)}}),Si=e(ki),xi=Object.freeze({default:Si}),Ti=t(function(e){var t=String.prototype.indexOf;e.exports=function(e){return t.call(this,e,arguments[1])>-1}}),Ei=e(Ti),Pi=Object.freeze({default:Ei}),Ai=t(function(t){t.exports=e(xi)()?String.prototype.contains:e(Pi)}),Mi=e(Ai),Li=Object.freeze({default:Mi}),Oi=t(function(t){var n,i=e(vi),r=e(yi),o=e(wi),a=e(Li);n=t.exports=function(e,t){var n,o,s,c,u;return arguments.length<2||"string"!=typeof e?(c=t,t=e,e=null):c=arguments[2],null==e?(n=s=!0,o=!1):(n=a.call(e,"c"),o=a.call(e,"e"),s=a.call(e,"w")),u={value:t,configurable:n,enumerable:o,writable:s},c?i(r(c),u):u},n.gs=function(e,t,n){var s,c,u,d;return"string"!=typeof e?(u=n,n=t,t=e,e=null):u=arguments[3],null==t?t=void 0:o(t)?null==n?n=void 0:o(n)||(u=n,n=void 0):(u=t,t=n=void 0),null==e?(s=!0,c=!1):(s=a.call(e,"c"),c=a.call(e,"e")),d={get:t,set:n,configurable:s,enumerable:c},u?i(r(u),d):d}}),Ci=e(Oi),Ii=Object.freeze({default:Ci}),qi=t(function(e){e.exports=function(e){return e&&("symbol"==typeof e||"Symbol"===e["@@toStringTag"])||!1}}),Ri=e(qi),Fi=Object.freeze({default:Ri}),Bi=t(function(t){var n=e(Fi);t.exports=function(e){if(!n(e))throw new TypeError(e+" is not a symbol");return e}}),Di=e(Bi),Ni=Object.freeze({default:Di}),Hi=t(function(t){var n,i,r,o=e(Ii),a=e(Ni),s=Object.create,c=Object.defineProperties,u=Object.defineProperty,d=Object.prototype,l=s(null);"function"==typeof Symbol&&(n=Symbol);var f=function(){var e=s(null);return function(t){for(var n,i,r=0;e[t+(r||"")];)++r;return t+=r||"",e[t]=!0,n="@@"+t,u(d,n,o.gs(null,function(e){i||(i=!0,u(this,n,o(e)),i=!1)})),n}}();r=function(e){if(this instanceof r)throw new TypeError("TypeError: Symbol is not a constructor");return i(e)},t.exports=i=function e(t){var n;if(this instanceof e)throw new TypeError("TypeError: Symbol is not a constructor");return n=s(r.prototype),t=void 0===t?"":String(t),c(n,{__description__:o("",t),__name__:o("",f(t))})},c(i,{for:o(function(e){return l[e]?l[e]:l[e]=i(String(e))}),keyFor:o(function(e){var t;a(e);for(t in l)if(l[t]===e)return t}),hasInstance:o("",n&&n.hasInstance||i("hasInstance")),isConcatSpreadable:o("",n&&n.isConcatSpreadable||i("isConcatSpreadable")),iterator:o("",n&&n.iterator||i("iterator")),match:o("",n&&n.match||i("match")),replace:o("",n&&n.replace||i("replace")),search:o("",n&&n.search||i("search")),species:o("",n&&n.species||i("species")),split:o("",n&&n.split||i("split")),toPrimitive:o("",n&&n.toPrimitive||i("toPrimitive")),toStringTag:o("",n&&n.toStringTag||i("toStringTag")),unscopables:o("",n&&n.unscopables||i("unscopables"))}),c(r.prototype,{constructor:o(i),toString:o("",function(){return this.__name__})}),c(i.prototype,{toString:o(function(){return"Symbol ("+a(this).__description__+")"}),valueOf:o(function(){return a(this)})}),u(i.prototype,i.toPrimitive,o("",function(){return a(this)})),u(i.prototype,i.toStringTag,o("c","Symbol")),u(r.prototype,i.toStringTag,o("c",i.prototype[i.toStringTag])),u(r.prototype,i.toPrimitive,o("c",i.prototype[i.toPrimitive]))}),Vi=e(Hi),ji=Object.freeze({default:Vi}),zi=t(function(t){t.exports=e(Xn)()?Symbol:e(ji)}),Ui=e(zi),Wi=window.WeakMap||function(){var e=Object.defineProperty,t=Date.now()%1e9,n=function(){this.name="__st"+(1e9*Math.random()>>>0)+(t++ +"__")};return n.prototype.set=function(t,n){if("object"!==("undefined"==typeof t?"undefined":Xe(t))&&"function"!=typeof t)throw new TypeError("Invalid value used as weak map key");var i=t[this.name];return i&&i[0]===t?i[1]=n:e(t,this.name,{value:[t,n],writable:!0}),this},n.prototype.get=function(e){var t;return(t=e[this.name])&&t[0]===e?t[1]:void 0},n.prototype.delete=function(e){var t=e[this.name];return!(!t||t[0]!==e)&&(t[0]=t[1]=void 0,!0)},n.prototype.has=function(e){var t=e[this.name];return!!t&&t[0]===e},n}(),Gi="function"==typeof Ui&&"symbol"==typeof Ui.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Ui&&e.constructor===Ui&&e!==Ui.prototype?"symbol":typeof e},$i=(function(){function e(e){this.value=e}function t(t){function n(e,t){return new He(function(n,r){var s={key:e,arg:t,resolve:n,reject:r,next:null};a?a=a.next=s:(o=a=s,i(e,t))})}function i(n,o){try{var a=t[n](o),s=a.value;s instanceof e?He.resolve(s.value).then(function(e){i("next",e)},function(e){i("throw",e)}):r(a.done?"return":"normal",a.value)}catch(e){r("throw",e)}}function r(e,t){switch(e){case"return":o.resolve({value:t,done:!0});break;case"throw":o.reject(t);break;default:o.resolve({value:t,done:!1})}o=o.next,o?i(o.key,o.arg):a=null}var o,a;this._invoke=n,"function"!=typeof t.return&&(this.return=void 0)}return"function"==typeof Ui&&Ui.asyncIterator&&(t.prototype[Ui.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype.throw=function(e){return this._invoke("throw",e)},t.prototype.return=function(e){return this._invoke("return",e)},{wrap:function(e){return function(){return new t(e.apply(this,arguments))}},await:function(t){return new e(t)}}}(),function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}),Xi=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),Ji=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},Yi=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},Ki=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},Qi=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},Zi=function e(t,n,i,r){var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var a=Object.getPrototypeOf(t);null!==a&&e(a,n,i,r)}else if("value"in o&&o.writable)o.value=i;else{var s=o.set;void 0!==s&&s.call(r,i)}return i},er=function(){function e(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Ui.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Ui.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),TelecineError=function TelecineError(e,t){$i(this,TelecineError),this.name=e,this.message=t,Object.freeze(this)},tr=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};$i(this,e),this._telecine=t,this._element=t._element,this._options=n}return Xi(e,null,[{key:"displayName",get:function(){
return"Effect"}},{key:"supported",get:function(){return!1}},{key:"supportedScanners",get:function(){return[]}}]),Xi(e,[{key:"activate",value:function(){throw new TelecineError("NotImplemented","The effect must implement the activate method.")}},{key:"deactivate",value:function(){throw new TelecineError("NotImplemented","The effect must implement the deactivate method.")}}]),e}(),nr=/Firefox/.test(navigator.userAgent),ir=/i(Phone|Pad|Pod touch);/.test(navigator.userAgent),rr=/Android/.test(navigator.userAgent),or=rr&&/mobile/.test(navigator.userAgent.toLowerCase()),ar={firefox:nr,iOS:ir,android:rr,androidMobile:or},sr=function(e){for(var t=0,n=this.length;t<n;t++)if(this[t].id===""+e)return this[t];return null},cr=function(e,t){if(!e||void 0===e[t])throw ie(1,"INDEX_SIZE_ERR");return e[t]};ve.from=function(e){if(!(e instanceof TimeRanges))throw new TypeError("Can only create a TelecineTimeRange from a TimeRanges object.");for(var t=[],n=[],i=0,r=e.length;i<r;i++)t.push(e.start(i)),n.push(e.end(i));return ve(t,n)};var ur=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};$i(this,e),this._element=t,this._options=n,this._telecineVideo=null,this._currentFile=null,this._externalDisplays=[],ne(this)}return Xi(e,null,[{key:"displayName",get:function(){return"Scanner"}},{key:"supported",get:function(){return!1}},{key:"supportedVideoTypes",get:function(){return[]}},{key:"supportedAudioTypes",get:function(){return[]}},{key:"supportedExternalDisplays",get:function(){return[]}},{key:"supportsSettingVolume",get:function(){return!0}},{key:"supportsTextTracks",get:function(){return!1}}]),Xi(e,[{key:"deactivate",value:function(){this._telecineVideo&&(this._telecineVideo.off("filesrcupdate"),this._telecineVideo.off("texttracksrcupdate"))}},{key:"reactivate",value:function(){}},{key:"play",value:function(){throw new TelecineError("NotImplemented","The scanner must implement the play method.")}},{key:"pause",value:function(){throw new TelecineError("NotImplemented","The scanner must implement the pause method.")}},{key:"addTextTrack",value:function(e){return this}},{key:"removeTextTrack",value:function(e){return this}},{key:"getCuesForTrack",value:function(e){return[]}},{key:"getActiveCuesForTrack",value:function(e){return[]}},{key:"setModeForTrack",value:function(e,t){return this}},{key:"setSrcForTrack",value:function(e,t){return this}},{key:"showExternalDisplayPicker",value:function(e){if(!this._externalDisplays.length)throw new TelecineError("externalDisplayUnvailable","No external displays are available.");if(!e)return void this._externalDisplays[0].showPicker();var t=this._externalDisplays.filter(function(t){return t.constructor.displayName.replace("ExternalDisplay","")===e})[0];if(!t)throw new TelecineError("invalidExternalDisplay","The specified external display is not available.");t.showPicker()}},{key:"_pickFile",value:function(){if(this._files.length<1)return null;var e=this._files.slice(0).sort(function(e,t){return e.priority-t.priority});return e[0]}},{key:"_updateCurrentFile",value:function(){var e=this._pickFile();return e?void(this.currentFile=e):void this.fire("scannererror",{reason:"all files failed"})}},{key:"_switchToNextFile",value:function(){var e=this._files.indexOf(this._currentFile);this._files.splice(e,1),this._updateCurrentFile()}},{key:"buffered",get:function(){return ve()}},{key:"currentFile",get:function(){return this._currentFile},set:function(e){this._currentFile=e,this.fire("currentfilechange",e)}},{key:"currentTime",get:function(){return 0},set:function(e){}},{key:"duration",get:function(){return NaN}},{key:"ended",get:function(){return!1}},{key:"externalDisplayAvailable",get:function(){return this._externalDisplays.some(function(e){return e.available})}},{key:"externalDisplayActive",get:function(){return this._externalDisplays.some(function(e){return e.active})}},{key:"loop",get:function(){return!1},set:function(e){}},{key:"muted",get:function(){return!1},set:function(e){}},{key:"paused",get:function(){return!0}},{key:"playbackRate",get:function(){return 1},set:function(e){}},{key:"preload",get:function(){return"none"},set:function(e){}},{key:"presentationMode",get:function(){return"inline"},set:function(e){if(this.supportedPresentationModes.indexOf(e)===-1)throw new TelecineError("invalidPresentationMode","The “"+e+"” presentation mode is not supported.")}},{key:"supportedPresentationModes",get:function(){return["inline"]}},{key:"video",get:function(){return this._telecineVideo},set:function(e){var t=this;this.reactivate(),this._telecineVideo!==e&&(this._telecineVideo&&(this._telecineVideo.off("filesrcupdate"),this._telecineVideo.off("texttracksrcupdate")),this._telecineVideo=e,this._files=e.files.filter(function(e){return t.constructor.supportedVideoTypes.indexOf(e.mime)!==-1}),this._telecineVideo.on("filesrcupdate",function(e){e===t._currentFile&&t._updateCurrentFile()}),this._telecineVideo.on("texttracksrcupdate",function(e){t.video.currentScanner&&t.video.currentScanner.setSrcForTrack(e,e.src)}),this._options.externalDisplays&&this._options.externalDisplays.length&&!function(){t._externalDisplays=[];var n=t.constructor.supportedExternalDisplays.map(function(e){return e.displayName});t._options.externalDisplays.filter(function(e){return e.supported&&n.indexOf(e.displayName)!==-1}).forEach(function(n){var i=new n(e),r=n.displayName.replace("ExternalDisplay","");i.on("available",function(){return t.fire("externaldisplayavailable",{type:r})}),i.on("unavailable",function(){return t.fire("externaldisplayunavailable",{type:r})}),i.on("activated",function(){"function"==typeof t.onexternaldisplayactivated&&t.onexternaldisplayactivated(i),t.fire("externaldisplayactivated",{type:r})}),i.on("deactivated",function(){"function"==typeof t.onexternaldisplaydeactivated&&t.onexternaldisplaydeactivated(i),t.fire("externaldisplaydeactivated",{type:r})}),t._externalDisplays.push(i)})}(),this._updateCurrentFile())}},{key:"videoWidth",get:function(){return 0}},{key:"videoHeight",get:function(){return 0}},{key:"volume",get:function(){return 1},set:function(e){}}]),e}(),dr=["abort","canplay","canplaythrough","durationchange","emptied","ended","error","loadeddata","loadedmetadata","loadstart","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting","webkitbeginfullscreen","webkitendfullscreen","webkitpresentationmodechanged"],lr=["externaldisplayavailable","externaldisplayunavailable","externaldisplayactivated","externaldisplaydeactivated"],fr=["scannerchange","scannererror","drmauthfailure","drmauthsuccess","drmfailure","emeunsupported","currentfilechange","streamchange","streambufferstart","streambufferend","droppedframes","bandwidth","streamtargetchange","alert","presentationmodechange"],hr=[].concat(dr,lr,fr),pr=function(){function e(t){var n=this;$i(this,e),this._interval=null,this._rates=[],this._averageRate=0,this._lastChecked=null,this._lastLoaded=0,this._scanner=t,this._scanner.on("loadstart",function(){return n.startInterval()}),this._scanner.on("progress",function(){return n.startInterval()}),this._scanner.on("ended",function(){return n.stopInterval()})}return Xi(e,[{key:"startInterval",value:function(){var e=this;this._interval||(this._interval=window.setInterval(function(){return e.updateDownloadRate()},1e3))}},{key:"stopInterval",value:function(){window.clearInterval(this._interval)}},{key:"updateDownloadRate",value:function(){for(var e=ce(),t=0,n=this._scanner.buffered,i=Array.isArray(n),r=0,n=i?n:n[Ui.iterator]();;){var o;if(i){if(r>=n.length)break;o=n[r++]}else{if(r=n.next(),r.done)break;o=r.value}var a=o,s=er(a,2),c=s[0],u=s[1];t+=u-c}if(!this._lastChecked)return this._lastChecked=e,void(this._lastLoaded=t);if(this._lastLoaded!==t){var d=Math.max(t-this._lastLoaded,0);this._rates.push(d),this._rates=this._rates.slice(-15),this._averageRate=this._rates.reduce(function(e,t){return e+t})/this._rates.length,this._lastChecked=e,this._lastLoaded=t,Math.round(t)>=Math.round(this._scanner.duration)&&this.stopInterval()}}},{key:"averageDownloadRate",get:function(){return this._averageRate}}]),e}(),vr=function(){function e(t){$i(this,e),this._available=!1,this._active=!1,this._video=t,ne(this)}return Xi(e,null,[{key:"displayName",get:function(){return"ExternalDisplay"}},{key:"supported",get:function(){return!1}},{key:"supportedVideoTypes",get:function(){return[]}}]),Xi(e,[{key:"showPicker",value:function(){}},{key:"getFile",value:function(){var e=this.constructor.displayName.replace("ExternalDisplay","");if(this._video.externalDisplayFiles[e])return this._video.externalDisplayFiles[e];var t=this.constructor.supportedVideoTypes,n=this._video.files.filter(function(e){return t.indexOf(e.mime)!==-1}).sort(function(e,n){return e.mime===n.mime?e.priority-n.priority:t.indexOf(e.mime)-t.indexOf(n.mime)});if(!n.length)throw new Error("No files available for "+this.constructor.displayName+" external display.");return n[0]}},{key:"active",get:function(){return this._active}},{key:"available",get:function(){return this._available}},{key:"element",get:function(){return document.createElement("div")}}]),e}(),AirPlayExternalDisplay=function(e){function AirPlayExternalDisplay(e){$i(this,AirPlayExternalDisplay);var t=Qi(this,(AirPlayExternalDisplay.__proto__||Object.getPrototypeOf(AirPlayExternalDisplay)).call(this,e));return t._videoElement=document.createElement("video"),t._videoElement.setAttribute("data-airplay",""),t._videoElement.setAttribute("x-webkit-airplay","allow"),t.addVideoEventListeners(),t}return Ki(AirPlayExternalDisplay,e),Xi(AirPlayExternalDisplay,null,[{key:"displayName",get:function(){return"AirPlayExternalDisplay"}},{key:"supported",get:function(){return"WebKitPlaybackTargetAvailabilityEvent"in window}},{key:"supportedVideoTypes",get:function(){return["application/vnd.apple.mpegurl","video/mp4"]}}]),Xi(AirPlayExternalDisplay,[{key:"addVideoEventListeners",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._videoElement;t.addEventListener("webkitplaybacktargetavailabilitychanged",function(t){switch(t.availability){case"available":e._available||(e._available=!0,e.fire("available"));break;case"not-available":e._available&&(e._available=!1,e.fire("unavailable"))}}),t.addEventListener("webkitcurrentplaybacktargetiswirelesschanged",function(t){return t.target.webkitCurrentPlaybackTargetIsWireless?(e._active=!0,void e.fire("activated")):(e._active=!1,void e.fire("deactivated"))})}},{key:"showPicker",value:function(){var e=this;this._videoElement.webkitShowPlaybackTargetPicker(),this.loadMetadata().then(function(){e._videoElement.webkitShowPlaybackTargetPicker()})}},{key:"loadMetadata",value:function(){var e=this;return this._videoElement.readyState>=1?He.resolve():new He(function(t,n){e._videoElement.addEventListener("loadedmetadata",function(){t()}),e._videoElement.src=e.getFile().src})}},{key:"element",get:function(){return this._videoElement},set:function(e){if(!(e instanceof HTMLVideoElement))throw new TypeError("The element for AirPlay must be a <video>.");e!==this._videoElement&&(this.addVideoEventListeners(e),this._videoElement=e,this._videoElement.setAttribute("x-webkit-airplay","allow"))}}]),AirPlayExternalDisplay}(vr),gr=document.createElement("video"),mr={"application/vnd.apple.mpegurl":"application/vnd.apple.mpegurl","video/mp4":'video/mp4; codecs="avc1.64001E"',"video/webm":'video/webm; codecs="vp8, vorbis"',"video/x-flv":'video/x-flv; codecs="vp6"'},yr=function(){var e="undefined"!=typeof TextTrack?TextTrack:{};return{disabled:"DISABLED"in e?e.DISABLED:"disabled",hidden:"HIDDEN"in e?e.HIDDEN:"hidden",showing:"SHOWING"in e?e.SHOWING:"showing"}}(),_r=function(){var e=document.createElement("track");return"track"in e&&"oncuechange"in e.track}(),br=0,wr=1,kr=2,Sr=3,xr=4,Tr=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};$i(this,t);var i=Qi(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),r=e.querySelector("video");return r||(r=document.createElement("video"),r.preload="none",i._element.appendChild(r)),i._video=r,n.htmlScanner&&n.htmlScanner.controls&&(i._video.controls=!0),i._boundHandleVideoEvent=i.handleVideoEvent.bind(i),i.addVideoEventListeners(),i._downloadRate=new pr(i),i._bufferTimer=null,i._readyState=br,i._paused=!0,i._preload="none",i._externalDisplayActivated=!1,i}return Ki(t,e),Xi(t,null,[{key:"displayName",get:function(){return"HTMLScanner"}},{key:"supported",get:function(){return t.supportedVideoTypes.length>0}},{key:"supportedVideoTypes",get:function(){var e=[];if("function"!=typeof gr.canPlayType)return e;for(var t in mr){var n=mr[t];ar.android&&"application/vnd.apple.mpegurl"===t||(!ar.android||ar.androidMobile||"video/mp4"!==t?gr.canPlayType(n).replace(/^no$/,"")&&e.push(t):e.push(t))}return e}},{key:"supportedExternalDisplays",get:function(){return[AirPlayExternalDisplay]}},{key:"supportsSettingVolume",get:function(){if(ar.android)return!1;var e=gr.volume;return gr.volume=.5*e,gr.volume!==e}},{key:"supportsTextTracks",get:function(){return"undefined"!=typeof gr.textTracks&&gr.textTracks instanceof TextTrackList}}]),Xi(t,[{key:"deactivate",value:function(){Yi(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"deactivate",this).call(this),this.removeVideoEventListeners(),this.removeSnapshot(),this._video.style.display="none"}},{key:"reactivate",value:function(){Yi(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"reactivate",this).call(this),this.addVideoEventListeners(),this._video.style.display=""}},{key:"addVideoEventListeners",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._video;dr.forEach(function(n){t.addEventListener(n,e._boundHandleVideoEvent)})}},{key:"removeVideoEventListeners",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._video;dr.forEach(function(n){t.removeEventListener(n,e._boundHandleVideoEvent)})}},{key:"play",value:function(){this._video.preload="",this._paused=!1,this._video.play()}},{key:"pause",value:function(){this._paused=!0,this._video.pause()}},{key:"addTextTrack",value:function(e){var n=this,i=document.createElement("track");return i.id="telecine-track-"+e.id,i.src=e.src,i.kind=e.kind,i.srclang=e.language,i.label=e.label,i.addEventListener("cuechange",function(){return e.dispatchEvent("cuechange")}),this._video.addEventListener("timeupdate",function(){n._video.webkitDisplayingFullscreen&&(e.mode=i.track.mode)}),i.addEventListener("load",function(){var t=ar.iOS&&n._video.webkitDisplayingFullscreen;return e._modeHasBeenSet&&!t?void(i.track.mode=yr[e.mode]):void(e.mode=i.track.mode)}),e._modeHasBeenSet&&(i.track.mode=yr[e.mode]),_r||!function(){var t=[];n._video.addEventListener("timeupdate",function(){var n=i.track;if("disabled"!==yr[n.mode]){if(t.length!==n.activeCues.length)return e.dispatchEvent("cuechange"),void(t=Vn(n.activeCues));for(var r=0,o=n.activeCues.length;r<o;r++)if(n.activeCues[r].startTime!==t[r].startTime)return e.dispatchEvent("cuechange"),void(t=Vn(n.activeCues))}})}(),he(function(){return n._video.appendChild(i)}),Yi(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"addTextTrack",this).call(this,e)}},{key:"removeTextTrack",value:function(e){var n=this._video.querySelector("#telecine-track-"+e.id);return n&&this._video.removeChild(n),Yi(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"removeTextTrack",this).call(this,e)}},{key:"getCuesForTrack",value:function(e){var n=this.getTrackById("telecine-track-"+e.id);return n?Vn(n.cues):Yi(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"getCuesForTrack",this).call(this,e)}},{key:"getActiveCuesForTrack",value:function(e){var n=this.getTrackById("telecine-track-"+e.id);return n?Vn(n.activeCues):Yi(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"getActiveCuesForTrack",this).call(this,e)}},{key:"setModeForTrack",value:function(e,n){var i=this.getTrackById("telecine-track-"+e.id);return i&&i.mode!==yr[n]&&(i.mode=yr[n],_r||"disabled"===n||e.dispatchEvent("cuechange")),Yi(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setModeForTrack",this).call(this,e,n)}},{key:"setSrcForTrack",value:function(e,n){var i=this._video.querySelector("#telecine-track-"+e.id);return i&&null===i.track.cues&&(i.src=n),Yi(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setSrcForTrack",this).call(this,e,n)}},{key:"oncanplay",value:function(){return!1}},{key:"oncanplaythrough",value:function(){return!1}},{key:"onerror",value:function(){if(!this._video.error)return!1;switch(this._video.error.code){case this._video.error.MEDIA_ERR_SRC_NOT_SUPPORTED:return this.fire("error",new TelecineError("HTMLSourceNotSupported",this._currentFile)),this._switchToNextFile(),!1;case this._video.error.MEDIA_ERR_DECODE:return this.fire("error",new TelecineError("HTMLDecode",this._currentFile)),this._switchToNextFile(),!1;case this._video.error.MEDIA_ERR_NETWORK:return this.fire("error",new TelecineError("HTMLNetwork",this._currentFile)),!1;case this._video.error.MEDIA_ERR_ABORTED:return this.fire("error",new TelecineError("HTMLAborted",this._currentFile)),!1;default:return this.fire("error",new TelecineError("HTMLUnknown",this._currentFile)),!1}}},{key:"onloadedmetadata",value:function(){this.readyState=wr}},{key:"onloadeddata",value:function(){this.readyState=kr}},{key:"onsuspend",value:function(){this.updateReadyState()}},{key:"onplay",value:function(){return this._ignorePlayEvent?(this._ignorePlayEvent=!1,!1):void("picture-in-picture"===this.presentationMode&&(this._paused=!1))}},{key:"onpause",value:function(){return window.clearTimeout(this._bufferTimer),this._ignorePauseEvent?(this._ignorePauseEvent=!1,!1):void("picture-in-picture"===this.presentationMode&&(this._paused=!0))}},{key:"onended",value:function(){if(this._paused=!0,this._video.paused||this._video.pause(),this.currentTime<this._video.duration)return!1}},{key:"onprogress",value:function(){this.updateReadyState()}},{key:"ontimeupdate",value:function(){var e=this,t=se(this.buffered,this.currentTime),n=er(t,2),i=n[1],r=1e3*(i-this.currentTime);if(!ar.firefox&&(r<.25&&this.currentTime+r<this.duration&&(this.readyState=kr),window.clearTimeout(this._bufferTimer),!this.paused)){for(var o=0,a=this.buffered,s=Array.isArray(a),c=0,a=s?a:a[Ui.iterator]();;){var u;if(s){if(c>=a.length)break;u=a[c++]}else{if(c=a.next(),c.done)break;u=c.value}var d=u,l=er(d,2),f=l[0],h=l[1];o+=h-f}o>=this.duration||(this._bufferTimer=window.setTimeout(function(){e._video.paused||e.readyState>kr&&(e.readyState=kr)},1500))}}},{key:"onwaiting",value:function(){return ar.firefox&&(this.readyState=kr),!1}},{key:"onemptied",value:function(){this._readyState=br}},{key:"onseeked",value:function(){this.readyState<kr&&(this.readyState=kr),this.updateReadyState()}},{key:"onwebkitendfullscreen",value:function(){this._video.paused&&(this._paused=!0)}},{key:"onwebkitpresentationmodechanged",value:function(){switch(this._video.webkitPresentationMode){case"picture-in-picture":this._video.controls=!0;break;case"inline":var e=this._options.htmlScanner&&this._options.htmlScanner.controls;e||(this._video.controls=!1)}this.fire("presentationmodechange",this._video.webkitPresentationMode)}},{key:"shouldHandleVideoEvent",value:function(e){return!0}},{key:"handleVideoEvent",value:function(e){e.target===this._video&&this.shouldHandleVideoEvent(e)!==!1&&("function"==typeof this["on"+e.type]&&this["on"+e.type](e)===!1||this.fire(e.type))}},{key:"swapVideo",value:function(e,t){var n=e.paused;this.removeVideoEventListeners(e),e.parentElement.replaceChild(t,e),e.pause(),t.currentTime=e.currentTime,n||t.play(),this.addVideoEventListeners(t),this._video=t}},{key:"onexternaldisplayactivated",value:function(e){this._externalDisplayActivated||(this._video!==e.element&&(this._originalVideo=this._video,this.swapVideo(this._video,e.element)),this._externalDisplayActivated=!0)}},{key:"onexternaldisplaydeactivated",value:function(e){this._externalDisplayActivated&&(this._originalVideo&&(this.swapVideo(e.element,this._originalVideo),this._originalVideo=null),this._externalDisplayActivated=!1)}},{key:"setVideoSrc",value:function(e){this._video.src=e}},{key:"canSeekTo",value:function(e){var t=this.duration;if(t&&e>t&&(e=t),this._video.seekable.length>0)for(var n=0,i=this._video.seekable.length;n<i;n++)if(this._video.seekable.start(n)<=e&&this._video.seekable.end(n)>=e)return!0;return!1}},{key:"seekToTime",value:function(e){var t=this;return this.canSeekTo(e)?(se(this.buffered,e).length||(this.readyState=wr),this._video.currentTime=e,He.resolve(this._video.currentTime)):new He(function(n,i){var r=function i(){t.canSeekTo(e)&&(dr.forEach(function(e){t._video.removeEventListener(e,i)}),se(t.buffered,e).length||(t.readyState=wr),t._video.currentTime=e,n(t._video.currentTime))};dr.forEach(function(e){t._video.addEventListener(e,r)})})}},{key:"takeSnapshot",value:function(){var e=this._element.querySelector("[telecine-snapshot]");e||(e=document.createElement("canvas"),e.setAttribute("telecine-snapshot",""),this._element.appendChild(e)),e.setAttribute("width",this._element.clientWidth+"px"),e.setAttribute("height",this._element.clientHeight+"px"),e.style.display="";var t=pe(this._video.clientWidth,this._video.clientHeight,this._video.videoWidth,this._video.videoHeight),n=t.width,i=t.height,r=t.left,o=t.top;e.style.cssText="position:absolute;width:"+n+"px;height:"+i+"px;left:"+r+"px;top:"+o+"px";var a=e.getContext("2d");a.drawImage(this._video,0,0,e.width,e.height)}},{key:"removeSnapshot",value:function(){var e=this._element.querySelector("[telecine-snapshot]");e&&(e.style.display="none")}},{key:"getTrackById",value:function(e){if("function"==typeof this._video.textTracks.getTrackById)return this._video.textTracks.getTrackById(e);var t=document.getElementById(e);return t?t.track:null}},{key:"updateReadyState",value:function(){if(this.buffered.length){var e=this.duration-this.buffered.end(this.buffered.length-1),t=e/this._downloadRate.averageDownloadRate,n=this.duration-this.currentTime;if(isFinite(t)){var i=se(this.buffered,this.currentTime),r=er(i,2),o=r[1],a=o-this.currentTime;t<n?this.readyState=xr:this.readyState===xr&&t>n?this.readyState=Sr:a>2&&(t<=n/2||a>10)&&(this.readyState=Sr)}}}},{key:"buffered",get:function(){return ve.from(this._video.buffered)}},{key:"currentFile",get:function(){return Yi(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"currentFile",this)},set:function(e){var n=this,i=!this._video.paused,r=this.currentTime,o=!this._currentFile||e.video.id!==this._currentFile.video.id;if(o||this.takeSnapshot(),this._ignorePlayEvent=!1,this._ignorePauseEvent=!1,this._currentFile=e,o&&(this._video.preload=this._preload),this.constructor===t&&this._video.readyState>br&&(this._video.currentTime=0),(ar.iOS||ar.android)&&this._currentFile.video.title){var a=this._currentFile.video.title;this._currentFile.video.subtitle&&(a=a+" "+this._currentFile.video.subtitle),this._video.setAttribute("title",a)}else this._video.removeAttribute("title");this._readyState=br,this.setVideoSrc(this._currentFile.src,o),this.fire("currentfilechange",e),this.constructor!==t||o?i&&(this._video.preload="",this._video.play()):(this._video.preload="",this.seekToTime(r).then(function(){i&&n._video.play()}),this.once("canplay",function(){return n.removeSnapshot()}),this.once("playing",function(){return n.removeSnapshot()}))}},{key:"currentTime",get:function(){return this._video.currentTime},set:function(e){this.seekToTime(e)}},{key:"duration",get:function(){return this._video.duration}},{key:"ended",get:function(){return this._video.ended}},{key:"loop",get:function(){return this._video.loop},set:function(e){this._video.loop=e}},{key:"muted",get:function(){return this._video.muted},set:function(e){this._video.muted=e}},{key:"paused",get:function(){return this._paused}},{key:"playbackRate",get:function(){return this.video.playbackRate},set:function(e){this.video.playbackRate=e}},{key:"preload",get:function(){return this._preload},set:function(e){this._video.preload=e,this._preload=e}},{key:"presentationMode",get:function(){return this._video.webkitPresentationMode?this._video.webkitPresentationMode:Yi(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"presentationMode",this)},set:function(e){Zi(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"presentationMode",e,this),"function"==typeof this._video.webkitSetPresentationMode&&this._video.webkitSetPresentationMode(e)}},{key:"supportedPresentationModes",get:function(){var e=Yi(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"supportedPresentationModes",this);if("function"==typeof this._video.webkitSupportsPresentationMode&&(this._video.webkitSupportsPresentationMode("picture-in-picture")&&e.push("picture-in-picture"),!this._video.webkitSupportsPresentationMode("inline"))){var n=e.indexOf("inline");n>=0&&e.splice(n,1)}return e}},{key:"video",get:function(){return this._telecineVideo},set:function(e){var n=this;Zi(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"video",e,this),ar.iOS&&this._externalDisplays.forEach(function(e){"AirPlay"===e.constructor.displayName&&(e.element=n._video)}),this._telecineVideo.drmHandler&&this._telecineVideo.drmHandler.init(this)}},{key:"videoWidth",get:function(){return this._video.videoWidth}},{key:"videoHeight",get:function(){return this._video.videoHeight}},{key:"volume",get:function(){return this._video.volume},set:function(e){this._video.volume=e}},{key:"readyState",get:function(){return this._readyState},set:function(e){if(this._readyState!==e&&!(this._video.readyState===wr&&e>wr)){var t=this._readyState;this._readyState=e,t>=Sr&&e<=kr&&(this.fire("waiting"),this._video.paused||(this._ignorePauseEvent=!0,this._video.pause())),t<=kr&&e===Sr&&(this.fire("canplay"),this._paused===!1&&this._video.play()),e===xr&&(t<=kr&&(this.fire("canplay"),this._paused===!1&&this._video.paused&&(this._ignorePlayEvent=!0,this._video.play())),this.fire("canplaythrough"))}}}]),t}(ur),Er="function"==typeof Ui&&"symbol"==typeof Ui.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Ui&&e.constructor===Ui&&e!==Ui.prototype?"symbol":typeof e},Pr=(function(){function e(e){this.value=e}function t(t){function n(e,t){return new He(function(n,r){var s={key:e,arg:t,resolve:n,reject:r,next:null};a?a=a.next=s:(o=a=s,i(e,t))})}function i(n,o){try{var a=t[n](o),s=a.value;s instanceof e?He.resolve(s.value).then(function(e){i("next",e)},function(e){i("throw",e)}):r(a.done?"return":"normal",a.value)}catch(e){r("throw",e)}}function r(e,t){switch(e){case"return":o.resolve({value:t,done:!0});break;case"throw":o.reject(t);break;default:o.resolve({value:t,done:!1})}o=o.next,o?i(o.key,o.arg):a=null}var o,a;this._invoke=n,"function"!=typeof t.return&&(this.return=void 0)}return"function"==typeof Ui&&Ui.asyncIterator&&(t.prototype[Ui.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype.throw=function(e){return this._invoke("throw",e)},t.prototype.return=function(e){return this._invoke("return",e)},{wrap:function(e){return function(){return new t(e.apply(this,arguments))}},await:function(t){return new e(t)}}}(),function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}),Ar=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),Mr=function(){function e(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Ui.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Ui.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),Lr=[],Or=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.retryCount,r=void 0===i?3:i,o=n.parallel,a=void 0===o?1:o,s=n.includeWithSpeeds,c=void 0===s||s;Pr(this,e),this._queue=[],this._activeXhrRequests=new Set,this._retries=new Wi,this._retryCount=r,this._running=!1,this._processingQueue=!1,this._parallel=a,this._includeWithSpeeds=c,this._pendingFetchMap=new Wi,_e(this),window.addEventListener("online",function(){t.start()}),window.addEventListener("offline",function(){t.stop()})}return Ar(e,null,[{key:"getPercentileSpeed",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.8,n=Lr.slice(-e);return me(n,t)}},{key:"getAverageSpeed",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=Lr.slice(-e);return ge(n,t)}},{key:"getMedianSpeed",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=Lr.slice(-e);return ye(t)}},{key:"getResponseSpeeds",value:function(){return Lr}},{key:"getTime",value:function(){return"undefined"!=typeof performance?performance.now():(new Date).getTime()}},{key:"calculateExponentialBackoff",value:function(e){return 500*Math.pow(2,e)+Math.round(1e3*Math.random())}}]),Ar(e,[{key:"add",value:function(e,t,n){return this._queue[n?"unshift":"push"]([e,t]),this._running&&!this._processingQueue&&this._processQueue(),this}},{key:"start",value:function(){return this._running=!0,this._processQueue(),this}},{key:"stop",value:function(){return this._running=!1,this}},{key:"abort",value:function(){var e=this;this._queue.forEach(function(t){var n=e._getIdentifierFromData(t),i=Mr(n,3),r=i[2];e.fire("downloadabort",r)}),this._queue=[],this._processingQueue=!1,this._activeXhrRequests.forEach(function(e){e.abort()})}},{key:"_processQueue",value:function(){if(this._running){this._processingQueue=!0;for(var e=this._parallel-this._activeXhrRequests.size,t=0;t<e;t++)this._fetchOne()}}},{key:"_retry",value:function(t,n,i){var r=this,o=n[0],a=n[1];if(this._retries.get(o)||this._retries.set(o,0),this._retries.set(o,this._retries.get(o)+1),this._retries.get(o)>this._retryCount)return void this.fire("downloaderror",i,t.status);var s=e.calculateExponentialBackoff(this._retries.get(o));setTimeout(function(){var e=!0;r.add(o,a,e)},s)}},{key:"_handleXHRResponse",value:function(e,t,n,i){return e.status>=500&&e.status<600?void this._retry(e,t,n):e.status>=400&&e.status<500?void this.fire("downloaderror",n,e.status):(this.fire("downloadend",n),void i.call(this,new Uint8Array(e.response)))}},{key:"_getIdentifierFromData",value:function(e){var t=e[1],n=e[0],i=n;return n.id&&(i=n.id),[n.url,n.byteRange,i,t]}},{key:"_continueProcessingQueue",value:function(){return 0===this._activeXhrRequests.size&&0===this._queue.length?void(this._processingQueue=!1):void(this._activeXhrRequests.size<this._parallel&&this._processQueue())}},{key:"_fetchOne",value:function(){var t=this;if(0===this._queue.length)return void(this._processingQueue=!1);var n=this._queue.shift(),i=this._getIdentifierFromData(n),r=Mr(i,4),o=r[0],a=r[1],s=r[2],c=r[3],u=e.getTime(),d=new XMLHttpRequest;d.addEventListener("progress",function(e){e.lengthComputable&&t._pendingFetchMap.set(d,{bytesTotal:e.total,bytesLoaded:e.loaded,percent:e.loaded/e.total,identifier:s})}),d.open("GET",o,!0),d.responseType="arraybuffer",a&&d.setRequestHeader("Range","bytes="+a),d.onload=function(i){t._activeXhrRequests.delete(d),t._pendingFetchMap.delete(d);var r=(e.getTime()-u)/1e3,o=i.target.response.byteLength;if(o>40960){var a=8*o,l=a/r;Lr.length>100&&Lr.shift(),t._includeWithSpeeds&&Lr.push(l)}t._handleXHRResponse(d,n,s,c),t._continueProcessingQueue()},d.onerror=function(){t._activeXhrRequests.delete(d),t._pendingFetchMap.delete(d),t._retry(d,n,s),t._continueProcessingQueue()},d.onabort=function(){t._pendingFetchMap.delete(d),
t._activeXhrRequests.delete(d),t.fire("downloadabort",s)},this.fire("downloadstart",s),this._activeXhrRequests.add(d),d.send()}},{key:"parallel",get:function(){return this._parallel},set:function(e){this._parallel=e}},{key:"pendingFetches",get:function(){var e=this,t=[];return this._activeXhrRequests.forEach(function(n){e._pendingFetchMap.get(n)&&t.push(e._pendingFetchMap.get(n))}),t}}]),e}(),Cr=function(){function e(t){Pr(this,e),_e(this),this._sorcerer=t,this._sourceBuffer=null,this._activeStreamIndex=null,this._needsStreamSwitch=!1,this._needInitSegment=!0,this._lastAppended=null,this._toRemove=[],this._streams=[],this._quotaExceeded=!1,this._quotaExceededTimer=null,this._finalSegmentStartTime=void 0,this._delayBufferEndUntilEndOfStream=!1}return Ar(e,[{key:"addStream",value:function(e){var t=this;e.on("segmentadd",function(){return t._process()});var n=this._streams.push(e)-1;e.index=n,null===this._activeStreamIndex&&(this._setActiveIndex(n),this._needsStreamSwitch=!0)}},{key:"switchTo",value:function(e){var t=this,n=e;"object"===("undefined"==typeof e?"undefined":Er(e))&&(n=e.index);var i=this._activeStreamIndex!==n,r=i;if(!i&&this._needsStreamSwitch&&(i=!0),i){this._needsStreamSwitch=!1;var o=this._activeStreamIndex,a=this._streams[o];a&&r&&a.abort(),this._switchToIndex=n,this._setActiveIndex(n)}return this._process(),new He(function(e){return i?void(t._resolveSwitchComplete=function(){t._switchToIndex===n&&(t._resolveSwitchComplete=null,e(),t.fire("streamchange",n))}):void e()})}},{key:"clear",value:function(){this._streams.forEach(function(e){e.clear()})}},{key:"remove",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._sorcerer._mediaSource.duration;return new He(function(i,r){t._toRemove.push([e,n,i]),t._process()})}},{key:"_attachEvents",value:function(){var e=this;this.bound={handleUpdateEnd:this._handleUpdateEnd.bind(this),handleEnded:function(){e._finalSegmentStartTime=void 0}},this._sourceBuffer.addEventListener("updateend",this.bound.handleUpdateEnd),this._sorcerer.on("endofstream",function(){e._delayBufferEndUntilEndOfStream=!1,e._finalSegmentStartTime=void 0,e._handleUpdateEnd()}),this._sorcerer.on("ended",this.bound.handleEnded)}},{key:"_handleUpdateEnd",value:function(){return this._delayBufferEndUntilEndOfStream?void this._sorcerer._fireStreamHasEnded():(this._lastAppended&&(this.fire("appendbufferend",this._lastAppended),this._lastAppended=null,this._resolveSwitchComplete&&this._resolveSwitchComplete()),void this._process())}},{key:"_removeEventListeners",value:function(){this.bound&&(this._sourceBuffer&&this._sourceBuffer.removeEventListener("updateend",this.bound.handleUpdateEnd),this._sorcerer.off("endofstream",this.bound.handleUpdateEnd),this._sorcerer.off("ended",this.bound.handleEnded))}},{key:"_setActiveIndex",value:function(e){this._needInitSegment=!0,this._activeStreamIndex=e,this._sorcerer._frameDropper.streamIndex=e}},{key:"_process",value:function(){var e=this,t=this._streams[this._activeStreamIndex];if(!this._sourceBuffer)return void this.on("sourcebufferattach",this._process);if(t&&"closed"!==this._sorcerer._mediaSource.readyState){var n=this._sourceBuffer;if(!n.updating){if(this._toRemove.length){var i=function(){var t=e._toRemove.shift(),i=Mr(t,3),r=i[0],o=i[1],a=i[2],s=e;n.addEventListener("updateend",function e(t){n.removeEventListener("updateend",e),a(),clearTimeout(s._quotaExceededTimer),s._quotaExceededTimer=setTimeout(function(){s._quotaExceeded=!1,s._process()},5e3)});var c=r;return n.remove(c,o),{v:void 0}}();if("object"===("undefined"==typeof i?"undefined":Er(i)))return i.v}if(!this._quotaExceeded){if(this._needInitSegment)return t.getInitSegment().then(function(t){return e._lastAppended=null,n.appendBuffer(t),t}).catch(function(e){}),void(this._needInitSegment=!1);var r=t.getNextSegment();if(null!==r){var o=t.getIdForSegment(r),a=t.isFinal(r);if(a){var s=0;this._sourceBuffer.buffered.length>0&&(s=this._sourceBuffer.buffered.end(this._sourceBuffer.buffered.length-1)),this._finalSegmentStartTime=s,this._delayBufferEndUntilEndOfStream=!0}this._lastAppended=o,this.fire("appendbufferstart",o);try{n.appendBuffer(r)}catch(e){"QuotaExceededError"===e.name&&(this._quotaExceeded=!0,this.removeBuffer(0,Math.max(.1,this._video.currentTime-6)),t._readyToAppend.unshift(r))}}}}}}},{key:"streams",get:function(){return this._streams}},{key:"activeStreamIndex",get:function(){return this._activeStreamIndex}},{key:"sourceBuffer",get:function(){return this._sourceBuffer},set:function(e){this._sourceBuffer=e,this._attachEvents(),this.fire("sourcebufferattach")}},{key:"finalSegmentStartTime",get:function(){return this._finalSegmentStartTime}},{key:"delayBufferEndUntilEndOfStream",get:function(){return this._delayBufferEndUntilEndOfStream}}]),e}(),Ir=function(){function e(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";Pr(this,e),_e(this),this._readyToAppend=[],this._initSegment=null,this._index=NaN,this._codec=i;var r=0===i.indexOf("audio"),o={includeWithSpeeds:!r};this._fetcher=new Or(o).start(),["downloadend","downloadabort"].forEach(function(e){n._fetcher.on(e,function(t){n.fire(e,t)})}),this._bufferData=new Wi,this._segmentToId={},this._getInitSegmentPromise=new He(function(i,r){return e.isValidSegmentUrl(t)?void n._fetcher.add({url:t.url||t,byteRange:t.byteRange,id:null},function(e){n._initSegment=e,i(e)}):(n._initSegment=t,void i(t))})}return Ar(e,null,[{key:"isValidSegmentUrl",value:function(e){return"string"==typeof e||"string"==typeof e.url&&"string"==typeof e.byteRange}}]),Ar(e,[{key:"getIdForSegment",value:function(t){return e.isValidSegmentUrl(t)?this._segmentToId[t]:this._bufferData.get(t).id}},{key:"isFinal",value:function(e){return this._bufferData.get(e).final}},{key:"addSegment",value:function(t,n,i){var r=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new He(function(a,s){return e.isValidSegmentUrl(t)?(r._segmentToId[t]=n||t,r.fire("queued",r.getIdForSegment(t)),void r._fetcher.add({url:t.url||t,byteRange:t.byteRange,id:r.getIdForSegment(t)},function(e){r._bufferData.set(e,{id:n||t,final:i}),r._readyToAppend.push(e),r.fire("bufferqueueadd",r.getIdForSegment(t)),o||r.fire("segmentadd"),a()})):(r._bufferData.set(t,{id:n,final:i}),r._readyToAppend.push(t),r.fire("bufferqueueadd",n),void a())})}},{key:"clear",value:function(){this._readyToAppend=[]}},{key:"abort",value:function(){var e=this;this._getInitSegmentPromise.then(function(){e._fetcher.abort()})}},{key:"getNextSegment",value:function(){return 0===this._readyToAppend.length?null:this._readyToAppend.shift()}},{key:"getInitSegment",value:function(){return this._getInitSegmentPromise}},{key:"codec",get:function(){return this._codec},set:function(e){this._codec=e}},{key:"index",get:function(){return this._index},set:function(e){this._index=e}},{key:"pendingFetches",get:function(){return this._fetcher.pendingFetches}}]),e}(),qr=function(){function e(t){Pr(this,e),this._video=t,this._running=!1,this._droppedFramesTimeout=null,this._droppedFrameData={},this._decodedFrameData={},this._droppedFrames=0,this._decodedFrames=0,this._streamIndex="default",this.bound={startCheckingDroppedFrames:this._startCheckingDroppedFrames.bind(this),stopCheckingDroppedFrames:this._stopCheckingDroppedFrames.bind(this)}}return Ar(e,[{key:"start",value:function(){return this._startCheckingDroppedFrames(),this}},{key:"stop",value:function(){return this._stopCheckingDroppedFrames(),this}},{key:"destroy",value:function(){this._stopCheckingDroppedFrames(),this._removeEvents()}},{key:"getDroppedFrameRate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"average",i=this._droppedFrameData[t];if(!i)return 0;if(i.length<e)return 0;var r=i.slice(-e);return"median"===n?ye(r):ge(r)}},{key:"getDroppedFrameTotal",value:function(){return{dropped:this._getTotalDroppedFrames(),total:this._getTotalFrames()}}},{key:"_attachEvents",value:function(){this._video.addEventListener("playing",this.bound.startCheckingDroppedFrames),this._video.addEventListener("pause",this.bound.stopCheckingDroppedFrames),this._video.addEventListener("ended",this.bound.stopCheckingDroppedFrames)}},{key:"_removeEvents",value:function(){this._video.removeEventListener("playing",this.bound.startCheckingDroppedFrames),this._video.removeEventListener("pause",this.bound.stopCheckingDroppedFrames),this._video.removeEventListener("ended",this.bound.stopCheckingDroppedFrames)}},{key:"_startCheckingDroppedFrames",value:function(){this._running=!0,this._checkDroppedFrames()}},{key:"_stopCheckingDroppedFrames",value:function(){this._running=!1}},{key:"_checkDroppedFrames",value:function(){var e=this;if(this._running&&null!==this._streamIndex){clearTimeout(this._droppedFramesTimeout);var t=this._getTotalDroppedFrames(),n=t-this._droppedFrames;this._droppedFrames=t;var i=this._getTotalFrames(),r=i-this._decodedFrames;this._decodedFrames=i,this._droppedFrameData[this._streamIndex]||(this._droppedFrameData[this._streamIndex]=[]),this._decodedFrameData[this._streamIndex]||(this._decodedFrameData[this._streamIndex]=[]),this._droppedFrameData[this._streamIndex].length>100&&this._droppedFrameData[this._streamIndex].shift(),this._decodedFrameData[this._streamIndex].length>100&&this._decodedFrameData[this._streamIndex].shift(),this._droppedFrameData[this._streamIndex].push(n),this._decodedFrameData[this._streamIndex].push(r),this._droppedFramesTimeout=setTimeout(function(){e._checkDroppedFrames()},1e3)}}},{key:"_getTotalDroppedFrames",value:function(){return"function"==typeof this._video.getVideoPlaybackQuality?this._video.getVideoPlaybackQuality().droppedVideoFrames:this._video.webkitDroppedFrameCount||0}},{key:"_getTotalFrames",value:function(){if("function"==typeof this._video.getVideoPlaybackQuality){var e=this._video.getVideoPlaybackQuality();return e.totalVideoFrames-e.droppedVideoFrames-e.corruptedVideoFrames}return this._video.webkitDecodedFrameCount||0}},{key:"streamIndex",get:function(){return this._streamIndex},set:function(e){this._streamIndex=e}}]),e}(),Rr=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Pr(this,e),this._video=t,this._options=n,_e(this),this._options.duration&&(this._options.duration=Math.ceil(100*this._options.duration)/100),this._bufferCount=0,this._frameDropper=new qr(t),this._mediaSource=new MediaSource,this._video.src=URL.createObjectURL(this._mediaSource),this._buffersForCodec={},this._readyPromiseResolve=null,this._attachEvents()}return Ar(e,[{key:"switchTo",value:function(e){return 1===this._bufferCount&&this.video.switchTo(e)}},{key:"getCurrentSpeed",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,n=void 0===t?"average":t,i=e.howMany,r=void 0===i?10:i,o=e.weights,a=void 0===o?[]:o,s=e.percentile,c=void 0===s?null:s;return"average"===n?Or.getAverageSpeed(r,a):"median"===n?Or.getMedianSpeed(r):Or.getPercentileSpeed(r,c)}},{key:"getResponseSpeeds",value:function(){return Or.getResponseSpeeds()}},{key:"getDroppedFrameRate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.activeStreamIndex,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"average";return this._frameDropper.getDroppedFrameRate(e,t,n)}},{key:"getDroppedFrameTotal",value:function(){return this._frameDropper.getDroppedFrameTotal()}},{key:"clear",value:function(){for(var e in this._buffersForCodec)this._buffersForCodec[e].clear()}},{key:"removeBuffer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._video.duration;if(e>t)return He.resolve();var n=[];for(var i in this._buffersForCodec)n.push(this._buffersForCodec[i].remove(e,t));return He.all(n)}},{key:"addStream",value:function(e,t){var n=this,i=this._getCodecType(e);this._buffersForCodec[i]||!function(){n._bufferCount+=1;var t=new Cr(n,i);n._buffersForCodec[i]=t,n.readyPromise.then(function(){var r=void 0;try{r=n._mediaSource.addSourceBuffer(e)}catch(e){if(22!==e.code)return void n.fire("srcnotsupported",e);r=n._buffersForCodec[i]}n._options.duration&&(r.appendWindowEnd=n._options.duration),t.sourceBuffer=r}),["appendbufferstart","appendbufferend","streamchange"].forEach(function(e){t.on(e,function(t){n.fire(e,t)})})}();var r=new Ir(t,e);return["downloadend","downloadabort","queued","bufferqueueadd"].forEach(function(e){r.on(e,function(t){n.fire(e,t)})}),this._buffersForCodec[i].addStream(r),r}},{key:"destroy",value:function(){this.clear(),this._removeEventListeners(),this._frameDropper.destroy(),this._video.src&&URL.revokeObjectURL(this._video.src)}},{key:"_attachEvents",value:function(){var e=this;this.bound={handleSourceOpen:this._handleSourceOpen.bind(this),handleTimeUpdate:this._handleTimeUpdate.bind(this),handleEnded:this._handleEnded.bind(this)},this.readyPromise=new He(function(t,n){e._readyPromiseResolve=t,e._mediaSource.addEventListener("sourceopen",e.bound.handleSourceOpen)})}},{key:"_sourceBuffersAreUpdating",value:function(){for(var e=0;e<this._mediaSource.sourceBuffers.length;e++)if(this._mediaSource.sourceBuffers[e].updating)return!0;return!1}},{key:"_fireStreamHasEnded",value:function(){var e=!0,t=!1;for(var n in this._buffersForCodec){var i=this._buffersForCodec[n];i.delayBufferEndUntilEndOfStream&&(t=!0),void 0===i.finalSegmentStartTime&&(e=!1)}e&&"open"===this._mediaSource.readyState&&(this._sourceBuffersAreUpdating()||(this._mediaSource.endOfStream(),t&&this.fire("endofstream")))}},{key:"_handleTimeUpdate",value:function(){this._fireStreamHasEnded()}},{key:"_handleEnded",value:function(){this.fire("ended")}},{key:"_handleSourceOpen",value:function(){this._options.duration&&(this._mediaSource.duration=this._options.duration),this._addEventListeners(),this._readyPromiseResolve(),this._mediaSource.removeEventListener("sourceopen",this.bound.handleSourceOpen)}},{key:"_addEventListeners",value:function(){this._video.addEventListener("timeupdate",this.bound.handleTimeUpdate),this._video.addEventListener("ended",this.bound.handleEnded)}},{key:"_removeEventListeners",value:function(){for(var e in this._buffersForCodec)this._buffersForCodec[e]._removeEventListeners();this._video.removeEventListener("timeupdate",this.bound.handleTimeUpdate),this._video.removeEventListener("ended",this.bound.handleEnded)}},{key:"_getCodecType",value:function(e){return 0===e.indexOf("audio")?"audio":"video"}},{key:"mediaSource",get:function(){return this._mediaSource}},{key:"streams",get:function(){return 1===this._bufferCount&&this.video.streams}},{key:"activeStreamIndex",get:function(){return 1===this._bufferCount&&this.video.activeStreamIndex}},{key:"video",get:function(){return!!this._buffersForCodec.video&&this._buffersForCodec.video}},{key:"audio",get:function(){return!!this._buffersForCodec.audio&&this._buffersForCodec.audio}}]),e}(),Fr=function(){function e(t){$i(this,e),this.scanner=t}return Xi(e,null,[{key:"displayName",get:function(){return"Brain"}}]),Xi(e,[{key:"shouldPowerUp",value:function(e,t){return!1}},{key:"shouldPowerDown",value:function(e,t){return!1}},{key:"canPowerUp",value:function(e,t){return 1!==e.length&&t<e.length-1}},{key:"canPowerDown",value:function(e,t){return 1!==e.length&&t>0}},{key:"filterStreams",value:function(e){return e}}]),e}(),Br=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};$i(this,t);var i=Qi(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i._options=n,i.finalSegmentLoaded=!1,i.blacklisted=[],i.whitelisted=[],i}return Ki(t,e),Xi(t,null,[{key:"displayName",get:function(){return"Skyfire"}}]),Xi(t,[{key:"shouldPowerUp",value:function(e,t,n){var i=.85;n&&this._options.startingBandwidthThreshold&&(i=this._options.startingBandwidthThreshold);var r=e.indexOf(t);if(r===-1&&(r=0),!this.canPowerUp(e,r))return!1;var o=this.getCurrentSpeed();if(!o)return!1;for(var a=r+1,s=r;a<e.length;)o*i>e[a].bitrate+e[a].audioBitrate&&(s=a),a+=1;return s!==r&&s}},{key:"shouldPowerDown",value:function(e,t){var n=e.indexOf(t),i=n===-1;if(i)return e.length-1;if(!this.canPowerDown(e,n))return!1;var r=10,o=this.scanner.sorcerer.getDroppedFrameRate(r,n,"median"),a=t.framerate,s=this.getCurrentSpeed();if(!s)return!1;var c=o/a*100;if(c>=75)return this.blacklist(n),n-1;for(var u=n,d=n;d>0;).9*s<e[d].bitrate+e[d].audioBitrate&&(u=d-1),d-=1;return u!==n&&u}},{key:"isTimeInBuffer",value:function(e){var t=this.scanner._video;return this._timesAreInRange(e,e,t.buffered)}},{key:"getCurrentSpeed",value:function(){var e=3,t=[1,2,5];return this.scanner.sorcerer.getCurrentSpeed({type:"average",howMany:e,weights:t})}},{key:"getDistanceFromBuffer",value:function(e){for(var t=e,n=this.scanner._video,i=0;i<n.buffered.length;i++)if(n.buffered.start(i)<=e&&n.buffered.end(i)>=e){t=n.buffered.end(i);break}return t-e}},{key:"getTimeEstimateToLoad",value:function(e,t){if(null===t)return 3;var n=t.segments[e],i=n.end-n.start,r=this.getCurrentSpeed(),o=i*(t.bitrate+t.audioBitrate)/r;return 1.3*o}},{key:"canPlayFromTimeInStream",value:function(e,t){if(!this.isTimeInBuffer(e))return!1;if(!t)return!1;var n=this.getSegmentsToLoad();if(0===n.length)return!0;var i=this.getDistanceFromBuffer(e);return this.getTimeEstimateToLoad(n[0],t)<i}},{key:"getSegmentsToLoad",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"video",n=arguments[2],i=this.scanner._video,r=this.scanner.currentTime,o=[],a=this._getSecondsToLoadAhead(r,i.duration,n),s=r+a,c=this.scanner.sorcerer[t].activeStreamIndex,u=this.scanner._streams[t][c],d=this.scanner.sorcerer[t].sourceBuffer.buffered,l=0;l<u.segments.length;l++){var f=u.segments[l],h=l===u.segments.length-1;if(!(f.end<r||f.start>s)){var p=r>=f.start&&r<f.end,v=this._isSegmentInBuffer(f,d,h);!e&&v||e&&v&&p||(p?o.push(l):s>=f.start&&o.push(l))}}return o}},{key:"blacklist",value:function(e){this.blacklisted[e]=1}},{key:"lock",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.whitelisted=e}},{key:"filterStreams",value:function(e){for(var t=this.scanner._video.clientWidth,n=this.scanner._video.clientHeight,i=[],r=void 0,o=!1,a=0;a<e.length;a++)if(r&&r[0]===e[a].width&&r[1]===e[a].height)i.push(e[a]);else{if(o)break;if(!(this.blacklisted[a]&&this.whitelisted.indexOf(a)===-1||this.whitelisted.length&&this.whitelisted.indexOf(a)===-1))if(this.whitelisted.length)i.push(e[a]);else{var s=this._getScaleFromDimensions(t,n,e[a].width,e[a].height),c=1e3/(window.devicePixelRatio||1),u=n<c?1.75:1;s>=u&&(o=!0),i.push(e[a]),r=[e[a].width,e[a].height]}}return i}},{key:"_getVisibleDimensions",value:function(e,t,n,i){var r=n/i,o=e-t*r,a=t-e/r,s=e-o,c=t-a;return o>0&&(c=t),a>0&&(s=e),[s,c]}},{key:"_getScaleFromDimensions",value:function(e,t,n,i){var r=this._getVisibleDimensions(e,t,n,i),o=n*i,a=window.devicePixelRatio||1,s=r[0]*r[1]*a*a;return o/s}},{key:"_getSecondsToLoadAhead",value:function(e,t,n){var i=12e3,r=n&&n.bitrate>i;return 1===this.whitelisted.length?r?30:90:18}},{key:"_round",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(e=parseFloat(e),isNaN(e))return 0;var n=Math.pow(10,t);return Math.round(e*n)/n}},{key:"_timesAreInRange",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;t=Math.min(t,this.scanner._video.duration);for(var r=0;r<n.length;r++){var o=this._round(n.start(r))-i,a=this._round(n.end(r))+i;if(o<=e&&a>=t)return!0}return!1}},{key:"_hasSeparateStreams",value:function(){return this.scanner._streams.video.length>0&&this.scanner._streams.audio.length>0}},{key:"_isSegmentInBuffer",value:function(e,t,n){var i=1;return this._hasSeparateStreams()&&(i=.05),n&&!this.finalSegmentLoaded?(this.finalSegmentLoaded=!0,!1):this._timesAreInRange(e.start,e.end,t,i)}}]),t}(Fr),Dr=1,Nr=2,Hr=3,Vr=4,jr=1e4,zr=5,Ur="video",Wr="audio",Gr=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};$i(this,t);var i=Qi(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.reset(),n.mediaSourceScanner&&(i._maxPreloadStreamIndex=n.mediaSourceScanner.maxPreloadStreamIndex),i}return Ki(t,e),Xi(t,null,[{key:"displayName",get:function(){return"MediaSourceScanner"}},{key:"supported",get:function(){return"undefined"!=typeof MediaSource&&"undefined"!=typeof Set}},{key:"supportedVideoTypes",get:function(){return["application/vnd.vimeo.dash+json"]}}]),Xi(t,[{key:"deactivate",value:function(){Yi(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"deactivate",this).call(this),this.reset(),this.sorcerer&&this.sorcerer.destroy()}},{key:"reset",value:function(){this._waitingOnSet=new Set,this._streamsForSegment={},this._brain=new Br(this,this._options.mediaSourceScanner||{}),this._ready=!1,this._startedPlaying=!1,this._manifest=null,this._streams={},this._streams[Wr]=[],this._streams[Ur]=[],this._audioStreams=[],this._onReady=null,this._baseUrl=null,this._lastTargetStreamId=null,this._timeToSeekTo=null,this._resolveSeek=null,this._resolveStartPreload=null,this._reloadingExistingVideo=!1,this._lastStreamIndex=null,this._checkSwitchUp=!1,this._clearBufferAtTime=!1,this._preloadStream=null,this._badPlaybackTimer=null,this._isBufferingTooLong=!1,this._ranIntoBuffer=!1,this._bufferCount=0,this._restrictedStreamIndexes=[],this._switching={}}},{key:"preloadStream",value:function(){var e=this;return this._preloadStream?this._preloadStream:(this._preloadStream=new He(function(t,n){var i=1;e._streams.audio.length&&(i=2);var r=0,o=!1,a=e.sorcerer.video.activeStreamIndex;e._restrictedStreamIndexes.length&&(a=e._streams[Ur].indexOf(e._manifest.video[e._restrictedStreamIndexes[0]]));var s=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t&&(a=e.sorcerer.video.activeStreamIndex);for(var n in e._streams)if(0!==e._streams[n].length){var i=a;n===Wr&&(i=e._getAudioIndexFromVideo(a));var s=e._getSegmentUrl(i,0,n),c=e._isFinalSegment(i,0),u=e.sorcerer[n].streams[i],d={stream:i,segment:0,type:n},l=!0,f=s;if(e._useRangeRequests()){var h=e._getRangeForSegment(i,0,n);f={url:f,byteRange:h}}"audio"!==n||i!==o?("audio"===n&&o===!1&&(o=i),u.addSegment(f,d,c,l)):(r+=1,e._handleAppendBufferEnd(d))}},c=function n(o){if(r+=1,!(r<i)&&0===o.segment){if(0===e._restrictedStreamIndexes.length){var c=!0,u=e._getStreamIndexToLoad(c);if(u!==!1&&u>o.stream)return e.sorcerer.video.switchTo(u),e._streams.audio.length&&e.sorcerer.audio.switchTo(e._getAudioIndexFromVideo(u)),r=0,void s(!0)}var d=e._getCurrentStream(a),l=d.segments[0].end;e.currentTime>l&&(e.sorcerer.clear(),e._waitingOnSet=new Set),e.sorcerer.video.switchTo(a),e._streams.audio.length&&e.sorcerer.audio.switchTo(e._getAudioIndexFromVideo(a)),e.sorcerer.off("bufferqueueadd",n),e._ready=!0,t()}};e.sorcerer.on("bufferqueueadd",c),s()}),this._preloadStream)}},{key:"loadManifest",value:function(e){return new He(function(t,n){var i=new XMLHttpRequest;i.open("GET",e,!0),i.onload=function(){if(i.status>=400)return void n(i.status);try{t(JSON.parse(i.response))}catch(e){n()}},i.onerror=n,i.send()})}},{key:"setVideoSrc",value:function(e,t){var n=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(i&&!t&&this._onReady){if(("metadata"===this._preload||"none"===this._preload&&!this._paused)&&!this._ready)return void this._onReady.then(function(){var t=n._paused;n.setVideoSrc(e,t,!1)});if("auto"===this._preload)return void this._onReady.then(function(){n.setVideoSrc(e,!1,!1)})}if(t){this.reset();try{this._video.currentTime=0}catch(e){}}t||"none"!==this._preload||!this._paused||this.sorcerer||(t=!0);var r="_initializeManifest";t&&(this._video.preload="",r="_initialize");var o=e.split("/");o.pop(),this._baseUrl=o.join("/")+"/",this._reloadingExistingVideo=!t,this._onReady=this._startPreload(e,this._preload).then(this.loadManifest.bind(this)).then(this[r].bind(this)),t&&"auto"===this._preload&&(this._onReady=this._addCallbackToPromise(this._onReady,this.preloadStream.bind(this),!1)),this._onReady=this._addCatchToPromise(this._onReady)}},{key:"updateReadyState",value:function(){}},{key:"lockStreamIndexes",value:function(){var e=this,t=this._restrictedStreamIndexes.map(function(t){return e._streams[Ur].indexOf(e._manifest.video[t])});if(this._video.paused||(this._ignorePauseEvent=!0,this._video.pause()),this._switching[Ur]=!1,this._brain.lock(t),this._startedPlaying||"auto"===this._preload){var n=7,i=Math.max(this.currentTime-n,0),r=Math.min(this.currentTime+n,this._video.duration);this.sorcerer.removeBuffer(i,r).then(function(){return e._startedPlaying||"auto"!==e._preload?(e.seekToTime(e.currentTime),void(!e._paused&&e._video.paused&&(e._ignorePlayEvent=!0,e.play()))):void e._loadSegments()})}}},{key:"seekToTime",value:function(e){var t=this,n=null===this._timeToSeekTo;if(n||(this._lastSeekReject&&(this._lastSeekReject(),this._lastSeekReject=null),this._seekInProgressPromise=null,this._timeToSeekTo=null,this._resolveSeek=null),this._timeToSeekTo=e,this._ready)for(var i in this._streams)if(this._streams[i].length>0){var r=this.sorcerer[i].activeStreamIndex,o=this.sorcerer[i].streams[r];o.abort()}return this._loadSegments(),this._paused&&0===e&&this.fire("seeking"),this.readyState=Dr,this._seekInProgressPromise=this._getSeekReadyPromiseForTime(e),!n&&this._waitingOnPlay&&this.play(),this._onReady.then(function(){return t._seekInProgressPromise}).catch(function(e){})}},{key:"takeSnapshot",value:function(){}},{key:"onstalled",value:function(){return!1}},{key:"onseeked",value:function(e){this._loadSegments(),Yi(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onseeked",this).call(this,e)}},{key:"onended",value:function(e){Yi(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onended",this).call(this,e);var n=6;this.sorcerer.removeBuffer(n)}},{key:"onseeking",value:function(e){var t=this;clearTimeout(this._seekTimeout),this._seekTimeout=setTimeout(function(){t._loadSegments()},100)}},{key:"onloadeddata",value:function(){var e=this;he(function(){e.readyState=Vr})}},{key:"ontimeupdate",value:function(e){if(0===this.currentTime)return!1;if(this._timeToSeekTo)return!1;if(this._startedPlaying||(this._startedPlaying=!0),this._clearBufferAtTime&&this.currentTime>=this._clearBufferAtTime){var t=2;this.sorcerer.removeBuffer(0,this._clearBufferAtTime-t),this._clearBufferAtTime=!1}this._loadSegments();var n=this.sorcerer.getDroppedFrameTotal();this.fire("droppedframes",n);var i=this.sorcerer.getResponseSpeeds(),r=this._streams[Ur][this.sorcerer.video.activeStreamIndex],o={speed:this._brain.getCurrentSpeed(),bitrate:r.bitrate,speeds:i};this.fire("bandwidth",o);var a=this._video.buffered.length;if(!a)return!0;var s=this._video.buffered.end(a-1);if(Math.ceil(s)===Math.ceil(this._video.duration))return!0;var c=.2;return Math.abs(this.currentTime-s)<c?!this._ranIntoBuffer&&(this._bufferCount+=1,this.fire("streambufferstart",{hasLowerStreamIndex:this.sorcerer[Ur].activeStreamIndex>0}),this._ranIntoBuffer=!0,this._startBadPlaybackTimer(),this.readyState=Nr,!1):void 0}},{key:"onprogress",value:function(){this._brain.canPlayFromTimeInStream(this.currentTime,this._getCurrentStream())&&(clearTimeout(this._badPlaybackTimer),this.readyState<Hr&&(this.readyState=Vr),this._ranIntoBuffer&&(this.fire("streambufferend"),this._ranIntoBuffer=!1))}},{key:"onplay",value:function(){return"picture-in-picture"===this.presentationMode&&(this._paused=!1,!0)}},{key:"onpause",value:function(){return"picture-in-picture"===this.presentationMode&&(this._paused=!0,!0)}},{key:"onwaiting",value:function(e){return!1}},{key:"pause",value:function(){var e=this;he(function(){e.fire("pause")}),Yi(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"pause",this).call(this)}},{key:"play",value:function(){var e=this;he(function(){e.fire("play")}),this._waitingOnPlay=!0,this._paused=!1,ar.android&&!this._ready&&(this._waitingOnPlay=!1,this._video.play()),this._resolveStartPreload&&this._resolveStartPreload(),this._reloadingExistingVideo||this._ready||"auto"===this._preload||(this._onReady=this._addCallbackToPromise(this._onReady,this.preloadStream.bind(this))),this._ready||this._startBadPlaybackTimer();var t=this._seekInProgressPromise||He.resolve();return this._onReady.then(function(){return t}).then(function(){e._waitingOnPlay=!1,e._paused||e._video.play()})}},{key:"_getAudioIndexFromVideo",value:function(e){return 0!==this._streams.audio.length&&(this._streams.audio.length>1&&this._streams.video[e].bitrate>1e6?1:0)}},{key:"_addCallbackToPromise",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=e.then(t);return n&&(i=this._addCatchToPromise(i)),i}},{key:"_addCatchToPromise",value:function(e){var t=this;return e.catch(function(e){return t.fire("scannererror",{reason:"json manifest failed to load"}),new He(function(e,t){})})}},{key:"_handleBufferForSeek",value:function(){if(this._ready){var e=this._streams[Ur][this.sorcerer.video.activeStreamIndex],t=e.bitrate/1e3,n=12e3;t>n&&this.sorcerer.removeBuffer()}}},{key:"_startPreload",value:function(e,t){var n=this;return new He(function(i,r){return"none"!==t||n._reloadingExistingVideo&&!n._paused?void i(e):void(n._resolveStartPreload=function(){i(e),n._resolveStartPreload=null})})}},{key:"_getSeekReadyPromiseForTime",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._timeToSeekTo;return new He(function(n,i){var r=!e._startedPlaying&&0===t;return r||e._brain.canPlayFromTimeInStream(t,e._getCurrentStream())?void n(t):(e._handleBufferForSeek(),void(e._resolveSeek=n))}).then(function(t){e._timeToSeekTo=null,e._seekInProgressPromise=null,e.readyState=Vr;var n=new He(function(t,n){e._lastSeekReject=n;var i=function n(){t(e._video.currentTime),e._video.removeEventListener("seeked",n)};e._video.addEventListener("seeked",i)});return e._video.currentTime=t,n})}},{key:"_handlePreloadChanged",value:function(e,t){"auto"!==e&&"auto"===t&&(this._onReady=this._addCallbackToPromise(this._onReady,this.preloadStream.bind(this))),e!==t&&"none"!==t&&this._resolveStartPreload&&this._resolveStartPreload()}},{key:"_initializeManifest",value:function(e){var t=this;return new He(function(n,i){t._manifest=e,t._streams[Ur]=t._sortStreams(e.video),e.audio&&(t._streams[Wr]=t._sortStreams(e.audio));for(var r=0;r<t._streams[Ur].length;r++){var o=0;if(e.audio){var a=t._streams[Wr][t._getAudioIndexFromVideo(r)];a&&(o=a.bitrate)}t._streams[Ur][r].audioBitrate=o}n()})}},{key:"_setUpSorcerer",value:function(e,t){this.sorcerer&&this.sorcerer.destroy(),this.sorcerer=new Rr(e,t)}},{key:"_getDuration",value:function(){var e=0;for(var t in this._streams)this._streams[t].length&&(e=Math.max(e,this._streams[t][0].duration));return e}},{key:"_initialize",value:function(e){var t=this;return new He(function(n,i){t._initializeManifest(e).then(function(){var i=t._brain.filterStreams(t._streams[Ur]),r=i.length-1,o=e.video[0];if(t._restrictedStreamIndexes.length&&(o=e.video[t._restrictedStreamIndexes[0]]),void 0!==t._maxPreloadStreamIndex){var a=t._streams[Ur].indexOf(e.video[t._maxPreloadStreamIndex]);r<=a&&(o=t._streams[Ur][r])}t._setUpSorcerer(t._video,{duration:t._getDuration()}),t.sorcerer.on("srcnotsupported",function(){t.fire("scannererror",{reason:"this codec is not supported for mediasource playback"})}),t.sorcerer.readyPromise.then(function(){var e=t._streams[Ur].indexOf(o),i=function(e){t._streams[e].forEach(function(n,i){var r=t._getSegmentUrl(i,"init",e);if(t._useRangeRequests()&&t._streams[e][i].init_segment_range){var o=t._getRangeForSegment(i,"init",e);r={url:r,byteRange:o}}t.sorcerer.addStream(n.mime_type+'; codecs="'+t._streams[e][i].codecs+'"',r)})};for(var r in t._streams)i(r);t.sorcerer.video.switchTo(e),t.sorcerer.on("queued",t._handleQueued.bind(t)),t.sorcerer.on("downloadabort",t._handleAborted.bind(t)),t.sorcerer.on("appendbufferend",t._handleAppendBufferEnd.bind(t)),t.sorcerer.on("downloadend",t._handleDownloadEnd.bind(t)),t.sorcerer.video.on("streamchange",function(e){e>t._lastStreamIndex&&t.currentTime>0&&(t._checkSwitchUp=!0),
t._lastStreamIndex=e;var n=t._manifest.video.indexOf(t._streams[Ur][e]),i={index:n,streams:t._manifest.video};t.fire("streamchange",i),t._startBadPlaybackTimer()}),t.sorcerer.on("droppedframes",function(){return t.fire("alert","droppedframes")}),t.sorcerer.mediaSource.addEventListener("sourceended",function(){t.fire("progress")}),n()})})})}},{key:"_sortStreams",value:function(e){function t(e,t){var n=e.width*e.height*e.bitrate,i=t.width*t.height*t.bitrate;return e.width===t.width&&e.height===t.height?e.framerate-t.framerate:n-i}var n=e.slice(0);return n.sort(t),n}},{key:"_useRangeRequests",value:function(){return!!this._manifest.video[0].segments[0].range}},{key:"_getRangeForSegment",value:function(e,t,n){return"init"===t?this._streams[n][e].init_segment_range:this._streams[n][e].segments[t].range}},{key:"_getSegmentUrl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ur,i="init"===t;if(i&&!this._streams[n][e].init_segment_range&&this._streams[n][e].init_segment.indexOf(".")===-1){var r=this._streams[n][e].init_segment;return le(r)}var o=this._baseUrl,a=this._manifest.base_url&&this._manifest.base_url.indexOf("//")!==-1;return a&&(o=this._manifest.base_url),this._manifest.base_url&&!a&&(o+=this._manifest.base_url),this._streams[n][e].base_url&&(o+=this._streams[n][e].base_url),this._useRangeRequests()?o:"init"===t?o+=this._streams[n][e].init_segment:(this._streams[n][e].segments[t].url&&(o+=this._streams[n][e].segments[t].url),o)}},{key:"_key",value:function(e,t,n){return e+":"+t+":"+n}},{key:"_isFinalSegment",value:function(e,t){return t===this._streams[Ur][e].segments.length-1}},{key:"_getCurrentlyLoadingStreamsForSegment",value:function(e,t){var n=[],i=this._streamsForSegment[e];if(!i)return n;for(var r=0;r<i.length;r++)this._waitingOnSet.has(this._key(i[r],e,t))&&n.push(i[r]);return n}},{key:"_getCurrentStream",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ur;return"undefined"!=typeof this.sorcerer&&(e=this.sorcerer[t].activeStreamIndex),this._streams[t][e]}},{key:"_getStreamIndexToLoad",value:function(e){var t=this._streams[Ur];if(t=this._brain.filterStreams(t),0===t.length)return!1;if(this._switching[Ur])return!1;var n=t[t.length-1];if(n.id!==this._lastTargetStreamId){this._lastTargetStreamId=n.id;var i=this._streams[Ur].indexOf(n),r={index:i,streams:this._streams[Ur]};this.fire("streamtargetchange",r)}var o=this._getCurrentStream(),a=this._brain.shouldPowerUp(t,o,e);return this._checkForBadPlayback(),a===!1&&(a=this._brain.shouldPowerDown(t,o)),a===!1?a:this._streams[Ur].indexOf(t[a])}},{key:"_startBadPlaybackTimer",value:function(){var e=this;clearTimeout(this._badPlaybackTimer),this._badPlaybackTimer=setTimeout(function(){e._isBufferingTooLong=!0,e._checkForBadPlayback()},jr)}},{key:"_checkForBadPlayback",value:function(){this._isHavingBadPlaybackInCurrentQuality()&&this.fire("alert","streamstudder")}},{key:"_isHavingBadPlaybackInCurrentQuality",value:function(){return!!this._restrictedStreamIndexes.length&&(!(!this._isBufferingTooLong&&this._bufferCount<zr)&&(this._isBufferingTooLong,this._bufferCount>=zr,this._isBufferingTooLong=!1,this._bufferCount=0,!0))}},{key:"_loadSegmentsForType",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ur,n=this._getStreamIndexToLoad();t===Wr&&(n===!1&&(n=this.sorcerer[Ur].activeStreamIndex),n=this._getAudioIndexFromVideo(n),this.sorcerer[Wr].activeStreamIndex===n&&(n=!1));var i=!1;n!==!1&&(i=n>this.sorcerer[t].activeStreamIndex,this._switching[t]=!0,this.sorcerer[t].switchTo(n).then(function(){e._switching[t]=!1}));for(var r=this._brain.getSegmentsToLoad(i,t,this._getCurrentStream()),o=this.sorcerer[t].activeStreamIndex,a=0;a<r.length;a++){var s=this._getSegmentUrl(o,r[a],t),c=this._getCurrentlyLoadingStreamsForSegment(r[a],t);if(!(c.length>1||1===c.length&&o<=c[0])){var u=this._isFinalSegment(o,r[a],t),d={stream:o,segment:r[a],type:t},l=this.sorcerer[t].streams[o],f=s;if(this._useRangeRequests()){var h=this._getRangeForSegment(o,r[a],t);f={url:f,byteRange:h}}l.addSegment(f,d,u)}}}},{key:"_loadSegments",value:function(){var e=this;return this._onReady.then(function(){for(var t in e._streams)e._streams[t].length>0&&e._loadSegmentsForType(t)})}},{key:"_handleQueued",value:function(e){this._waitingOnSet.add(this._key(e.stream,e.segment,e.type)),this._streamsForSegment[e.segment]||(this._streamsForSegment[e.segment]=[]),this._streamsForSegment[e.segment].indexOf(e.stream)===-1&&this._streamsForSegment[e.segment].push(e.stream)}},{key:"_clearWaitingOn",value:function(e){var t=this,n=this._streamsForSegment[e.segment];n.forEach(function(n){t._waitingOnSet.delete(t._key(n,e.segment,e.type))})}},{key:"_handleAborted",value:function(e){this._clearWaitingOn(e)}},{key:"_handleAppendBufferEnd",value:function(e){this._checkSwitchUp&&e.stream===this._lastStreamIndex&&(this._checkSwitchUp=!1,this._clearBufferAtTime=this._streams[Ur][e.stream].segments[e.segment].start),this._clearWaitingOn(e),null!==this._timeToSeekTo&&this._resolveSeek&&this._brain.canPlayFromTimeInStream(this._timeToSeekTo,this._getCurrentStream())&&(this._resolveSeek(this._timeToSeekTo),this._resolveSeek=null)}},{key:"_handleDownloadEnd",value:function(e){}},{key:"preload",get:function(){return this._preload},set:function(e){this._handlePreloadChanged(this._preload,e),this._preload=e}},{key:"videoWidth",get:function(){var e=this._getCurrentStream();return e?e.width:this._video.videoWidth}},{key:"videoHeight",get:function(){var e=this._getCurrentStream();return e?e.height:this._video.videoHeight}},{key:"restrictedStreamIndexes",get:function(){return this._restrictedStreamIndexes},set:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this._restrictedStreamIndexes.join(",")!==t.join(",")&&(this._restrictedStreamIndexes=t,this._onReady.then(function(){return e.lockStreamIndexes()}))}},{key:"currentTime",get:function(){return null!==this._timeToSeekTo?this._timeToSeekTo:this._video.currentTime},set:function(e){this.seekToTime(e)}}]),t}(Tr),$r=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};$i(this,t);var i=Qi(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),r=document.createElement("canvas");return i._backingCanvas=r.getContext("2d"),i._resizeHandler=function(){return i.onresize()},i}return Ki(t,e),Xi(t,null,[{key:"displayName",get:function(){return"AsciiEffect"}},{key:"supported",get:function(){return!/iphone|ipod/i.test(navigator.userAgent)}},{key:"supportedScanners",get:function(){return[Tr,Gr]}}]),Xi(t,[{key:"activate",value:function(){return window.addEventListener("resize",this._resizeHandler,!1),this._telecine.paused?void this._renderFrame():void this._startRendering()}},{key:"deactivate",value:function(){this._stopRendering(),window.removeEventListener("resize",this._resizeHandler,!1),this._element.removeChild(this._output)}},{key:"onplay",value:function(){this._startRendering()}},{key:"onpause",value:function(){this._stopRendering()}},{key:"onended",value:function(){this._stopRendering()}},{key:"onseeked",value:function(){this._renderFrame()}},{key:"onresize",value:function(){var e=this._telecine._currentScanner._video,t=this._getRenderProperties(e.clientWidth,e.clientHeight,this._telecine.videoWidth,this._telecine.videoHeight);this._adjustRenderSize(this._output,t),this._telecine.paused&&this._renderFrame()}},{key:"_getRenderProperties",value:function(e,t,n,i){var r=pe(e,t,n,i),o=Math.max(Math.min(Math.floor(r.height/10),60),10);this._options.color&&(o=Math.floor(o/2));var a=document.createElement("pre");a.style.cssText="position:absolute;left:-9001px;top:0;font-size:10px;margin:0;padding:0;line-height:1",a.innerHTML="X",this._element.appendChild(a);var s=t/o/a.clientHeight*10+"px";a.style.fontSize=s;for(var c=a.clientHeight,u=Math.ceil(r.height/c),d=r.height-u*c,l=parseFloat((d/u+c)/c),f=a.clientWidth,h=Math.ceil(r.width/f),p=[],v=0;v<h;v++)p.push("X");a.innerHTML=p.join("");var g=r.width-a.clientWidth,m=g/h+"px";return this._element.removeChild(a),{fontSize:s,lineHeight:l,letterSpacing:m,horizontalResolution:h,verticalResolution:u,top:r.top}}},{key:"_createOutputElement",value:function(e){var t=document.createElement("pre");return t.style.cssText="position:absolute;left:0;top:0;margin:0;padding:0;background:#000;width:100%;height:100%;text-align:center",t.style.color=this._options.color?"#fff":"#0f0",this._adjustRenderSize(t,e),this._telecine._currentScanner._video.setAttribute("crossorigin","anonymous"),t}},{key:"_adjustRenderSize",value:function(e,t){var n=t.fontSize,i=t.lineHeight,r=t.letterSpacing,o=t.horizontalResolution,a=t.verticalResolution,s=t.top;this._backingCanvas.width=o,this._backingCanvas.height=a,this._renderWidth=o,this._renderHeight=a,e.style.fontSize=n,e.style.lineHeight=i,e.style.letterSpacing=r,e.style.paddingTop=s+"px"}},{key:"_getFrame",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._backingCanvas.drawImage(e,0,0,this._renderWidth,this._renderHeight);var n=null;try{n=this._backingCanvas.getImageData(0,0,this._renderWidth,this._renderHeight).data}catch(e){this._stopRendering()}for(var i=[],r=0;r<this._renderHeight;r++){for(var o=0;o<this._renderWidth;o++){var a=4*(r*this._renderWidth+o),s=n[a],c=n[a+1],u=n[a+2],d=3*s+4*c+u>>>3;if(t){var l=" CGO08@"[Math.floor(d/256*7)];if(" "===l||s>=250&&c>=250&&u>=250){i.push(l);continue}i.push('<span style="color:rgb('+s+","+c+","+u+')">'+l+"</span>")}else{var f="  .,:;iltfLG@"[Math.floor(d/256*13)];i.push(f)}}i.push("\n")}return i.join("")}},{key:"_requestRenderAnimationFrame",value:function(){var e=this;this._animationFrame&&window.cancelAnimationFrame(this._animationFrame),this._content&&(this._animationFrame=window.requestAnimationFrame(function(){e._output.innerHTML=e._content,e._content=null}))}},{key:"_renderFrame",value:function(){if(!this._output){var e=this._telecine._currentScanner._video,t=this._getRenderProperties(e.clientWidth,e.clientHeight,this._telecine.videoWidth,this._telecine.videoHeight);this._output=this._createOutputElement(t),this._element.appendChild(this._output)}this._content=this._getFrame(this._telecine._currentScanner._video,this._options.color),this._requestRenderAnimationFrame()}},{key:"_startRendering",value:function(){var e=this;this._interval&&window.clearInterval(this._interval);var t=Math.min(Math.max(this._options.fps,15),30);this._interval=window.setInterval(function(){e._renderFrame()},1/t)}},{key:"_stopRendering",value:function(){this._interval&&(window.clearInterval(this._interval),this._interval=null)}}]),t}(tr),Xr=function(){var e="Shockwave Flash",t="application/x-shockwave-flash",n="ShockwaveFlash.ShockwaveFlash",i=window.navigator,r=0,o=!1,a=null;if("undefined"!=typeof i.plugins&&"object"===Gi(i.plugins[e])){if(a=i.plugins[e].description,a&&("undefined"==typeof i.mimeTypes||!i.mimeTypes[t]||i.mimeTypes[t].enabledPlugin)){o=!0,a=a.replace(/^.*\s+(\S+\s+\S+$)/,"$1");var s=parseInt(a.replace(/^(.*)\..*$/,"$1"),10),c=parseInt(a.replace(/^.*\.(.*)\s.*$/,"$1"),10);r=parseFloat(s+"."+c)}}else if("undefined"!=typeof window.ActiveXObject)try{var u=new ActiveXObject(n);u&&(a=u.GetVariable("$version"),a&&(o=!0,a=a.split(" ")[1].split(","),r=parseFloat(parseInt(a[0],10)+"."+parseInt(a[1],10))))}catch(e){}return{installed:o,version:r}}(),Jr=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if($i(this,t),!n.swfScanner||!n.swfScanner.swfUrl)throw new Error("The url to the swf is required to use the SWFScanner.");var i=Qi(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),r="flideo_"+ue().replace(/-/g,"_");return window[r]={onFlashEvent:function(e){return i.onEvent(e)}},i._swf=i.createSwf(i._options.swfScanner.swfUrl,r+".onFlashReady"),i._element.appendChild(i._swf),i._loaded=!1,i._volume=1,i._muted=!1,i._loadedPromise=new He(function(e,t){window[r].onFlashReady=function(){i._loaded=!0,i.attachVideoEvents(r+".onFlashEvent"),e()},setTimeout(t,1e4)}),i}return Ki(t,e),Xi(t,null,[{key:"displayName",get:function(){return"SWFScanner"}},{key:"supported",get:function(){return Xr.installed&&Xr.version>=10.1}},{key:"supportedVideoTypes",get:function(){return["application/vnd.apple.mpegurl","video/mp4","video/x-flv"]}}]),Xi(t,[{key:"deactivate",value:function(){this._swf.parentElement.removeChild(this._swf)}},{key:"play",value:function(){var e=this;this.onLoaded(function(){return e._swf._play()})}},{key:"pause",value:function(){var e=this;this.onLoaded(function(){return e._swf._pause()})}},{key:"attachVideoEvents",value:function(e){var t=this;dr.forEach(function(n){t._swf.api_addEventListener(n,e)})}},{key:"createSwf",value:function(e,t){var n=document.createElement("object");n.setAttribute("type","application/x-shockwave-flash"),n.setAttribute("width","100%"),n.setAttribute("height","100%"),n.setAttribute("data",e);var i={flashvars:"ready="+t,movie:e,allowfullscreen:"true",allowscriptaccess:"always",bgcolor:"#000000",wmode:"opaque",quality:"high",scalemode:"noscale"};for(var r in i){var o=document.createElement("param");o.setAttribute("name",r),o.setAttribute("value",i[r]),n.appendChild(o)}return n}},{key:"onEvent",value:function(e){this.fire(e.type,e)}},{key:"onLoaded",value:function(e){this._loadedPromise=this._loadedPromise.then(e)}},{key:"buffered",get:function(){if(!this._loaded)return Yi(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"buffered",this);var e=this._swf.getBuffered(),n=e.start,i=e.end;return ve(n,i)}},{key:"currentFile",get:function(){return Yi(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"currentFile",this)},set:function(e){var n=this,i=this._currentFile;Zi(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"currentFile",e,this),this.onLoaded(function(){var t=!n._swf.getPaused(),r=n._swf.getCurrentTime();n._swf.setSrc(e.src),n.fire("currentfilechange",e),i&&(n._swf.setCurrentTime(r),t&&n._swf._play())})}},{key:"currentTime",get:function(){return this._loaded?this._swf.getCurrentTime():Yi(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"currentTime",this)},set:function(e){var t=this;this.onLoaded(function(){return t._swf.setCurrentTime(e)})}},{key:"duration",get:function(){return this._loaded?this._swf.getDuration():Yi(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"duration",this)}},{key:"ended",get:function(){return this._loaded?this._swf.getEnded():Yi(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"ended",this)}},{key:"loop",get:function(){return this._loaded?this._swf.getLoop():Yi(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"loop",this)},set:function(e){var t=this;this.onLoaded(function(){return t._swf.setLoop(e)})}},{key:"muted",get:function(){return this._muted},set:function(e){var t=this;this._muted=e;var n=e===!0?0:this._volume;this.onLoaded(function(){return t._swf.setVolume(n)})}},{key:"paused",get:function(){return this._loaded?this._swf.getPaused():Yi(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"paused",this)}},{key:"videoWidth",get:function(){return this._loaded?this._swf.getVideoWidth():Yi(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"videoWidth",this)}},{key:"videoHeight",get:function(){return this._loaded?this._swf.getVideoHeight():Yi(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"videoHeight",this)}},{key:"volume",get:function(){return this._loaded?this._swf.getVolume():Yi(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"volume",this)},set:function(e){var t=this;this._volume=e,this.onLoaded(function(){return t._swf.setVolume(e)})}}]),t}(ur),Yr=new Wi,Kr=new Wi,TelecineFile=function(){function TelecineFile(e,t){var n=e.src,i=e.mime,r=e.id,o=void 0===r?ue():r,a=e.priority,s=void 0===a?0:a,c=e.metadata,u=void 0===c?{}:c;if($i(this,TelecineFile),!n)throw new TypeError("Must provide a src for the file.");if(!i)throw new TypeError("Must provide a mime type for the file.");Object.defineProperties(this,{mime:{value:i,enumerable:!0},id:{value:""+o,enumerable:!0},metadata:{value:u,enumerable:!0}}),this.video=t,this.priority=s,this.src=n}return Xi(TelecineFile,[{key:"priority",get:function(){return Yr.get(this)},set:function(e){if(e=parseInt(e,10),"number"==typeof e&&isFinite(e)&&Math.floor(e)===e&&e>=0)return void Yr.set(this,e);throw new TypeError("The file priority must be an integer greater than or equal to 0.")}},{key:"src",get:function(){return Kr.get(this)},set:function(e){Kr.set(this,e),this.video.fire("filesrcupdate",this)}},{key:"restrictedStreamIndexes",get:function(){if(!Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this.video.currentScanner),"restrictedStreamIndexes"))throw new ReferenceError("The current scanner does not support streams.");return this.video.currentScanner.restrictedStreamIndexes},set:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!Array.isArray(e))throw new TypeError("Indexes must be an array.");if(!Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this.video.currentScanner),"restrictedStreamIndexes"))throw new ReferenceError("The current scanner does not support streams.");this.video.currentScanner.restrictedStreamIndexes=e}}]),TelecineFile}(),Qr=["disabled","hidden","showing"],Zr=["subtitles","captions","descriptions","chapters","metadata"],eo=["ar","fa","he","iw","ku","ps","sd","ur","yi"],to=new Wi,no=new Wi,TelecineTextTrack=function(){function TelecineTextTrack(e,t){var n=e.kind,i=e.src,r=void 0===i?null:i,o=e.label,a=void 0===o?"":o,s=e.language,c=void 0===s?"":s,u=e.id,d=void 0===u?ue():u;if($i(this,TelecineTextTrack),Zr.indexOf(n)===-1)throw ie(12,"SYNTAX_ERR","Syntax Error");ne(this),Object.defineProperties(this,{kind:{value:n,enumerable:!0},label:{value:a,enumerable:!0},language:{value:c,enumerable:!0},id:{value:""+d,enumerable:!0},rtl:{value:eo.indexOf(c.substr(0,2))!==-1,enumerable:!0}}),this.video=t,this.src=r,this._modeHasBeenSet=!1,to.set(this,"disabled")}return Xi(TelecineTextTrack,[{key:"dispatchEvent",value:function(e){this.fire(e,{target:this})}},{key:"mode",get:function(){return to.get(this)},set:function(e){if(Qr.indexOf(e)>-1){if(this._modeHasBeenSet=!0,to.get(this)===e)return;to.set(this,e),this.video.currentScanner&&this.video.currentScanner.setModeForTrack(this,e),this.dispatchEvent("modechange")}}},{key:"src",get:function(){return no.get(this)},set:function(e){no.set(this,e),this.video.fire("texttracksrcupdate",this)}},{key:"cues",get:function(){return this.video.currentScanner?this.video.currentScanner.getCuesForTrack(this):[]}},{key:"activeCues",get:function(){return this.video.currentScanner?this.video.currentScanner.getActiveCuesForTrack(this):[]}}]),TelecineTextTrack}(),io=function(){function e(t,n){$i(this,e),this._cdms=t.cdms,this._lrToken=t.lr_token,this._userId=t.user,this._assetId=t.asset,this._useHls=n,this._licenseUrl=null,this._keySession=null,this._preferredKeySystem=null}return Xi(e,[{key:"init",value:function(e){var t=this;return this._video=e._video,this._scanner=e,this._canHandleEME()?(this._licenseRequestMetadata=this._getLicenseRequestHeader(),this._getKeySystems().then(function(e){if(e.forEach(function(e){e.keySystem&&(t._preferredKeySystem=e)}),!t._preferredKeySystem)return t._scanner.fire("emeunsupported"),!1;var n=t._getCdmFromSystem(t._preferredKeySystem),i="encrypted";return t._licenseUrl=n.license_url,t._useHls&&(t._certificateUrl=n.certificate_url,i="webkitneedkey"),t._video.addEventListener(i,function(e){return t._generateRequest(e)}),t._useHls?(t._video.webkitSetMediaKeys(t._preferredKeySystem.keySystem),!0):t._video.mediaKeys?(t._keySession=t._video.mediaKeys.createSession(),t._keySession.addEventListener("message",function(e){return t._getLicense(e)}),!0):(t._keySession=t._preferredKeySystem.keySystem.createSession(),t._keySession.addEventListener("message",function(e){return t._getLicense(e)}),t._video.setMediaKeys(t._preferredKeySystem.keySystem),!0)})):(this._scanner.fire("emeunsupported"),!1)}},{key:"destroy",value:function(){this._keySession.close()}},{key:"_generateRequest",value:function(e){var t=this;return"com.apple.fps.1_0"===this._preferredKeySystem.name?(this._loadFairPlayCertificate().then(function(n){t._contentId="assetId="+t._assetId;var i=t._concatInitDataIdAndCertificate(e.initData,t._contentId,n);t._keySession=t._preferredKeySystem.keySystem.createSession("video/mp4",i),t._keySession.addEventListener("webkitkeymessage",function(e){return t._getLicense(e)},!1)}).catch(function(e){t._scanner.fire(e.error,e.payload)}),!0):!this._keySession.sessionId&&!this._activeKeySession&&(this._activeKeySession=this._keySession.generateRequest(e.initDataType,e.initData).catch(function(){t._scanner.fire("drmfailure")}),!0)}},{key:"_getLicense",value:function(e){var t=this;return new He(function(n,i){t._activeKeySession=null;var r=new XMLHttpRequest;r.keySession=e.target,r.responseType="arraybuffer",r.open("POST",t._licenseUrl),r.setRequestHeader("dt-custom-data",window.btoa(JSON.stringify(t._licenseRequestMetadata)));var o=e.message;if("com.microsoft.playready"===t._preferredKeySystem.name&&!function(){var n=t._unpackPlayReadyRequest(e.message),i=n[0];Object.keys(i).forEach(function(e){r.setRequestHeader([e],i[e])}),o=n[1]}(),"com.apple.fps.1_0"===t._preferredKeySystem.name){var a=btoa(String.fromCharCode.apply(null,o));a=encodeURIComponent(a),o="spc="+a+"&"+t._contentId,r.setRequestHeader("Content-type","application/x-www-form-urlencoded")}r.onload=function(){if(403===r.status){var e=JSON.parse(r.getResponseHeader("x-dt-error-message"));return void i({error:"drmauthfailure",payload:{text:e.error,code:e.error_code}})}if(r.status>=400)return void i({error:"drmfailure"});try{t._scanner.fire("drmauthsuccess");var o=new Uint8Array(r.response),a=o.buffer;"com.apple.fps.1_0"===t._preferredKeySystem.name&&(a=t._unpackFairPlayLicenseResponse(btoa(String.fromCharCode.apply(null,o)))),r.keySession.update(a),n()}catch(e){i("Error updating key session: "+e)}},r.onerror=i,r.send(o)}).catch(function(e){t._scanner.fire(e.error,e.payload)})}},{key:"_canHandleEME",value:function(){var e=!!(window.MediaKeys&&window.navigator&&window.navigator.requestMediaKeySystemAccess&&window.MediaKeySystemAccess&&window.MediaKeySystemAccess.prototype.getConfiguration||window.WebKitMediaKeys);return e}},{key:"_concatInitDataIdAndCertificate",value:function(e,t,n){"string"==typeof t&&(t=fe(t));var i=0,r=new ArrayBuffer(e.byteLength+4+t.byteLength+4+n.byteLength),o=new DataView(r),a=new Uint8Array(r,i,e.byteLength);a.set(e),i+=e.byteLength,o.setUint32(i,t.byteLength,!0),i+=4;var s=new Uint8Array(r,i,t.byteLength);s.set(t),i+=s.byteLength,o.setUint32(i,n.byteLength,!0),i+=4;var c=new Uint8Array(r,i,n.byteLength);return c.set(n),new Uint8Array(r,0,r.byteLength)}},{key:"_loadFairPlayCertificate",value:function(){var e=this;return new He(function(t,n){var i=new XMLHttpRequest;i.responseType="arraybuffer",i.open("GET",e._certificateUrl),i.setRequestHeader("dt-custom-data",window.btoa(JSON.stringify(e._licenseRequestMetadata))),i.onload=function(){if(403===i.status){var e=JSON.parse(i.getResponseHeader("x-dt-error-message"));return void n({error:"drmauthfailure",payload:{text:e.error,code:e.error_code}})}if(i.status>=400)return void n({error:"drmfailure"});try{t(new Uint8Array(i.response))}catch(e){n(e)}},i.onerror=n,i.send()})}},{key:"_getCdmFromSystem",value:function(e){var t=this,n=null;return Object.keys(this._cdms).forEach(function(i){e.name===t._cdms[i].id&&(n=t._cdms[i])}),n}},{key:"_unpackFairPlayLicenseResponse",value:function(e){var t=window.atob(e.trim());return"<ckc>"===t.substr(0,5)&&"</ckc>"===t.substr(-6)&&(t=t.slice(5,-6)),new Uint8Array(atob(t).split("").map(function(e){return e.charCodeAt(0)}))}},{key:"_unpackPlayReadyRequest",value:function(e){for(var t=String.fromCharCode.apply(null,new Uint16Array(e)),n=(new DOMParser).parseFromString(t,"application/xml"),i={},r=n.getElementsByTagName("HttpHeader"),o=0;o<r.length;++o){var a=r[o].querySelector("name"),s=r[o].querySelector("value");i[a.textContent]=s.textContent}var c=n.querySelector("Challenge");return e=new Uint8Array(atob(c.textContent).split("").map(function(e){return e.charCodeAt(0)})),[i,e]}},{key:"_getLicenseRequestHeader",value:function(){var e={},t=window.screen.availWidth+"x"+window.screen.availHeight,n=window.devicePixelRatio;return e.merchant="vimeo",e.sessionId=JSON.stringify({ua:navigator.userAgent,token:this._lrToken,resolution:t,pixelRatio:n}),e.userId=this._userId,e}},{key:"_getKeySystems",value:function(){var e=this,t={persistentState:"required",sessionTypes:["persistent-license"]},n=Object.keys(this._cdms).map(function(n){var i=e._cdms[n].id,r={name:i,keySystem:null};return r=e._useHls?new He(function(e,t){var n=null;try{n=new window.WebKitMediaKeys(i)}catch(t){e(null)}e(n)}).then(function(e){return{name:i,keySystem:e}}):navigator.requestMediaKeySystemAccess(i,[t,{}]).then(function(e){return e.createMediaKeys()}).catch(function(e){}).then(function(e){return{name:i,keySystem:e}})});return He.all(n)}}]),e}(),ro=new Wi,TelecineVideo=function(){function TelecineVideo(e){var t=this,n=e.files,i=e.id,r=void 0===i?ue():i,o=e.title,a=void 0===o?null:o,s=e.subtitle,c=void 0===s?null:s,u=e.metadata,d=void 0===u?{}:u,l=e.textTracks,f=void 0===l?ae():l,h=e.externalDisplayFiles,p=void 0===h?{}:h;if($i(this,TelecineVideo),!n||!Array.isArray(n))throw new TypeError("Must provide files for the video.");ne(this);var v=oe(n.map(function(e){return e instanceof TelecineFile?(e.video=t,e):new TelecineFile(e,t)})),g=ae(f.map(function(e){return e instanceof TelecineTextTrack?(e.video=t,e):new TelecineTextTrack(e,t)}));Object.keys(p).forEach(function(e){!p[e]||p[e]instanceof TelecineFile||(p[e]=new TelecineFile(p[e],t))}),Object.defineProperties(this,{id:{value:""+r,enumerable:!0},title:{value:a,enumerable:!0},subtitle:{value:c,enumerable:!0},metadata:{value:d,enumerable:!0},files:{value:v,enumerable:!0},textTracks:{value:g,enumerable:!0},externalDisplayFiles:{value:p,enumerable:!0}}),d.drm&&(this._drmHandler=new io(d.drm,d.useHls))}return Xi(TelecineVideo,[{key:"deactivate",value:function(){var e=this;this._drmHandler&&this._drmHandler.destroy(),this.textTracks.forEach(function(t){return e.currentScanner.removeTextTrack(t)})}},{key:"drmHandler",get:function(){return this._drmHandler||null}},{key:"currentFile",get:function(){return this.currentScanner.currentFile},set:function(e){this.currentScanner.currentFile=e}},{key:"currentScanner",get:function(){return ro.get(this)},set:function(e){var t=this;this.currentScanner&&this.textTracks.forEach(function(e){return t.currentScanner.removeTextTrack(e)}),this.textTracks.forEach(function(t){return e.addTextTrack(t)}),ro.set(this,e)}}]),TelecineVideo}(),oo=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};$i(this,e),this._element=t,this._scanners=n,this._options=i,this._video=null,this._textTracks=ae(),this._properties={},this._currentScanner=new ur,this._blacklistedScanners=[],this._activeEffects=[],ne(this)}return Xi(e,[{key:"supportsEffect",value:function(e){var t=this;return!!e.supported&&e.supportedScanners.some(function(e){return t._getScannerName(t._currentScanner)===e.displayName})}},{key:"getEffectByName",value:function(e){var t=this,n=null;return this._activeEffects.forEach(function(i){e===t._getEffectName(i)&&(n=i)}),n}},{key:"activateEffect",value:function(e,t){var n=new e(this,t);return n.activate(),this._activeEffects.push(n),n}},{key:"deactivateEffect",value:function(e){var t=this;this._activeEffects.some(function(n,i){return n.constructor===e&&(n.deactivate(),t._activeEffects.splice(i,1),!0)})}},{key:"deactivateEffects",value:function(){var e=this;this._activeEffects.forEach(function(t){return e.deactivateEffect(t.constructor)})}},{key:"play",value:function(){if(!this._video||this._video.files.length<1)throw new TelecineError("NoFiles","There are no files to play.");return this._currentScanner.play(),this._properties.paused=!1,this}},{key:"pause",value:function(){if(!this._video||this._video.files.length<1)throw new TelecineError("NoFiles","There are no files to play.");return this._currentScanner.pause(),this._properties.paused=!0,this}},{key:"showExternalDisplayPicker",value:function(e){return this._currentScanner.showExternalDisplayPicker(e)}},{key:"supportsPresentationMode",value:function(e){return this.supportedPresentationModes.indexOf(e)!==-1}},{key:"_findScanner",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.textTrackSupport,n=void 0!==t&&t,i=this._video.files.map(function(e){return e.mime}),r=this._scanners,o=r,a=Array.isArray(o),s=0,o=a?o:o[Ui.iterator]();;){var c;if(a){if(s>=o.length)break;c=o[s++]}else{if(s=o.next(),s.done)break;c=s.value}var u=c;if(u.supported&&(!n||u.supportsTextTracks)&&this._blacklistedScanners.indexOf(this._getScannerName(u))===-1){var d=u.supportedVideoTypes;if(d.some(function(e){return i.indexOf(e)!==-1}))return u}}return n?(this.fire("error",new TelecineError("TextTracksNotSupported","None of the scanners support text tracks in this browser.")),this._blacklistedScanners=[],this._findScanner()):null}},{key:"_initScanner",value:function(e,t){var n=this;if(this._currentScanner.constructor===e)return void(this._currentScanner.video!==t&&(t.currentScanner=this._currentScanner,this._currentScanner.video=t));this._currentScanner.deactivate();var i=new e(this._element,this._options);hr.forEach(function(e){i.on(e,function(t){return n._handleEvent(e,t,i)})}),this._currentScanner=i,t.currentScanner=i,this._currentScanner.video=t,Object.keys(this._properties).forEach(function(e){return"paused"===e?void(n._properties.paused===!1&&n._currentScanner.play()):void(n._currentScanner[e]=n._properties[e])}),this.fire("scannerchange",this._getScannerName(this._currentScanner))}},{key:"_updateScanner",value:function(){if(null!==this._video){var e=this._findScanner({textTrackSupport:this._video.textTracks.length>0});return e?void this._initScanner(e,this._video):void this.fire("error",new TelecineError("FilesNotPlayable","None of the files could be played in this browser."))}}},{key:"_handleEvent",value:function(e,t,n){if(n===this._currentScanner){switch(e){case"error":return void(t instanceof TelecineError&&this.fire("error",t));case"scannererror":this.fire("error",new TelecineError("ScannerError","The current scanner can no longer be used because "+t.reason)),this._blacklistedScanners.push(this._getScannerName(this._currentScanner)),this._updateScanner([]);break;case"emeunsupported":this.fire("error",new TelecineError("BrowserNotSupported"));break;case"drmfailure":this.fire("error",new TelecineError("DRMFailure",{text:null,code:null}));break;case"drmauthfailure":this.fire("error",new TelecineError("DRMFailure",{text:t.text,code:t.code}));break;case"drmauthsuccess":this.fire("drmauthsuccess");break;case"timeupdate":this._properties.currentTime=this._currentScanner.currentTime;break;case"ended":this._properties.paused=!0}this._activeEffects.forEach(function(t){"function"==typeof t["on"+e]&&t["on"+e]()}),this.fire(e,t)}}},{key:"_getScannerName",value:function(e){return e instanceof ur?e.constructor.displayName:e.prototype.constructor.displayName}},{key:"_getEffectName",value:function(e){return e instanceof tr?e.constructor.displayName:e.prototype.constructor.displayName}},{key:"supportsSettingVolume",get:function(){return this._scanners.some(function(e){return e.supported&&e.supportsSettingVolume})}},{key:"supportsTextTracks",get:function(){return this._scanners.some(function(e){return e.supported&&e.supportsTextTracks})}},{key:"activeEffects",get:function(){return this._activeEffects}},{key:"buffered",get:function(){return this._currentScanner.buffered}},{key:"currentFile",get:function(){return this._currentScanner.currentFile},set:function(e){if("string"==typeof e&&(e=this._files.filter(function(t){return t.id===e;
})[0]),!e)throw new TelecineError("FileNotValid","The file is not valid.");this._currentScanner.currentFile=e}},{key:"currentScanner",get:function(){return this._getScannerName(this._currentScanner)}},{key:"currentTime",get:function(){return this._currentScanner.currentTime},set:function(e){this._properties.currentTime=e,this._currentScanner.currentTime=e}},{key:"duration",get:function(){return this._currentScanner.duration}},{key:"ended",get:function(){return this._currentScanner.ended}},{key:"externalDisplayAvailable",get:function(){return this._currentScanner.externalDisplayAvailable}},{key:"externalDisplayActive",get:function(){return this._currentScanner.externalDisplayActive}},{key:"loop",get:function(){return this._currentScanner.loop},set:function(e){this._properties.loop=e,this._currentScanner.loop=e}},{key:"muted",get:function(){return this._currentScanner.muted},set:function(e){this._properties.muted=!!e,this._currentScanner.muted=!!e}},{key:"paused",get:function(){return this._currentScanner.paused}},{key:"playbackRate",get:function(){return this._currentScanner.playbackRate},set:function(e){this._properties.playbackRate=e,this._currentScanner.playbackRate=e}},{key:"preload",get:function(){return this._currentScanner.preload},set:function(e){this._properties.preload=e,this._currentScanner.preload=e}},{key:"presentationMode",get:function(){return this._currentScanner.presentationMode},set:function(e){this._currentScanner.presentationMode=e}},{key:"supportedPresentationModes",get:function(){return this._currentScanner.supportedPresentationModes}},{key:"video",get:function(){return this._video},set:function(e){this._video&&this._video.deactivate(),this._blacklistedScanners=[],this._video=new TelecineVideo(e),this._updateScanner()}},{key:"videoWidth",get:function(){return this._currentScanner.videoWidth}},{key:"videoHeight",get:function(){return this._currentScanner.videoHeight}},{key:"volume",get:function(){return this._currentScanner.volume},set:function(e){if(e<0||e>1)throw new TelecineError("IndexSizeError","Failed to set the 'volume' property: The volume provided ("+e+") is outside of the range [0, 1].");this._properties.volume=e,this._currentScanner.volume=e}}]),e}(),ao=300,so=.35,co=20,uo=85,lo=60,fo=400,ho=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};$i(this,t);var i=Qi(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._camera=null,i._scene=null,i._renderer=null,i._animationFrame=null,i._isUserInteracting=!1,i._onMouseDownMouseX=0,i._onMouseDownMouseY=0,i._coordinates={lat:0,long:0},i._previousCoordinates={lat:0,long:0},i._onMouseDownCoordinates={lat:0,long:0},i._phi=0,i._theta=0,i._distance=fo,i._video=i._telecine._currentScanner._video,i._gyroVector={x:0,y:0},i._offset={lat:0,long:0},i._writeSpeeds={videoFps:i._options.fps,motionRenderSpeed:lo},i._maxTimeBetweenWrites=1e3/i._writeSpeeds.videoFps,i._motionTimeouts=[],i._movingAutomatically=!1,i._updateFromGyroscopePending=!1,i._keysPressed={up:!1,down:!1,left:!1,right:!1},i}return Ki(t,e),Xi(t,null,[{key:"displayName",get:function(){return"ThreeSixtyEffect"}},{key:"supported",get:function(){return!0}},{key:"supportedScanners",get:function(){return[Tr,Gr]}}]),Xi(t,[{key:"activate",value:function(){var e=this;new He(function(t,n){window.THREE&&t();var i=document.createElement("script");i.src=e._options.threeUrl,document.body.appendChild(i),i.onload=function(){t()}}).then(function(){return e._initialize()})}},{key:"_initialize",value:function(){this._telecine.fire("360useraction",{type:"init"}),this._camera=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,1100),this._camera.target=new THREE.Vector3(0,0,0),this._scene=new THREE.Scene;var e=new THREE.SphereBufferGeometry(500,120,80);e.scale(-1,1,1);var t=new THREE.VideoTexture(this._video);t.minFilter=THREE.LinearFilter,t.format=THREE.RGBFormat;var n=new THREE.MeshBasicMaterial({map:t}),i=new THREE.Mesh(e,n);this._scene.add(i),this._renderer=new THREE.WebGLRenderer,this._renderer.setPixelRatio(window.devicePixelRatio),this._output=document.createElement("div"),this._renderer.domElement.classList.add("telecine-three-renderer"),this._output.appendChild(this._renderer.domElement),this._element.appendChild(this._output);var r="#000";this._options.transparentCanvasWrap&&(r="transparent"),this._output.style.cssText="position:absolute;left:0;top:0;margin-left:auto;margin-right:auto;padding:0;background:"+r+";width:100%;height:100%;text-align:center",this._telecine._currentScanner._video.setAttribute("crossorigin","anonymous"),this._startRendering()}},{key:"deactivate",value:function(){this._element.removeChild(this._output),this._stopRendering()}},{key:"showRenderer",value:function(){this._renderer.domElement.classList.add("telecine-three-renderer--show")}},{key:"snapToCenter",value:function(){var e=this;this._motionTimeouts.forEach(function(e){return clearTimeout(e)});for(var t=50,n=this._coordinates.long>=180?360:0,i=0,r={long:(n-this._coordinates.long)/11,lat:(i-this._coordinates.lat)/11},o=function(n){e._motionTimeouts.push(setTimeout(function(){0===n&&(e._movingAutomatically=!0,e._options.isMobile||(e._maxTimeBetweenWrites=1e3/e._writeSpeeds.motionRenderSpeed)),n===t-1&&(e._movingAutomatically=!1,e._options.isMobile||(e._maxTimeBetweenWrites=1e3/e._writeSpeeds.videoFps)),e._updateViewpoint(e._coordinates.lat+r.lat/Math.pow(1.1,n),e._coordinates.long+r.long/Math.pow(1.1,n)),e._offset.lat=THREE.Math.radToDeg(e._gyroVector.x)+e._coordinates.lat+r.lat,e._offset.long=THREE.Math.radToDeg(e._gyroVector.y)+e._coordinates.long+r.long},n*e._maxTimeBetweenWrites))},a=0;a<t;a++)o(a)}},{key:"_updateViewpoint",value:function(e,t){e%=360,this._coordinates.lat=Math.max(-uo,Math.min(uo,e)),t%=360,t=t>=0?t:360+t,this._coordinates.long=t}},{key:"makeContact",value:function(e){this._isUserInteracting=!0,this._motionTimeouts.forEach(function(e){return clearTimeout(e)}),this._movingAutomatically=!1,this._contactPoint={x:e.x,y:e.y},this._onMouseDownCoordinates.long=this._coordinates.long,this._onMouseDownCoordinates.lat=this._coordinates.lat,this._motionStart={long:this._coordinates.long,lat:this._coordinates.lat},this._options.isMobile||(this._maxTimeBetweenWrites=1e3/this._writeSpeeds.motionRenderSpeed)}},{key:"move",value:function(e){this._previousCoordinates.long=this._coordinates.long,this._previousCoordinates.lat=this._coordinates.lat,this._offset.lat=THREE.Math.radToDeg(this._gyroVector.x)+this._previousCoordinates.lat,this._offset.long=THREE.Math.radToDeg(this._gyroVector.y)+this._previousCoordinates.long;var t=.3*(this._contactPoint.y-e.y)+this._motionStart.lat,n=.3*(this._contactPoint.x-e.x)+this._motionStart.long;this._updateViewpoint(t,n)}},{key:"moveDevice",value:function(e,t,n,i){if(!this._movingAutomatically){this._updateFromGyroscopePending=!0;var r=new THREE.Quaternion,o=window.orientation||0;e=e?THREE.Math.degToRad(e):0,t=t?THREE.Math.degToRad(t):0,n=n?THREE.Math.degToRad(n):0;var a=o?THREE.Math.degToRad(o):0,s=new THREE.Vector3(0,0,1),c=new THREE.Euler,u=new THREE.Quaternion,d=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));c.set(t,e,-n,"YXZ"),r.setFromEuler(c),r.multiply(d),r.multiply(u.setFromAxisAngle(s,-a)),this._gyroVector=(new THREE.Euler).setFromQuaternion(r,"YXZ"),this._updateViewpoint(-THREE.Math.radToDeg(this._gyroVector.x)+this._offset.lat,-THREE.Math.radToDeg(this._gyroVector.y)+this._offset.long)}}},{key:"releaseContact",value:function(e){if(this._isUserInteracting=!1,this._motionStart&&!e){var t=Math.hypot(this._coordinates.long-this._motionStart.long,this._coordinates.lat-this._motionStart.lat);this._moveDueToMomentum(t)}}},{key:"abandonMotion",value:function(){this._isUserInteracting=!1,this._motionStart=null}},{key:"keyPress",value:function(e){this._keysPressed[e]||(this._keysPressed[e]=!0)}},{key:"keyUp",value:function(e){this._keysPressed[e]=!1,this._moveDueToMomentum(1/0)}},{key:"_moveFromKeyPress",value:function(){var e=this;this._previousCoordinates.long=this._coordinates.long,this._previousCoordinates.lat=this._coordinates.lat,Object.keys(this._keysPressed).forEach(function(t){if(e._keysPressed[t])switch(t){case"up":e._updateViewpoint(e._coordinates.lat-so,e._coordinates.long);break;case"down":e._updateViewpoint(e._coordinates.lat+so,e._coordinates.long);break;case"left":e._updateViewpoint(e._coordinates.lat,e._coordinates.long-so);break;case"right":e._updateViewpoint(e._coordinates.lat,e._coordinates.long+so)}})}},{key:"_keyIsDown",value:function(){var e=this;return Object.keys(this._keysPressed).map(function(t){return e._keysPressed[t]}).some(function(e){return e})}},{key:"_moveDueToMomentum",value:function(e){var t=this;e>=co&&!function(){for(var e={long:t._coordinates.long-t._previousCoordinates.long,lat:t._coordinates.lat-t._previousCoordinates.lat},n=function(n){t._motionTimeouts.push(setTimeout(function(){1===n&&(t._movingAutomatically=!0),n===ao-1&&(t._movingAutomatically=!1,t._maxTimeBetweenWrites=1e3/t._writeSpeeds.videoFps);var i=2/Math.pow(n,1.5);t._offset.lat=THREE.Math.radToDeg(t._gyroVector.x)+t._coordinates.lat+e.lat,t._offset.long=THREE.Math.radToDeg(t._gyroVector.y)+t._coordinates.long+e.long,t._updateViewpoint(t._coordinates.lat+e.lat*i,t._coordinates.long+e.long*i)},n*t._maxTimeBetweenWrites))},i=1;i<ao;i++)n(i)}()}},{key:"onplay",value:function(){this._startRendering()}},{key:"onseeked",value:function(){this._update()}},{key:"onresize",value:function(){this.adjustRenderSize(),this._isUserInteracting=!1}},{key:"_update",value:function(){this._phi=THREE.Math.degToRad(90-this._coordinates.lat),this._theta=THREE.Math.degToRad(this._coordinates.long),this._camera.position.x=this._distance*Math.sin(this._phi)*Math.cos(this._theta),this._camera.position.y=this._distance*Math.cos(this._phi),this._camera.position.z=this._distance*Math.sin(this._phi)*Math.sin(this._theta),this._camera.lookAt(this._camera.target),this._renderer.render(this._scene,this._camera),this._telecine.fire("cameraupdate",{lon:this._coordinates.long,lat:this._coordinates.lat})}},{key:"adjustRenderSize",value:function(){this._camera.aspect=Math.max(1/3,Math.min(3,this._video.clientWidth/this._video.clientHeight)),this._distance=Math.min(fo,this._options.dimensions.width/this._options.dimensions.height/this._camera.aspect*fo);var e=pe(this._video.clientWidth,this._video.clientHeight,this._camera.aspect,1);this._camera.aspect=e.width/e.height,this._camera.updateProjectionMatrix(),this._renderer.setSize(e.width,e.height),this._output.style.paddingTop=e.top+"px"}},{key:"_startRendering",value:function(){var e=this;this._interval&&window.clearInterval(this._interval),this.adjustRenderSize(),this._interval=window.setInterval(function(){e._renderFrame(),e._keyIsDown()&&e._moveFromKeyPress()},this._maxTimeBetweenWrites/1e3)}},{key:"_stopRendering",value:function(){this._interval&&(window.clearInterval(this._interval),this._interval=null),this._motionTimeouts&&this._motionTimeouts.forEach(function(e){return clearTimeout(e)})}},{key:"_renderFrame",value:function(){this._requestRenderAnimationFrame()}},{key:"_requestRenderAnimationFrame",value:function(){var e=this;this._animationFrame&&window.cancelAnimationFrame(this._animationFrame);var t=this._movingAutomatically||this._isUserInteracting||this._updateFromGyroscopePending||this._keyIsDown();this._animationFrame=window.requestAnimationFrame(function(){(!e._telecine._currentScanner.paused&&!e._telecine._currentScanner._ranIntoBuffer||t)&&(e._update(),e._updateFromGyroscopePending=!1)})}},{key:"currentCoordinates",get:function(){return this._coordinates}}]),t}(tr),po=.05,vo={16:"shift",27:"esc",32:"space",37:"left",38:"up",39:"right",40:"down"},go="Oh!,Non!,Balivernes!,Bon sang!,Oh Ouh!,Aïe!,Zonk!,Ohhh, clack!,Bop!,Nom d’un!,crénom!,Ah zut.,Vraiment mince.,Dingue!,Horreur!,Ouin!,¡Argh caramba!".split(","),mo=[".title a"],yo=[".title a:hover"],_o=["a",".button-link",".overlay-wrapper .footnote.share a:hover",".title h1",".title span.user",".outro .video-section > div > h1 a:hover",".outro .videos h1",".outro .videos h2",".menu li:hover",".menu li.active"],bo=["a:hover",".button-link:hover"],wo=[".overlay-wrapper .close:hover .fill",".overlay-wrapper .back:hover .fill",".stats-debug-close:hover .fill",".stats-debug-copy:hover"],ko=[".play-bar .on .fill",".play-bar a:hover .fill",".play-bar button:not(.toggle):hover .fill",".tiny-bars .fill",".sidedock .on .fill"],So=[".sidedock .on:hover .fill"],xo=[".play-bar .on .stroke",".sidedock .on .stroke"],To=[".sidedock .on:hover .stroke"],Eo=[".sidedock button:hover","&.touch-support .sidedock button:active",".controls .play:hover",".controls .play-bar .played","&.no-playbar .play-bar button:not(.toggle):hover",".controls.tiny .play-bar button:not(.toggle):hover",".controls .volume div",".overlay .buttons li",".overlay .window-wrapper button",'.overlay .window-wrapper input[type="submit"]','.overlay .window-wrapper a[role="button"]',".overlay .embed-copy",".overlay .email-capture-confirm .check-icon-wrapper",'.outro a[role="button"]',".outro .videos li:hover img",".outro .videos li a:focus img",".outro .vod li",".menu li.active:before"],Po=[".outro .videos li:hover img",".outro .videos li a:focus img",".menu li.active:before"],Ao=[".overlay-wrapper .overlay .buttons li a",".overlay-wrapper .overlay button.embed-copy",".overlay-wrapper .footnote.share a:hover",".overlay .window-wrapper button",'.overlay .window-wrapper input[type="submit"]','.overlay .window-wrapper a[role="button"]',".outro .vod-header a:hover",'.outro .vod-wrapper a[role="button"]','.outro-wrapper .outro-inner a[role="button"]',".sidedock button:hover",".sidedock button:hover .vod-label",".play:hover"],Mo=[".controls .play:hover .fill",".sidedock button:hover .fill",".play-bar a:hover .fill",".play-bar button:not(.toggle):hover .fill","&.no-playbar .play-bar button:not(.toggle):hover .fill",".controls.tiny .play-bar button:not(.toggle):hover .fill",".sidedock .on .fill",'.overlay .share-wrapper a[role="button"] .fill',".overlay .email-capture-confirm .check-icon .fill",'.outro .vod-wrapper a[role="button"] .fill'],Lo=[".controls .play:hover .stroke",".sidedock button:hover .stroke",".sidedock .on .stroke"],Oo=['.overlay-wrapper .overlay a[role="button"]',".overlay-wrapper .overlay button.embed-copy",".sidedock button:hover",".play:hover",'.outro a[role="button"]'],Co=[".controls .play:hover .fill",".sidedock button:hover .fill",".controls .play-bar .fullscreen.tiny:hover .fill"],Io=[".sidedock button:hover .stroke"],qo=[".menu li:active:before"],Ro=['.overlay .window-wrapper input[type="submit"]:active',".overlay .embed-copy.zeroclipboard-is-active",'.overlay a[role="button"]:active',".outro .vod-watch-button:active",".sidedock button:active"];return window.BigScreen=pt,Be}();